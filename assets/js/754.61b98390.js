/*! For license information please see 754.61b98390.js.LICENSE.txt */
(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[754],{3905:(t,e,r)=>{"use strict";r.d(e,{Zo:()=>u,kt:()=>f});var s=r(7294);function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,s)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function o(t,e){if(null==t)return{};var r,s,i=function(t,e){if(null==t)return{};var r,s,i={},n=Object.keys(t);for(s=0;s<n.length;s++)r=n[s],e.indexOf(r)>=0||(i[r]=t[r]);return i}(t,e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);for(s=0;s<n.length;s++)r=n[s],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}var h=s.createContext({}),l=function(t){var e=s.useContext(h),r=e;return t&&(r="function"==typeof t?t(e):a(a({},e),t)),r},u=function(t){var e=l(t.components);return s.createElement(h.Provider,{value:e},t.children)},c={inlineCode:"code",wrapper:function(t){var e=t.children;return s.createElement(s.Fragment,{},e)}},d=s.forwardRef((function(t,e){var r=t.components,i=t.mdxType,n=t.originalType,h=t.parentName,u=o(t,["components","mdxType","originalType","parentName"]),d=l(r),f=i,m=d["".concat(h,".").concat(f)]||d[f]||c[f]||n;return r?s.createElement(m,a(a({ref:e},u),{},{components:r})):s.createElement(m,a({ref:e},u))}));function f(t,e){var r=arguments,i=e&&e.mdxType;if("string"==typeof t||i){var n=r.length,a=new Array(n);a[0]=d;var o={};for(var h in e)hasOwnProperty.call(e,h)&&(o[h]=e[h]);o.originalType=t,o.mdxType="string"==typeof t?t:i,a[1]=o;for(var l=2;l<n;l++)a[l]=r[l];return s.createElement.apply(null,a)}return s.createElement.apply(null,r)}d.displayName="MDXCreateElement"},487:t=>{var e={utf8:{stringToBytes:function(t){return e.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(e.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e},bytesToString:function(t){for(var e=[],r=0;r<t.length;r++)e.push(String.fromCharCode(t[r]));return e.join("")}}};t.exports=e},1012:t=>{var e,r;e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&r.rotl(t,8)|4278255360&r.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=r.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],r=0,s=0;r<t.length;r++,s+=8)e[s>>>5]|=t[r]<<24-s%32;return e},wordsToBytes:function(t){for(var e=[],r=0;r<32*t.length;r+=8)e.push(t[r>>>5]>>>24-r%32&255);return e},bytesToHex:function(t){for(var e=[],r=0;r<t.length;r++)e.push((t[r]>>>4).toString(16)),e.push((15&t[r]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(parseInt(t.substr(r,2),16));return e},bytesToBase64:function(t){for(var r=[],s=0;s<t.length;s+=3)for(var i=t[s]<<16|t[s+1]<<8|t[s+2],n=0;n<4;n++)8*s+6*n<=8*t.length?r.push(e.charAt(i>>>6*(3-n)&63)):r.push("=");return r.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var r=[],s=0,i=0;s<t.length;i=++s%4)0!=i&&r.push((e.indexOf(t.charAt(s-1))&Math.pow(2,-2*i+8)-1)<<2*i|e.indexOf(t.charAt(s))>>>6-2*i);return r}},t.exports=r},9685:(t,e,r)=>{"use strict";r.d(e,{Ib:()=>s,WT:()=>i,c$:()=>a});var s=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;var n=Math.PI/180;function a(t){return t*n}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},5975:(t,e,r)=>{"use strict";r.d(e,{G3:()=>f,Iu:()=>o,JG:()=>n,U1:()=>l,Ue:()=>i,bA:()=>h,jI:()=>d,lM:()=>u,uD:()=>c,yR:()=>a});var s=r(9685);function i(){var t=new s.WT(16);return s.WT!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function n(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function a(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o(t,e,r){var s,i,n,a,o,h,l,u,c,d,f,m,p=r[0],g=r[1],_=r[2];return e===t?(t[12]=e[0]*p+e[4]*g+e[8]*_+e[12],t[13]=e[1]*p+e[5]*g+e[9]*_+e[13],t[14]=e[2]*p+e[6]*g+e[10]*_+e[14],t[15]=e[3]*p+e[7]*g+e[11]*_+e[15]):(s=e[0],i=e[1],n=e[2],a=e[3],o=e[4],h=e[5],l=e[6],u=e[7],c=e[8],d=e[9],f=e[10],m=e[11],t[0]=s,t[1]=i,t[2]=n,t[3]=a,t[4]=o,t[5]=h,t[6]=l,t[7]=u,t[8]=c,t[9]=d,t[10]=f,t[11]=m,t[12]=s*p+o*g+c*_+e[12],t[13]=i*p+h*g+d*_+e[13],t[14]=n*p+l*g+f*_+e[14],t[15]=a*p+u*g+m*_+e[15]),t}function h(t,e,r){var s=r[0],i=r[1],n=r[2];return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function l(t,e,r,i){var n,a,o,h,l,u,c,d,f,m,p,g,_,w,b,y,v,x,k,S,A,I,E,B,N=i[0],R=i[1],T=i[2],M=Math.hypot(N,R,T);return M<s.Ib?null:(N*=M=1/M,R*=M,T*=M,n=Math.sin(r),o=1-(a=Math.cos(r)),h=e[0],l=e[1],u=e[2],c=e[3],d=e[4],f=e[5],m=e[6],p=e[7],g=e[8],_=e[9],w=e[10],b=e[11],y=N*N*o+a,v=R*N*o+T*n,x=T*N*o-R*n,k=N*R*o-T*n,S=R*R*o+a,A=T*R*o+N*n,I=N*T*o+R*n,E=R*T*o-N*n,B=T*T*o+a,t[0]=h*y+d*v+g*x,t[1]=l*y+f*v+_*x,t[2]=u*y+m*v+w*x,t[3]=c*y+p*v+b*x,t[4]=h*k+d*S+g*A,t[5]=l*k+f*S+_*A,t[6]=u*k+m*S+w*A,t[7]=c*k+p*S+b*A,t[8]=h*I+d*E+g*B,t[9]=l*I+f*E+_*B,t[10]=u*I+m*E+w*B,t[11]=c*I+p*E+b*B,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function u(t,e,r){var s=Math.sin(r),i=Math.cos(r),n=e[4],a=e[5],o=e[6],h=e[7],l=e[8],u=e[9],c=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=n*i+l*s,t[5]=a*i+u*s,t[6]=o*i+c*s,t[7]=h*i+d*s,t[8]=l*i-n*s,t[9]=u*i-a*s,t[10]=c*i-o*s,t[11]=d*i-h*s,t}function c(t,e,r){var s=Math.sin(r),i=Math.cos(r),n=e[0],a=e[1],o=e[2],h=e[3],l=e[8],u=e[9],c=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*i-l*s,t[1]=a*i-u*s,t[2]=o*i-c*s,t[3]=h*i-d*s,t[8]=n*s+l*i,t[9]=a*s+u*i,t[10]=o*s+c*i,t[11]=h*s+d*i,t}function d(t,e,r){var s=Math.sin(r),i=Math.cos(r),n=e[0],a=e[1],o=e[2],h=e[3],l=e[4],u=e[5],c=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*i+l*s,t[1]=a*i+u*s,t[2]=o*i+c*s,t[3]=h*i+d*s,t[4]=l*i-n*s,t[5]=u*i-a*s,t[6]=c*i-o*s,t[7]=d*i-h*s,t}var f=function(t,e,r,s,i){var n,a=1/Math.tan(e/2);return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(n=1/(s-i),t[10]=(i+s)*n,t[14]=2*i*s*n):(t[10]=-1,t[14]=-2*s),t}},2568:(t,e,r)=>{var s,i,n,a,o;s=r(1012),i=r(487).utf8,n=r(76),a=r(487).bin,(o=function(t,e){t.constructor==String?t=e&&"binary"===e.encoding?a.stringToBytes(t):i.stringToBytes(t):n(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||t.constructor===Uint8Array||(t=t.toString());for(var r=s.bytesToWords(t),h=8*t.length,l=1732584193,u=-271733879,c=-1732584194,d=271733878,f=0;f<r.length;f++)r[f]=16711935&(r[f]<<8|r[f]>>>24)|4278255360&(r[f]<<24|r[f]>>>8);r[h>>>5]|=128<<h%32,r[14+(h+64>>>9<<4)]=h;var m=o._ff,p=o._gg,g=o._hh,_=o._ii;for(f=0;f<r.length;f+=16){var w=l,b=u,y=c,v=d;l=m(l,u,c,d,r[f+0],7,-680876936),d=m(d,l,u,c,r[f+1],12,-389564586),c=m(c,d,l,u,r[f+2],17,606105819),u=m(u,c,d,l,r[f+3],22,-1044525330),l=m(l,u,c,d,r[f+4],7,-176418897),d=m(d,l,u,c,r[f+5],12,1200080426),c=m(c,d,l,u,r[f+6],17,-1473231341),u=m(u,c,d,l,r[f+7],22,-45705983),l=m(l,u,c,d,r[f+8],7,1770035416),d=m(d,l,u,c,r[f+9],12,-1958414417),c=m(c,d,l,u,r[f+10],17,-42063),u=m(u,c,d,l,r[f+11],22,-1990404162),l=m(l,u,c,d,r[f+12],7,1804603682),d=m(d,l,u,c,r[f+13],12,-40341101),c=m(c,d,l,u,r[f+14],17,-1502002290),l=p(l,u=m(u,c,d,l,r[f+15],22,1236535329),c,d,r[f+1],5,-165796510),d=p(d,l,u,c,r[f+6],9,-1069501632),c=p(c,d,l,u,r[f+11],14,643717713),u=p(u,c,d,l,r[f+0],20,-373897302),l=p(l,u,c,d,r[f+5],5,-701558691),d=p(d,l,u,c,r[f+10],9,38016083),c=p(c,d,l,u,r[f+15],14,-660478335),u=p(u,c,d,l,r[f+4],20,-405537848),l=p(l,u,c,d,r[f+9],5,568446438),d=p(d,l,u,c,r[f+14],9,-1019803690),c=p(c,d,l,u,r[f+3],14,-187363961),u=p(u,c,d,l,r[f+8],20,1163531501),l=p(l,u,c,d,r[f+13],5,-1444681467),d=p(d,l,u,c,r[f+2],9,-51403784),c=p(c,d,l,u,r[f+7],14,1735328473),l=g(l,u=p(u,c,d,l,r[f+12],20,-1926607734),c,d,r[f+5],4,-378558),d=g(d,l,u,c,r[f+8],11,-2022574463),c=g(c,d,l,u,r[f+11],16,1839030562),u=g(u,c,d,l,r[f+14],23,-35309556),l=g(l,u,c,d,r[f+1],4,-1530992060),d=g(d,l,u,c,r[f+4],11,1272893353),c=g(c,d,l,u,r[f+7],16,-155497632),u=g(u,c,d,l,r[f+10],23,-1094730640),l=g(l,u,c,d,r[f+13],4,681279174),d=g(d,l,u,c,r[f+0],11,-358537222),c=g(c,d,l,u,r[f+3],16,-722521979),u=g(u,c,d,l,r[f+6],23,76029189),l=g(l,u,c,d,r[f+9],4,-640364487),d=g(d,l,u,c,r[f+12],11,-421815835),c=g(c,d,l,u,r[f+15],16,530742520),l=_(l,u=g(u,c,d,l,r[f+2],23,-995338651),c,d,r[f+0],6,-198630844),d=_(d,l,u,c,r[f+7],10,1126891415),c=_(c,d,l,u,r[f+14],15,-1416354905),u=_(u,c,d,l,r[f+5],21,-57434055),l=_(l,u,c,d,r[f+12],6,1700485571),d=_(d,l,u,c,r[f+3],10,-1894986606),c=_(c,d,l,u,r[f+10],15,-1051523),u=_(u,c,d,l,r[f+1],21,-2054922799),l=_(l,u,c,d,r[f+8],6,1873313359),d=_(d,l,u,c,r[f+15],10,-30611744),c=_(c,d,l,u,r[f+6],15,-1560198380),u=_(u,c,d,l,r[f+13],21,1309151649),l=_(l,u,c,d,r[f+4],6,-145523070),d=_(d,l,u,c,r[f+11],10,-1120210379),c=_(c,d,l,u,r[f+2],15,718787259),u=_(u,c,d,l,r[f+9],21,-343485551),l=l+w>>>0,u=u+b>>>0,c=c+y>>>0,d=d+v>>>0}return s.endian([l,u,c,d])})._ff=function(t,e,r,s,i,n,a){var o=t+(e&r|~e&s)+(i>>>0)+a;return(o<<n|o>>>32-n)+e},o._gg=function(t,e,r,s,i,n,a){var o=t+(e&s|r&~s)+(i>>>0)+a;return(o<<n|o>>>32-n)+e},o._hh=function(t,e,r,s,i,n,a){var o=t+(e^r^s)+(i>>>0)+a;return(o<<n|o>>>32-n)+e},o._ii=function(t,e,r,s,i,n,a){var o=t+(r^(e|~s))+(i>>>0)+a;return(o<<n|o>>>32-n)+e},o._blocksize=16,o._digestsize=16,t.exports=function(t,e){if(null==t)throw new Error("Illegal argument "+t);var r=s.wordsToBytes(o(t,e));return e&&e.asBytes?r:e&&e.asString?a.bytesToString(r):s.bytesToHex(r)}},76:t=>{function e(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}t.exports=function(t){return null!=t&&(e(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&e(t.slice(0,0))}(t)||!!t._isBuffer)}},6456:(t,e,r)=>{"use strict";var s;r.d(e,{Vj:()=>Os,dy:()=>ai,yJ:()=>ci,z:()=>ls,nE:()=>es,k7:()=>Ri,Pi:()=>is,mI:()=>zi,xb:()=>ns,xc:()=>Ms,nW:()=>Es,rE:()=>Pi,BR:()=>Gr,LC:()=>Zi,BQ:()=>Ei,kI:()=>As,RJ:()=>yi,n1:()=>vi,YK:()=>zs,Fc:()=>Cs,MQ:()=>Fs,VR:()=>Ji,LX:()=>Ts,vA:()=>cs,Hi:()=>wi,Yi:()=>bi,UY:()=>Bi,ap:()=>Ns,Y6:()=>a}),function(t){function e(t){return"object"!=typeof t||null===t||Array.isArray(t)?void 0:t}t.readNumber=function(t){return"number"==typeof t?t:void 0},t.readInt=function(t){return"number"==typeof t?Math.floor(t):void 0},t.readString=function(t){return"string"==typeof t?t:void 0},t.readBoolean=function(t){return"boolean"==typeof t?t:void 0},t.readObject=e,t.readArray=function(t,e){if(Array.isArray(t))return e?t.map((t=>e(t))):t},t.readPair=function(t,e){if(Array.isArray(t))return[0,1].map((r=>e(t[r])))},t.readMap=function(t,r){const s=e(t)??{};return Object.fromEntries(Object.entries(s).map((([t,e])=>[t,r(e)])))},t.compose=function(t,e,r){const s=e(t);return s?r(s):void 0},t.readEnum=function(t,e){return"string"!=typeof t?e[0]:e.includes(t)?t:e[0]}}(s||(s={}));class i{source;cursor;constructor(t){this.source=t,this.cursor=0}get remainingLength(){return this.source.length-this.cursor}get totalLength(){return this.source.length}getRead(t=0){return this.source.substring(t,this.cursor)}getRemaining(){return this.source.substring(this.cursor)}canRead(t=1){return this.cursor+t<=this.source.length}peek(t=0){return this.source.charAt(this.cursor+t)}read(){return this.source.charAt(this.cursor++)}skip(){this.cursor+=1}skipWhitespace(){for(;this.canRead()&&i.isWhitespace(this.peek());)this.skip()}expect(t,e=!1){if(e&&this.skipWhitespace(),!this.canRead()||this.peek()!==t)throw this.createError(`Expected '${t}'`);this.skip()}readInt(){const t=this.cursor;for(;this.canRead()&&i.isAllowedInNumber(this.peek());)this.skip();const e=this.getRead(t);if(0===e.length)throw this.createError("Expected integer");try{const t=Number(e);if(isNaN(t)||!Number.isInteger(t))throw new Error;return t}catch(r){throw this.cursor=t,this.createError(`Invalid integer '${e}'`)}}readFloat(){const t=this.cursor;for(;this.canRead()&&i.isAllowedInNumber(this.peek());)this.skip();const e=this.getRead(t);if(0===e.length)throw this.createError("Expected float");try{const t=Number(e);if(isNaN(t))throw new Error;return t}catch(r){throw this.cursor=t,this.createError(`Invalid float '${e}'`)}}readUnquotedString(){const t=this.cursor;for(;this.canRead()&&i.isAllowedInUnquotedString(this.peek());)this.skip();return this.getRead(t)}readQuotedString(){if(!this.canRead())return"";const t=this.peek();if(!i.isQuotedStringStart(t))throw this.createError("Expected quote to start a string");return this.skip(),this.readStringUntil(t)}readString(){if(!this.canRead())return"";const t=this.peek();return i.isQuotedStringStart(t)?(this.skip(),this.readStringUntil(t)):this.readUnquotedString()}readStringUntil(t){const e=[];let r=!1;for(;this.canRead();){const s=this.read();if(r){if(s!==t&&"\\"!==s)throw this.cursor-=1,this.createError(`Invalid escape sequence '${s}' in quoted string`);e.push(s),r=!1}else if("\\"===s)r=!0;else{if(s===t)return e.join("");e.push(s)}}throw this.createError("Unclosed quoted string")}readBoolean(){const t=this.cursor,e=this.readUnquotedString();if(0===e.length)throw this.createError("Expected bool");if("true"===e)return!0;if("false"===e)return!1;throw this.cursor=t,this.createError(`Invalid bool, expected true or false but found '${e}'`)}static isAllowedInNumber(t){return t>="0"&&t<="9"||"."===t||"-"===t}static isAllowedInUnquotedString(t){return t>="0"&&t<="9"||t>="A"&&t<="Z"||t>="a"&&t<="z"||"_"===t||"-"===t||"."===t||"+"===t}static isQuotedStringStart(t){return"'"===t||'"'===t}static isWhitespace(t){return" "===t||"\t"===t||"\n"===t||"\r"===t}createError(t){const e=Math.min(this.source.length,this.cursor),r=(e>10?"...":"")+this.source.substring(Math.max(0,e-10),e);return new Error(`${t} at position ${this.cursor}: ${r}<--[HERE]`)}}function n(t){let e=null;return()=>(null==e&&(e=t()),e)}function a(t,e,r){const s=t.get(e);if(s)return s;const i=r(e);return t.set(e,i),i}function o(t){let e=t.length;for(;--e>=0;)t[e]=0}const h=256,l=286,u=30,c=15,d=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),f=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),m=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),p=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),g=new Array(576);o(g);const _=new Array(60);o(_);const w=new Array(512);o(w);const b=new Array(256);o(b);const y=new Array(29);o(y);const v=new Array(u);function x(t,e,r,s,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=s,this.max_length=i,this.has_stree=t&&t.length}let k,S,A;function I(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}o(v);const E=t=>t<256?w[t]:w[256+(t>>>7)],B=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},N=(t,e,r)=>{t.bi_valid>16-r?(t.bi_buf|=e<<t.bi_valid&65535,B(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=r-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)},R=(t,e,r)=>{N(t,r[2*e],r[2*e+1])},T=(t,e)=>{let r=0;do{r|=1&t,t>>>=1,r<<=1}while(--e>0);return r>>>1},M=(t,e,r)=>{const s=new Array(16);let i,n,a=0;for(i=1;i<=c;i++)a=a+r[i-1]<<1,s[i]=a;for(n=0;n<=e;n++){let e=t[2*n+1];0!==e&&(t[2*n]=T(s[e]++,e))}},C=t=>{let e;for(e=0;e<l;e++)t.dyn_ltree[2*e]=0;for(e=0;e<u;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},O=t=>{t.bi_valid>8?B(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},z=(t,e,r,s)=>{const i=2*e,n=2*r;return t[i]<t[n]||t[i]===t[n]&&s[e]<=s[r]},F=(t,e,r)=>{const s=t.heap[r];let i=r<<1;for(;i<=t.heap_len&&(i<t.heap_len&&z(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!z(e,s,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=s},L=(t,e,r)=>{let s,i,n,a,o=0;if(0!==t.sym_next)do{s=255&t.pending_buf[t.sym_buf+o++],s+=(255&t.pending_buf[t.sym_buf+o++])<<8,i=t.pending_buf[t.sym_buf+o++],0===s?R(t,i,e):(n=b[i],R(t,n+h+1,e),a=d[n],0!==a&&(i-=y[n],N(t,i,a)),s--,n=E(s),R(t,n,r),a=f[n],0!==a&&(s-=v[n],N(t,s,a)))}while(o<t.sym_next);R(t,256,e)},D=(t,e)=>{const r=e.dyn_tree,s=e.stat_desc.static_tree,i=e.stat_desc.has_stree,n=e.stat_desc.elems;let a,o,h,l=-1;for(t.heap_len=0,t.heap_max=573,a=0;a<n;a++)0!==r[2*a]?(t.heap[++t.heap_len]=l=a,t.depth[a]=0):r[2*a+1]=0;for(;t.heap_len<2;)h=t.heap[++t.heap_len]=l<2?++l:0,r[2*h]=1,t.depth[h]=0,t.opt_len--,i&&(t.static_len-=s[2*h+1]);for(e.max_code=l,a=t.heap_len>>1;a>=1;a--)F(t,r,a);h=n;do{a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],F(t,r,1),o=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=o,r[2*h]=r[2*a]+r[2*o],t.depth[h]=(t.depth[a]>=t.depth[o]?t.depth[a]:t.depth[o])+1,r[2*a+1]=r[2*o+1]=h,t.heap[1]=h++,F(t,r,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const r=e.dyn_tree,s=e.max_code,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,h=e.stat_desc.max_length;let l,u,d,f,m,p,g=0;for(f=0;f<=c;f++)t.bl_count[f]=0;for(r[2*t.heap[t.heap_max]+1]=0,l=t.heap_max+1;l<573;l++)u=t.heap[l],f=r[2*r[2*u+1]+1]+1,f>h&&(f=h,g++),r[2*u+1]=f,u>s||(t.bl_count[f]++,m=0,u>=o&&(m=a[u-o]),p=r[2*u],t.opt_len+=p*(f+m),n&&(t.static_len+=p*(i[2*u+1]+m)));if(0!==g){do{for(f=h-1;0===t.bl_count[f];)f--;t.bl_count[f]--,t.bl_count[f+1]+=2,t.bl_count[h]--,g-=2}while(g>0);for(f=h;0!==f;f--)for(u=t.bl_count[f];0!==u;)d=t.heap[--l],d>s||(r[2*d+1]!==f&&(t.opt_len+=(f-r[2*d+1])*r[2*d],r[2*d+1]=f),u--)}})(t,e),M(r,l,t.bl_count)},P=(t,e,r)=>{let s,i,n=-1,a=e[1],o=0,h=7,l=4;for(0===a&&(h=138,l=3),e[2*(r+1)+1]=65535,s=0;s<=r;s++)i=a,a=e[2*(s+1)+1],++o<h&&i===a||(o<l?t.bl_tree[2*i]+=o:0!==i?(i!==n&&t.bl_tree[2*i]++,t.bl_tree[32]++):o<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=0,n=i,0===a?(h=138,l=3):i===a?(h=6,l=3):(h=7,l=4))},U=(t,e,r)=>{let s,i,n=-1,a=e[1],o=0,h=7,l=4;for(0===a&&(h=138,l=3),s=0;s<=r;s++)if(i=a,a=e[2*(s+1)+1],!(++o<h&&i===a)){if(o<l)do{R(t,i,t.bl_tree)}while(0!=--o);else 0!==i?(i!==n&&(R(t,i,t.bl_tree),o--),R(t,16,t.bl_tree),N(t,o-3,2)):o<=10?(R(t,17,t.bl_tree),N(t,o-3,3)):(R(t,18,t.bl_tree),N(t,o-11,7));o=0,n=i,0===a?(h=138,l=3):i===a?(h=6,l=3):(h=7,l=4)}};let V=!1;const Z=(t,e,r,s)=>{N(t,0+(s?1:0),3),O(t),B(t,r),B(t,~r),r&&t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r};var J=t=>{V||((()=>{let t,e,r,s,i;const n=new Array(16);for(r=0,s=0;s<28;s++)for(y[s]=r,t=0;t<1<<d[s];t++)b[r++]=s;for(b[r-1]=s,i=0,s=0;s<16;s++)for(v[s]=i,t=0;t<1<<f[s];t++)w[i++]=s;for(i>>=7;s<u;s++)for(v[s]=i<<7,t=0;t<1<<f[s]-7;t++)w[256+i++]=s;for(e=0;e<=c;e++)n[e]=0;for(t=0;t<=143;)g[2*t+1]=8,t++,n[8]++;for(;t<=255;)g[2*t+1]=9,t++,n[9]++;for(;t<=279;)g[2*t+1]=7,t++,n[7]++;for(;t<=287;)g[2*t+1]=8,t++,n[8]++;for(M(g,287,n),t=0;t<u;t++)_[2*t+1]=5,_[2*t]=T(t,5);k=new x(g,d,257,l,c),S=new x(_,f,0,u,c),A=new x(new Array(0),m,0,19,7)})(),V=!0),t.l_desc=new I(t.dyn_ltree,k),t.d_desc=new I(t.dyn_dtree,S),t.bl_desc=new I(t.bl_tree,A),t.bi_buf=0,t.bi_valid=0,C(t)},Y=(t,e,r,s)=>{let i,n,a=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,r=4093624447;for(e=0;e<=31;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<h;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),D(t,t.l_desc),D(t,t.d_desc),a=(t=>{let e;for(P(t,t.dyn_ltree,t.l_desc.max_code),P(t,t.dyn_dtree,t.d_desc.max_code),D(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*p[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),i=t.opt_len+3+7>>>3,n=t.static_len+3+7>>>3,n<=i&&(i=n)):i=n=r+5,r+4<=i&&-1!==e?Z(t,e,r,s):4===t.strategy||n===i?(N(t,2+(s?1:0),3),L(t,g,_)):(N(t,4+(s?1:0),3),((t,e,r,s)=>{let i;for(N(t,e-257,5),N(t,r-1,5),N(t,s-4,4),i=0;i<s;i++)N(t,t.bl_tree[2*p[i]+1],3);U(t,t.dyn_ltree,e-1),U(t,t.dyn_dtree,r-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),L(t,t.dyn_ltree,t.dyn_dtree)),C(t),s&&O(t)},H=(t,e,r)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=r,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(b[r]+h+1)]++,t.dyn_dtree[2*E(e)]++),t.sym_next===t.sym_end),j={_tr_init:J,_tr_stored_block:Z,_tr_flush_block:Y,_tr_tally:H,_tr_align:t=>{N(t,2,3),R(t,256,g),(t=>{16===t.bi_valid?(B(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}};var G=(t,e,r,s)=>{let i=65535&t|0,n=t>>>16&65535|0,a=0;for(;0!==r;){a=r>2e3?2e3:r,r-=a;do{i=i+e[s++]|0,n=n+i|0}while(--a);i%=65521,n%=65521}return i|n<<16|0};const W=new Uint32Array((()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var s=0;s<8;s++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e})());var q=(t,e,r,s)=>{const i=W,n=s+r;t^=-1;for(let a=s;a<n;a++)t=t>>>8^i[255&(t^e[a])];return-1^t},X={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},$={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:K,_tr_stored_block:Q,_tr_flush_block:tt,_tr_tally:et,_tr_align:rt}=j,{Z_NO_FLUSH:st,Z_PARTIAL_FLUSH:it,Z_FULL_FLUSH:nt,Z_FINISH:at,Z_BLOCK:ot,Z_OK:ht,Z_STREAM_END:lt,Z_STREAM_ERROR:ut,Z_DATA_ERROR:ct,Z_BUF_ERROR:dt,Z_DEFAULT_COMPRESSION:ft,Z_FILTERED:mt,Z_HUFFMAN_ONLY:pt,Z_RLE:gt,Z_FIXED:_t,Z_DEFAULT_STRATEGY:wt,Z_UNKNOWN:bt,Z_DEFLATED:yt}=$,vt=258,xt=262,kt=42,St=113,At=666,It=(t,e)=>(t.msg=X[e],e),Et=t=>2*t-(t>4?9:0),Bt=t=>{let e=t.length;for(;--e>=0;)t[e]=0},Nt=t=>{let e,r,s,i=t.w_size;e=t.hash_size,s=e;do{r=t.head[--s],t.head[s]=r>=i?r-i:0}while(--e);e=i,s=e;do{r=t.prev[--s],t.prev[s]=r>=i?r-i:0}while(--e)};let Rt=(t,e,r)=>(e<<t.hash_shift^r)&t.hash_mask;const Tt=t=>{const e=t.state;let r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))},Mt=(t,e)=>{tt(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Tt(t.strm)},Ct=(t,e)=>{t.pending_buf[t.pending++]=e},Ot=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},zt=(t,e,r,s)=>{let i=t.avail_in;return i>s&&(i=s),0===i?0:(t.avail_in-=i,e.set(t.input.subarray(t.next_in,t.next_in+i),r),1===t.state.wrap?t.adler=G(t.adler,e,i,r):2===t.state.wrap&&(t.adler=q(t.adler,e,i,r)),t.next_in+=i,t.total_in+=i,i)},Ft=(t,e)=>{let r,s,i=t.max_chain_length,n=t.strstart,a=t.prev_length,o=t.nice_match;const h=t.strstart>t.w_size-xt?t.strstart-(t.w_size-xt):0,l=t.window,u=t.w_mask,c=t.prev,d=t.strstart+vt;let f=l[n+a-1],m=l[n+a];t.prev_length>=t.good_match&&(i>>=2),o>t.lookahead&&(o=t.lookahead);do{if(r=e,l[r+a]===m&&l[r+a-1]===f&&l[r]===l[n]&&l[++r]===l[n+1]){n+=2,r++;do{}while(l[++n]===l[++r]&&l[++n]===l[++r]&&l[++n]===l[++r]&&l[++n]===l[++r]&&l[++n]===l[++r]&&l[++n]===l[++r]&&l[++n]===l[++r]&&l[++n]===l[++r]&&n<d);if(s=vt-(d-n),n=d-vt,s>a){if(t.match_start=e,a=s,s>=o)break;f=l[n+a-1],m=l[n+a]}}}while((e=c[e&u])>h&&0!=--i);return a<=t.lookahead?a:t.lookahead},Lt=t=>{const e=t.w_size;let r,s,i;do{if(s=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-xt)&&(t.window.set(t.window.subarray(e,e+e-s),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),Nt(t),s+=e),0===t.strm.avail_in)break;if(r=zt(t.strm,t.window,t.strstart+t.lookahead,s),t.lookahead+=r,t.lookahead+t.insert>=3)for(i=t.strstart-t.insert,t.ins_h=t.window[i],t.ins_h=Rt(t,t.ins_h,t.window[i+1]);t.insert&&(t.ins_h=Rt(t,t.ins_h,t.window[i+3-1]),t.prev[i&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=i,i++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<xt&&0!==t.strm.avail_in)},Dt=(t,e)=>{let r,s,i,n=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,a=0,o=t.strm.avail_in;do{if(r=65535,i=t.bi_valid+42>>3,t.strm.avail_out<i)break;if(i=t.strm.avail_out-i,s=t.strstart-t.block_start,r>s+t.strm.avail_in&&(r=s+t.strm.avail_in),r>i&&(r=i),r<n&&(0===r&&e!==at||e===st||r!==s+t.strm.avail_in))break;a=e===at&&r===s+t.strm.avail_in?1:0,Q(t,0,0,a),t.pending_buf[t.pending-4]=r,t.pending_buf[t.pending-3]=r>>8,t.pending_buf[t.pending-2]=~r,t.pending_buf[t.pending-1]=~r>>8,Tt(t.strm),s&&(s>r&&(s=r),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+s),t.strm.next_out),t.strm.next_out+=s,t.strm.avail_out-=s,t.strm.total_out+=s,t.block_start+=s,r-=s),r&&(zt(t.strm,t.strm.output,t.strm.next_out,r),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r)}while(0===a);return o-=t.strm.avail_in,o&&(o>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=o&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-o,t.strm.next_in),t.strstart),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),a?4:e!==st&&e!==at&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(i=t.window_size-t.strstart,t.strm.avail_in>i&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,i+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),i>t.strm.avail_in&&(i=t.strm.avail_in),i&&(zt(t.strm,t.window,t.strstart,i),t.strstart+=i,t.insert+=i>t.w_size-t.insert?t.w_size-t.insert:i),t.high_water<t.strstart&&(t.high_water=t.strstart),i=t.bi_valid+42>>3,i=t.pending_buf_size-i>65535?65535:t.pending_buf_size-i,n=i>t.w_size?t.w_size:i,s=t.strstart-t.block_start,(s>=n||(s||e===at)&&e!==st&&0===t.strm.avail_in&&s<=i)&&(r=s>i?i:s,a=e===at&&0===t.strm.avail_in&&r===s?1:0,Q(t,t.block_start,r,a),t.block_start+=r,Tt(t.strm)),a?3:1)},Pt=(t,e)=>{let r,s;for(;;){if(t.lookahead<xt){if(Lt(t),t.lookahead<xt&&e===st)return 1;if(0===t.lookahead)break}if(r=0,t.lookahead>=3&&(t.ins_h=Rt(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-xt&&(t.match_length=Ft(t,r)),t.match_length>=3)if(s=et(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=Rt(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Rt(t,t.ins_h,t.window[t.strstart+1]);else s=et(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(s&&(Mt(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===at?(Mt(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Mt(t,!1),0===t.strm.avail_out)?1:2},Ut=(t,e)=>{let r,s,i;for(;;){if(t.lookahead<xt){if(Lt(t),t.lookahead<xt&&e===st)return 1;if(0===t.lookahead)break}if(r=0,t.lookahead>=3&&(t.ins_h=Rt(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-xt&&(t.match_length=Ft(t,r),t.match_length<=5&&(t.strategy===mt||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-3,s=et(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=i&&(t.ins_h=Rt(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,s&&(Mt(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(s=et(t,0,t.window[t.strstart-1]),s&&Mt(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(s=et(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===at?(Mt(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Mt(t,!1),0===t.strm.avail_out)?1:2};function Vt(t,e,r,s,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=s,this.func=i}const Zt=[new Vt(0,0,0,0,Dt),new Vt(4,4,8,4,Pt),new Vt(4,5,16,8,Pt),new Vt(4,6,32,32,Pt),new Vt(4,4,16,16,Ut),new Vt(8,16,32,32,Ut),new Vt(8,16,128,128,Ut),new Vt(8,32,128,256,Ut),new Vt(32,128,258,1024,Ut),new Vt(32,258,258,4096,Ut)];function Jt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=yt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Bt(this.dyn_ltree),Bt(this.dyn_dtree),Bt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Bt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Bt(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Yt=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==kt&&57!==e.status&&69!==e.status&&73!==e.status&&91!==e.status&&103!==e.status&&e.status!==St&&e.status!==At?1:0},Ht=t=>{if(Yt(t))return It(t,ut);t.total_in=t.total_out=0,t.data_type=bt;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?kt:St,t.adler=2===e.wrap?0:1,e.last_flush=-2,K(e),ht},jt=t=>{const e=Ht(t);var r;return e===ht&&((r=t.state).window_size=2*r.w_size,Bt(r.head),r.max_lazy_match=Zt[r.level].max_lazy,r.good_match=Zt[r.level].good_length,r.nice_match=Zt[r.level].nice_length,r.max_chain_length=Zt[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0),e},Gt=(t,e,r,s,i,n)=>{if(!t)return ut;let a=1;if(e===ft&&(e=6),s<0?(a=0,s=-s):s>15&&(a=2,s-=16),i<1||i>9||r!==yt||s<8||s>15||e<0||e>9||n<0||n>_t||8===s&&1!==a)return It(t,ut);8===s&&(s=9);const o=new Jt;return t.state=o,o.strm=t,o.status=kt,o.wrap=a,o.gzhead=null,o.w_bits=s,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=e,o.strategy=n,o.method=r,jt(t)};var Wt=(t,e)=>{if(Yt(t)||e>ot||e<0)return t?It(t,ut):ut;const r=t.state;if(!t.output||0!==t.avail_in&&!t.input||r.status===At&&e!==at)return It(t,0===t.avail_out?dt:ut);const s=r.last_flush;if(r.last_flush=e,0!==r.pending){if(Tt(t),0===t.avail_out)return r.last_flush=-1,ht}else if(0===t.avail_in&&Et(e)<=Et(s)&&e!==at)return It(t,dt);if(r.status===At&&0!==t.avail_in)return It(t,dt);if(r.status===kt&&0===r.wrap&&(r.status=St),r.status===kt){let e=yt+(r.w_bits-8<<4)<<8,s=-1;if(s=r.strategy>=pt||r.level<2?0:r.level<6?1:6===r.level?2:3,e|=s<<6,0!==r.strstart&&(e|=32),e+=31-e%31,Ot(r,e),0!==r.strstart&&(Ot(r,t.adler>>>16),Ot(r,65535&t.adler)),t.adler=1,r.status=St,Tt(t),0!==r.pending)return r.last_flush=-1,ht}if(57===r.status)if(t.adler=0,Ct(r,31),Ct(r,139),Ct(r,8),r.gzhead)Ct(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Ct(r,255&r.gzhead.time),Ct(r,r.gzhead.time>>8&255),Ct(r,r.gzhead.time>>16&255),Ct(r,r.gzhead.time>>24&255),Ct(r,9===r.level?2:r.strategy>=pt||r.level<2?4:0),Ct(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Ct(r,255&r.gzhead.extra.length),Ct(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=q(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(Ct(r,0),Ct(r,0),Ct(r,0),Ct(r,0),Ct(r,0),Ct(r,9===r.level?2:r.strategy>=pt||r.level<2?4:0),Ct(r,3),r.status=St,Tt(t),0!==r.pending)return r.last_flush=-1,ht;if(69===r.status){if(r.gzhead.extra){let e=r.pending,s=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+s>r.pending_buf_size;){let i=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>e&&(t.adler=q(t.adler,r.pending_buf,r.pending-e,e)),r.gzindex+=i,Tt(t),0!==r.pending)return r.last_flush=-1,ht;e=0,s-=i}let i=new Uint8Array(r.gzhead.extra);r.pending_buf.set(i.subarray(r.gzindex,r.gzindex+s),r.pending),r.pending+=s,r.gzhead.hcrc&&r.pending>e&&(t.adler=q(t.adler,r.pending_buf,r.pending-e,e)),r.gzindex=0}r.status=73}if(73===r.status){if(r.gzhead.name){let e,s=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>s&&(t.adler=q(t.adler,r.pending_buf,r.pending-s,s)),Tt(t),0!==r.pending)return r.last_flush=-1,ht;s=0}e=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Ct(r,e)}while(0!==e);r.gzhead.hcrc&&r.pending>s&&(t.adler=q(t.adler,r.pending_buf,r.pending-s,s)),r.gzindex=0}r.status=91}if(91===r.status){if(r.gzhead.comment){let e,s=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>s&&(t.adler=q(t.adler,r.pending_buf,r.pending-s,s)),Tt(t),0!==r.pending)return r.last_flush=-1,ht;s=0}e=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Ct(r,e)}while(0!==e);r.gzhead.hcrc&&r.pending>s&&(t.adler=q(t.adler,r.pending_buf,r.pending-s,s))}r.status=103}if(103===r.status){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Tt(t),0!==r.pending))return r.last_flush=-1,ht;Ct(r,255&t.adler),Ct(r,t.adler>>8&255),t.adler=0}if(r.status=St,Tt(t),0!==r.pending)return r.last_flush=-1,ht}if(0!==t.avail_in||0!==r.lookahead||e!==st&&r.status!==At){let s=0===r.level?Dt(r,e):r.strategy===pt?((t,e)=>{let r;for(;;){if(0===t.lookahead&&(Lt(t),0===t.lookahead)){if(e===st)return 1;break}if(t.match_length=0,r=et(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(Mt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===at?(Mt(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Mt(t,!1),0===t.strm.avail_out)?1:2})(r,e):r.strategy===gt?((t,e)=>{let r,s,i,n;const a=t.window;for(;;){if(t.lookahead<=vt){if(Lt(t),t.lookahead<=vt&&e===st)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(i=t.strstart-1,s=a[i],s===a[++i]&&s===a[++i]&&s===a[++i])){n=t.strstart+vt;do{}while(s===a[++i]&&s===a[++i]&&s===a[++i]&&s===a[++i]&&s===a[++i]&&s===a[++i]&&s===a[++i]&&s===a[++i]&&i<n);t.match_length=vt-(n-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(r=et(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=et(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(Mt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===at?(Mt(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Mt(t,!1),0===t.strm.avail_out)?1:2})(r,e):Zt[r.level].func(r,e);if(3!==s&&4!==s||(r.status=At),1===s||3===s)return 0===t.avail_out&&(r.last_flush=-1),ht;if(2===s&&(e===it?rt(r):e!==ot&&(Q(r,0,0,!1),e===nt&&(Bt(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),Tt(t),0===t.avail_out))return r.last_flush=-1,ht}return e!==at?ht:r.wrap<=0?lt:(2===r.wrap?(Ct(r,255&t.adler),Ct(r,t.adler>>8&255),Ct(r,t.adler>>16&255),Ct(r,t.adler>>24&255),Ct(r,255&t.total_in),Ct(r,t.total_in>>8&255),Ct(r,t.total_in>>16&255),Ct(r,t.total_in>>24&255)):(Ot(r,t.adler>>>16),Ot(r,65535&t.adler)),Tt(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?ht:lt)},qt=(t,e)=>{let r=e.length;if(Yt(t))return ut;const s=t.state,i=s.wrap;if(2===i||1===i&&s.status!==kt||s.lookahead)return ut;if(1===i&&(t.adler=G(t.adler,e,r,0)),s.wrap=0,r>=s.w_size){0===i&&(Bt(s.head),s.strstart=0,s.block_start=0,s.insert=0);let t=new Uint8Array(s.w_size);t.set(e.subarray(r-s.w_size,r),0),e=t,r=s.w_size}const n=t.avail_in,a=t.next_in,o=t.input;for(t.avail_in=r,t.next_in=0,t.input=e,Lt(s);s.lookahead>=3;){let t=s.strstart,e=s.lookahead-2;do{s.ins_h=Rt(s,s.ins_h,s.window[t+3-1]),s.prev[t&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=t,t++}while(--e);s.strstart=t,s.lookahead=2,Lt(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=2,s.match_available=0,t.next_in=a,t.input=o,t.avail_in=n,s.wrap=i,ht},Xt={deflateInit:(t,e)=>Gt(t,e,yt,15,8,wt),deflateInit2:Gt,deflateReset:jt,deflateResetKeep:Ht,deflateSetHeader:(t,e)=>Yt(t)||2!==t.state.wrap?ut:(t.state.gzhead=e,ht),deflate:Wt,deflateEnd:t=>{if(Yt(t))return ut;const e=t.state.status;return t.state=null,e===St?It(t,ct):ht},deflateSetDictionary:qt,deflateInfo:"pako deflate (from Nodeca project)"};const $t=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Kt=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(const e in r)$t(r,e)&&(t[e]=r[e])}}return t},Qt=t=>{let e=0;for(let s=0,i=t.length;s<i;s++)e+=t[s].length;const r=new Uint8Array(e);for(let s=0,i=0,n=t.length;s<n;s++){let e=t[s];r.set(e,i),i+=e.length}return r};let te=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Yi){te=!1}const ee=new Uint8Array(256);for(let Hi=0;Hi<256;Hi++)ee[Hi]=Hi>=252?6:Hi>=248?5:Hi>=240?4:Hi>=224?3:Hi>=192?2:1;ee[254]=ee[254]=1;var re=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,r,s,i,n,a=t.length,o=0;for(i=0;i<a;i++)r=t.charCodeAt(i),55296==(64512&r)&&i+1<a&&(s=t.charCodeAt(i+1),56320==(64512&s)&&(r=65536+(r-55296<<10)+(s-56320),i++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(o),n=0,i=0;n<o;i++)r=t.charCodeAt(i),55296==(64512&r)&&i+1<a&&(s=t.charCodeAt(i+1),56320==(64512&s)&&(r=65536+(r-55296<<10)+(s-56320),i++)),r<128?e[n++]=r:r<2048?(e[n++]=192|r>>>6,e[n++]=128|63&r):r<65536?(e[n++]=224|r>>>12,e[n++]=128|r>>>6&63,e[n++]=128|63&r):(e[n++]=240|r>>>18,e[n++]=128|r>>>12&63,e[n++]=128|r>>>6&63,e[n++]=128|63&r);return e},se=(t,e)=>{const r=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let s,i;const n=new Array(2*r);for(i=0,s=0;s<r;){let e=t[s++];if(e<128){n[i++]=e;continue}let a=ee[e];if(a>4)n[i++]=65533,s+=a-1;else{for(e&=2===a?31:3===a?15:7;a>1&&s<r;)e=e<<6|63&t[s++],a--;a>1?n[i++]=65533:e<65536?n[i++]=e:(e-=65536,n[i++]=55296|e>>10&1023,n[i++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&te)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let s=0;s<e;s++)r+=String.fromCharCode(t[s]);return r})(n,i)},ie=(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let r=e-1;for(;r>=0&&128==(192&t[r]);)r--;return r<0||0===r?e:r+ee[t[r]]>e?r:e};var ne=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const ae=Object.prototype.toString,{Z_NO_FLUSH:oe,Z_SYNC_FLUSH:he,Z_FULL_FLUSH:le,Z_FINISH:ue,Z_OK:ce,Z_STREAM_END:de,Z_DEFAULT_COMPRESSION:fe,Z_DEFAULT_STRATEGY:me,Z_DEFLATED:pe}=$;function ge(t){this.options=Kt({level:fe,method:pe,chunkSize:16384,windowBits:15,memLevel:8,strategy:me},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ne,this.strm.avail_out=0;let r=Xt.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==ce)throw new Error(X[r]);if(e.header&&Xt.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?re(e.dictionary):"[object ArrayBuffer]"===ae.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,r=Xt.deflateSetDictionary(this.strm,t),r!==ce)throw new Error(X[r]);this._dict_set=!0}}function _e(t,e){const r=new ge(e);if(r.push(t,!0),r.err)throw r.msg||X[r.err];return r.result}ge.prototype.push=function(t,e){const r=this.strm,s=this.options.chunkSize;let i,n;if(this.ended)return!1;for(n=e===~~e?e:!0===e?ue:oe,"string"==typeof t?r.input=re(t):"[object ArrayBuffer]"===ae.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(s),r.next_out=0,r.avail_out=s),(n===he||n===le)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(i=Xt.deflate(r,n),i===de)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=Xt.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===ce;if(0!==r.avail_out){if(n>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},ge.prototype.onData=function(t){this.chunks.push(t)},ge.prototype.onEnd=function(t){t===ce&&(this.result=Qt(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var we={Deflate:ge,deflate:_e,deflateRaw:function(t,e){return(e=e||{}).raw=!0,_e(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,_e(t,e)},constants:$};const be=16209;var ye=function(t,e){let r,s,i,n,a,o,h,l,u,c,d,f,m,p,g,_,w,b,y,v,x,k,S,A;const I=t.state;r=t.next_in,S=t.input,s=r+(t.avail_in-5),i=t.next_out,A=t.output,n=i-(e-t.avail_out),a=i+(t.avail_out-257),o=I.dmax,h=I.wsize,l=I.whave,u=I.wnext,c=I.window,d=I.hold,f=I.bits,m=I.lencode,p=I.distcode,g=(1<<I.lenbits)-1,_=(1<<I.distbits)-1;t:do{f<15&&(d+=S[r++]<<f,f+=8,d+=S[r++]<<f,f+=8),w=m[d&g];e:for(;;){if(b=w>>>24,d>>>=b,f-=b,b=w>>>16&255,0===b)A[i++]=65535&w;else{if(!(16&b)){if(0==(64&b)){w=m[(65535&w)+(d&(1<<b)-1)];continue e}if(32&b){I.mode=16191;break t}t.msg="invalid literal/length code",I.mode=be;break t}y=65535&w,b&=15,b&&(f<b&&(d+=S[r++]<<f,f+=8),y+=d&(1<<b)-1,d>>>=b,f-=b),f<15&&(d+=S[r++]<<f,f+=8,d+=S[r++]<<f,f+=8),w=p[d&_];r:for(;;){if(b=w>>>24,d>>>=b,f-=b,b=w>>>16&255,!(16&b)){if(0==(64&b)){w=p[(65535&w)+(d&(1<<b)-1)];continue r}t.msg="invalid distance code",I.mode=be;break t}if(v=65535&w,b&=15,f<b&&(d+=S[r++]<<f,f+=8,f<b&&(d+=S[r++]<<f,f+=8)),v+=d&(1<<b)-1,v>o){t.msg="invalid distance too far back",I.mode=be;break t}if(d>>>=b,f-=b,b=i-n,v>b){if(b=v-b,b>l&&I.sane){t.msg="invalid distance too far back",I.mode=be;break t}if(x=0,k=c,0===u){if(x+=h-b,b<y){y-=b;do{A[i++]=c[x++]}while(--b);x=i-v,k=A}}else if(u<b){if(x+=h+u-b,b-=u,b<y){y-=b;do{A[i++]=c[x++]}while(--b);if(x=0,u<y){b=u,y-=b;do{A[i++]=c[x++]}while(--b);x=i-v,k=A}}}else if(x+=u-b,b<y){y-=b;do{A[i++]=c[x++]}while(--b);x=i-v,k=A}for(;y>2;)A[i++]=k[x++],A[i++]=k[x++],A[i++]=k[x++],y-=3;y&&(A[i++]=k[x++],y>1&&(A[i++]=k[x++]))}else{x=i-v;do{A[i++]=A[x++],A[i++]=A[x++],A[i++]=A[x++],y-=3}while(y>2);y&&(A[i++]=A[x++],y>1&&(A[i++]=A[x++]))}break}}break}}while(r<s&&i<a);y=f>>3,r-=y,f-=y<<3,d&=(1<<f)-1,t.next_in=r,t.next_out=i,t.avail_in=r<s?s-r+5:5-(r-s),t.avail_out=i<a?a-i+257:257-(i-a),I.hold=d,I.bits=f};const ve=15,xe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ke=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Se=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Ae=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Ie=(t,e,r,s,i,n,a,o)=>{const h=o.bits;let l,u,c,d,f,m,p=0,g=0,_=0,w=0,b=0,y=0,v=0,x=0,k=0,S=0,A=null;const I=new Uint16Array(16),E=new Uint16Array(16);let B,N,R,T=null;for(p=0;p<=ve;p++)I[p]=0;for(g=0;g<s;g++)I[e[r+g]]++;for(b=h,w=ve;w>=1&&0===I[w];w--);if(b>w&&(b=w),0===w)return i[n++]=20971520,i[n++]=20971520,o.bits=1,0;for(_=1;_<w&&0===I[_];_++);for(b<_&&(b=_),x=1,p=1;p<=ve;p++)if(x<<=1,x-=I[p],x<0)return-1;if(x>0&&(0===t||1!==w))return-1;for(E[1]=0,p=1;p<ve;p++)E[p+1]=E[p]+I[p];for(g=0;g<s;g++)0!==e[r+g]&&(a[E[e[r+g]]++]=g);if(0===t?(A=T=a,m=20):1===t?(A=xe,T=ke,m=257):(A=Se,T=Ae,m=0),S=0,g=0,p=_,f=n,y=b,v=0,c=-1,k=1<<b,d=k-1,1===t&&k>852||2===t&&k>592)return 1;for(;;){B=p-v,a[g]+1<m?(N=0,R=a[g]):a[g]>=m?(N=T[a[g]-m],R=A[a[g]-m]):(N=96,R=0),l=1<<p-v,u=1<<y,_=u;do{u-=l,i[f+(S>>v)+u]=B<<24|N<<16|R|0}while(0!==u);for(l=1<<p-1;S&l;)l>>=1;if(0!==l?(S&=l-1,S+=l):S=0,g++,0==--I[p]){if(p===w)break;p=e[r+a[g]]}if(p>b&&(S&d)!==c){for(0===v&&(v=b),f+=_,y=p-v,x=1<<y;y+v<w&&(x-=I[y+v],!(x<=0));)y++,x<<=1;if(k+=1<<y,1===t&&k>852||2===t&&k>592)return 1;c=S&d,i[c]=b<<24|y<<16|f-n|0}}return 0!==S&&(i[f+S]=p-v<<24|64<<16|0),o.bits=b,0};const{Z_FINISH:Ee,Z_BLOCK:Be,Z_TREES:Ne,Z_OK:Re,Z_STREAM_END:Te,Z_NEED_DICT:Me,Z_STREAM_ERROR:Ce,Z_DATA_ERROR:Oe,Z_MEM_ERROR:ze,Z_BUF_ERROR:Fe,Z_DEFLATED:Le}=$,De=16180,Pe=16190,Ue=16191,Ve=16192,Ze=16194,Je=16199,Ye=16200,He=16206,je=16209,Ge=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function We(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const qe=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<De||e.mode>16211?1:0},Xe=t=>{if(qe(t))return Ce;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=De,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,Re},$e=t=>{if(qe(t))return Ce;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Xe(t)},Ke=(t,e)=>{let r;if(qe(t))return Ce;const s=t.state;return e<0?(r=0,e=-e):(r=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?Ce:(null!==s.window&&s.wbits!==e&&(s.window=null),s.wrap=r,s.wbits=e,$e(t))},Qe=(t,e)=>{if(!t)return Ce;const r=new We;t.state=r,r.strm=t,r.window=null,r.mode=De;const s=Ke(t,e);return s!==Re&&(t.state=null),s};let tr,er,rr=!0;const sr=t=>{if(rr){tr=new Int32Array(512),er=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Ie(1,t.lens,0,288,tr,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Ie(2,t.lens,0,32,er,0,t.work,{bits:5}),rr=!1}t.lencode=tr,t.lenbits=9,t.distcode=er,t.distbits=5},ir=(t,e,r,s)=>{let i;const n=t.state;return null===n.window&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new Uint8Array(n.wsize)),s>=n.wsize?(n.window.set(e.subarray(r-n.wsize,r),0),n.wnext=0,n.whave=n.wsize):(i=n.wsize-n.wnext,i>s&&(i=s),n.window.set(e.subarray(r-s,r-s+i),n.wnext),(s-=i)?(n.window.set(e.subarray(r-s,r),0),n.wnext=s,n.whave=n.wsize):(n.wnext+=i,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=i))),0};var nr=(t,e)=>{let r,s,i,n,a,o,h,l,u,c,d,f,m,p,g,_,w,b,y,v,x,k,S=0;const A=new Uint8Array(4);let I,E;const B=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(qe(t)||!t.output||!t.input&&0!==t.avail_in)return Ce;r=t.state,r.mode===Ue&&(r.mode=Ve),a=t.next_out,i=t.output,h=t.avail_out,n=t.next_in,s=t.input,o=t.avail_in,l=r.hold,u=r.bits,c=o,d=h,k=Re;t:for(;;)switch(r.mode){case De:if(0===r.wrap){r.mode=Ve;break}for(;u<16;){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}if(2&r.wrap&&35615===l){0===r.wbits&&(r.wbits=15),r.check=0,A[0]=255&l,A[1]=l>>>8&255,r.check=q(r.check,A,2,0),l=0,u=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&l)<<8)+(l>>8))%31){t.msg="incorrect header check",r.mode=je;break}if((15&l)!==Le){t.msg="unknown compression method",r.mode=je;break}if(l>>>=4,u-=4,x=8+(15&l),0===r.wbits&&(r.wbits=x),x>15||x>r.wbits){t.msg="invalid window size",r.mode=je;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=512&l?16189:Ue,l=0,u=0;break;case 16181:for(;u<16;){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}if(r.flags=l,(255&r.flags)!==Le){t.msg="unknown compression method",r.mode=je;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=je;break}r.head&&(r.head.text=l>>8&1),512&r.flags&&4&r.wrap&&(A[0]=255&l,A[1]=l>>>8&255,r.check=q(r.check,A,2,0)),l=0,u=0,r.mode=16182;case 16182:for(;u<32;){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}r.head&&(r.head.time=l),512&r.flags&&4&r.wrap&&(A[0]=255&l,A[1]=l>>>8&255,A[2]=l>>>16&255,A[3]=l>>>24&255,r.check=q(r.check,A,4,0)),l=0,u=0,r.mode=16183;case 16183:for(;u<16;){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}r.head&&(r.head.xflags=255&l,r.head.os=l>>8),512&r.flags&&4&r.wrap&&(A[0]=255&l,A[1]=l>>>8&255,r.check=q(r.check,A,2,0)),l=0,u=0,r.mode=16184;case 16184:if(1024&r.flags){for(;u<16;){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}r.length=l,r.head&&(r.head.extra_len=l),512&r.flags&&4&r.wrap&&(A[0]=255&l,A[1]=l>>>8&255,r.check=q(r.check,A,2,0)),l=0,u=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&(f=r.length,f>o&&(f=o),f&&(r.head&&(x=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(s.subarray(n,n+f),x)),512&r.flags&&4&r.wrap&&(r.check=q(r.check,s,f,n)),o-=f,n+=f,r.length-=f),r.length))break t;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(0===o)break t;f=0;do{x=s[n+f++],r.head&&x&&r.length<65536&&(r.head.name+=String.fromCharCode(x))}while(x&&f<o);if(512&r.flags&&4&r.wrap&&(r.check=q(r.check,s,f,n)),o-=f,n+=f,x)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(0===o)break t;f=0;do{x=s[n+f++],r.head&&x&&r.length<65536&&(r.head.comment+=String.fromCharCode(x))}while(x&&f<o);if(512&r.flags&&4&r.wrap&&(r.check=q(r.check,s,f,n)),o-=f,n+=f,x)break t}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;u<16;){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}if(4&r.wrap&&l!==(65535&r.check)){t.msg="header crc mismatch",r.mode=je;break}l=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Ue;break;case 16189:for(;u<32;){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}t.adler=r.check=Ge(l),l=0,u=0,r.mode=Pe;case Pe:if(0===r.havedict)return t.next_out=a,t.avail_out=h,t.next_in=n,t.avail_in=o,r.hold=l,r.bits=u,Me;t.adler=r.check=1,r.mode=Ue;case Ue:if(e===Be||e===Ne)break t;case Ve:if(r.last){l>>>=7&u,u-=7&u,r.mode=He;break}for(;u<3;){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}switch(r.last=1&l,l>>>=1,u-=1,3&l){case 0:r.mode=16193;break;case 1:if(sr(r),r.mode=Je,e===Ne){l>>>=2,u-=2;break t}break;case 2:r.mode=16196;break;case 3:t.msg="invalid block type",r.mode=je}l>>>=2,u-=2;break;case 16193:for(l>>>=7&u,u-=7&u;u<32;){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}if((65535&l)!=(l>>>16^65535)){t.msg="invalid stored block lengths",r.mode=je;break}if(r.length=65535&l,l=0,u=0,r.mode=Ze,e===Ne)break t;case Ze:r.mode=16195;case 16195:if(f=r.length,f){if(f>o&&(f=o),f>h&&(f=h),0===f)break t;i.set(s.subarray(n,n+f),a),o-=f,n+=f,h-=f,a+=f,r.length-=f;break}r.mode=Ue;break;case 16196:for(;u<14;){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}if(r.nlen=257+(31&l),l>>>=5,u-=5,r.ndist=1+(31&l),l>>>=5,u-=5,r.ncode=4+(15&l),l>>>=4,u-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=je;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;u<3;){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}r.lens[B[r.have++]]=7&l,l>>>=3,u-=3}for(;r.have<19;)r.lens[B[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,I={bits:r.lenbits},k=Ie(0,r.lens,0,19,r.lencode,0,r.work,I),r.lenbits=I.bits,k){t.msg="invalid code lengths set",r.mode=je;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;S=r.lencode[l&(1<<r.lenbits)-1],g=S>>>24,_=S>>>16&255,w=65535&S,!(g<=u);){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}if(w<16)l>>>=g,u-=g,r.lens[r.have++]=w;else{if(16===w){for(E=g+2;u<E;){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}if(l>>>=g,u-=g,0===r.have){t.msg="invalid bit length repeat",r.mode=je;break}x=r.lens[r.have-1],f=3+(3&l),l>>>=2,u-=2}else if(17===w){for(E=g+3;u<E;){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}l>>>=g,u-=g,x=0,f=3+(7&l),l>>>=3,u-=3}else{for(E=g+7;u<E;){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}l>>>=g,u-=g,x=0,f=11+(127&l),l>>>=7,u-=7}if(r.have+f>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=je;break}for(;f--;)r.lens[r.have++]=x}}if(r.mode===je)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=je;break}if(r.lenbits=9,I={bits:r.lenbits},k=Ie(1,r.lens,0,r.nlen,r.lencode,0,r.work,I),r.lenbits=I.bits,k){t.msg="invalid literal/lengths set",r.mode=je;break}if(r.distbits=6,r.distcode=r.distdyn,I={bits:r.distbits},k=Ie(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,I),r.distbits=I.bits,k){t.msg="invalid distances set",r.mode=je;break}if(r.mode=Je,e===Ne)break t;case Je:r.mode=Ye;case Ye:if(o>=6&&h>=258){t.next_out=a,t.avail_out=h,t.next_in=n,t.avail_in=o,r.hold=l,r.bits=u,ye(t,d),a=t.next_out,i=t.output,h=t.avail_out,n=t.next_in,s=t.input,o=t.avail_in,l=r.hold,u=r.bits,r.mode===Ue&&(r.back=-1);break}for(r.back=0;S=r.lencode[l&(1<<r.lenbits)-1],g=S>>>24,_=S>>>16&255,w=65535&S,!(g<=u);){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}if(_&&0==(240&_)){for(b=g,y=_,v=w;S=r.lencode[v+((l&(1<<b+y)-1)>>b)],g=S>>>24,_=S>>>16&255,w=65535&S,!(b+g<=u);){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}l>>>=b,u-=b,r.back+=b}if(l>>>=g,u-=g,r.back+=g,r.length=w,0===_){r.mode=16205;break}if(32&_){r.back=-1,r.mode=Ue;break}if(64&_){t.msg="invalid literal/length code",r.mode=je;break}r.extra=15&_,r.mode=16201;case 16201:if(r.extra){for(E=r.extra;u<E;){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}r.length+=l&(1<<r.extra)-1,l>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;S=r.distcode[l&(1<<r.distbits)-1],g=S>>>24,_=S>>>16&255,w=65535&S,!(g<=u);){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}if(0==(240&_)){for(b=g,y=_,v=w;S=r.distcode[v+((l&(1<<b+y)-1)>>b)],g=S>>>24,_=S>>>16&255,w=65535&S,!(b+g<=u);){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}l>>>=b,u-=b,r.back+=b}if(l>>>=g,u-=g,r.back+=g,64&_){t.msg="invalid distance code",r.mode=je;break}r.offset=w,r.extra=15&_,r.mode=16203;case 16203:if(r.extra){for(E=r.extra;u<E;){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}r.offset+=l&(1<<r.extra)-1,l>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=je;break}r.mode=16204;case 16204:if(0===h)break t;if(f=d-h,r.offset>f){if(f=r.offset-f,f>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=je;break}f>r.wnext?(f-=r.wnext,m=r.wsize-f):m=r.wnext-f,f>r.length&&(f=r.length),p=r.window}else p=i,m=a-r.offset,f=r.length;f>h&&(f=h),h-=f,r.length-=f;do{i[a++]=p[m++]}while(--f);0===r.length&&(r.mode=Ye);break;case 16205:if(0===h)break t;i[a++]=r.length,h--,r.mode=Ye;break;case He:if(r.wrap){for(;u<32;){if(0===o)break t;o--,l|=s[n++]<<u,u+=8}if(d-=h,t.total_out+=d,r.total+=d,4&r.wrap&&d&&(t.adler=r.check=r.flags?q(r.check,i,d,a-d):G(r.check,i,d,a-d)),d=h,4&r.wrap&&(r.flags?l:Ge(l))!==r.check){t.msg="incorrect data check",r.mode=je;break}l=0,u=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;u<32;){if(0===o)break t;o--,l+=s[n++]<<u,u+=8}if(4&r.wrap&&l!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=je;break}l=0,u=0}r.mode=16208;case 16208:k=Te;break t;case je:k=Oe;break t;case 16210:return ze;default:return Ce}return t.next_out=a,t.avail_out=h,t.next_in=n,t.avail_in=o,r.hold=l,r.bits=u,(r.wsize||d!==t.avail_out&&r.mode<je&&(r.mode<He||e!==Ee))&&ir(t,t.output,t.next_out,d-t.avail_out),c-=t.avail_in,d-=t.avail_out,t.total_in+=c,t.total_out+=d,r.total+=d,4&r.wrap&&d&&(t.adler=r.check=r.flags?q(r.check,i,d,t.next_out-d):G(r.check,i,d,t.next_out-d)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Ue?128:0)+(r.mode===Je||r.mode===Ze?256:0),(0===c&&0===d||e===Ee)&&k===Re&&(k=Fe),k},ar={inflateReset:$e,inflateReset2:Ke,inflateResetKeep:Xe,inflateInit:t=>Qe(t,15),inflateInit2:Qe,inflate:nr,inflateEnd:t=>{if(qe(t))return Ce;let e=t.state;return e.window&&(e.window=null),t.state=null,Re},inflateGetHeader:(t,e)=>{if(qe(t))return Ce;const r=t.state;return 0==(2&r.wrap)?Ce:(r.head=e,e.done=!1,Re)},inflateSetDictionary:(t,e)=>{const r=e.length;let s,i,n;return qe(t)?Ce:(s=t.state,0!==s.wrap&&s.mode!==Pe?Ce:s.mode===Pe&&(i=1,i=G(i,e,r,0),i!==s.check)?Oe:(n=ir(t,e,r,r),n?(s.mode=16210,ze):(s.havedict=1,Re)))},inflateInfo:"pako inflate (from Nodeca project)"};var or=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const hr=Object.prototype.toString,{Z_NO_FLUSH:lr,Z_FINISH:ur,Z_OK:cr,Z_STREAM_END:dr,Z_NEED_DICT:fr,Z_STREAM_ERROR:mr,Z_DATA_ERROR:pr,Z_MEM_ERROR:gr}=$;function _r(t){this.options=Kt({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ne,this.strm.avail_out=0;let r=ar.inflateInit2(this.strm,e.windowBits);if(r!==cr)throw new Error(X[r]);if(this.header=new or,ar.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=re(e.dictionary):"[object ArrayBuffer]"===hr.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=ar.inflateSetDictionary(this.strm,e.dictionary),r!==cr)))throw new Error(X[r])}function wr(t,e){const r=new _r(e);if(r.push(t),r.err)throw r.msg||X[r.err];return r.result}_r.prototype.push=function(t,e){const r=this.strm,s=this.options.chunkSize,i=this.options.dictionary;let n,a,o;if(this.ended)return!1;for(a=e===~~e?e:!0===e?ur:lr,"[object ArrayBuffer]"===hr.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(0===r.avail_out&&(r.output=new Uint8Array(s),r.next_out=0,r.avail_out=s),n=ar.inflate(r,a),n===fr&&i&&(n=ar.inflateSetDictionary(r,i),n===cr?n=ar.inflate(r,a):n===pr&&(n=fr));r.avail_in>0&&n===dr&&r.state.wrap>0&&0!==t[r.next_in];)ar.inflateReset(r),n=ar.inflate(r,a);switch(n){case mr:case pr:case fr:case gr:return this.onEnd(n),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(0===r.avail_out||n===dr))if("string"===this.options.to){let t=ie(r.output,r.next_out),e=r.next_out-t,i=se(r.output,t);r.next_out=e,r.avail_out=s-e,e&&r.output.set(r.output.subarray(t,t+e),0),this.onData(i)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(n!==cr||0!==o){if(n===dr)return n=ar.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},_r.prototype.onData=function(t){this.chunks.push(t)},_r.prototype.onEnd=function(t){t===cr&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Qt(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var br={Inflate:_r,inflate:wr,inflateRaw:function(t,e){return(e=e||{}).raw=!0,wr(t,e)},ungzip:wr,constants:$};const{Deflate:yr,deflate:vr,deflateRaw:xr,gzip:kr}=we,{Inflate:Sr,inflate:Ar,inflateRaw:Ir,ungzip:Er}=br;var Br,Nr,Rr,Tr={Deflate:yr,deflate:vr,deflateRaw:xr,gzip:kr,Inflate:Sr,inflate:Ar,inflateRaw:Ir,ungzip:Er,constants:$};class Mr{littleEndian;offset;buffer;array;view;constructor(t){this.littleEndian=t?.littleEndian??!1,this.offset=t?.offset??0,this.buffer=new ArrayBuffer(t?.initialSize??1024),this.array=new Uint8Array(this.buffer),this.view=new DataView(this.buffer)}accommodate(t){const e=this.offset+t;if(this.buffer.byteLength>=e)return;let r=this.buffer.byteLength;for(;r<e;)r*=2;const s=new ArrayBuffer(r),i=new Uint8Array(s);i.set(this.array),this.offset>this.buffer.byteLength&&i.fill(0,this.buffer.byteLength,this.offset),this.buffer=s,this.view=new DataView(s),this.array=i}writeNumber(t,e,r){this.accommodate(e),this.view[t](this.offset,r,this.littleEndian),this.offset+=e}writeByte=this.writeNumber.bind(this,"setInt8",1);writeShort=this.writeNumber.bind(this,"setInt16",2);writeInt=this.writeNumber.bind(this,"setInt32",4);writeFloat=this.writeNumber.bind(this,"setFloat32",4);writeDouble=this.writeNumber.bind(this,"setFloat64",8);writeBytes(t){this.accommodate(t.length),this.array.set(t,this.offset),this.offset+=t.length}writeString(t){const e=function(t){var e,r,s=[];for(e=0;e<t.length;e++)(r=t.charCodeAt(e))<128?s.push(r):r<2048?(s.push(192|r>>6),s.push(128|63&r)):r<65536?(s.push(224|r>>12),s.push(128|r>>6&63),s.push(128|63&r)):(s.push(240|r>>18&7),s.push(128|r>>12&63),s.push(128|r>>6&63),s.push(128|63&r));return s}(t);this.writeShort(e.length),this.writeBytes(e)}getData(){return this.accommodate(0),this.array.slice(0,this.offset)}}class Cr{littleEndian;offset;array;view;constructor(t,e){this.littleEndian=e?.littleEndian??!1,this.offset=e?.offset??0,this.array=t instanceof Uint8Array?t:new Uint8Array(t),this.view=new DataView(this.array.buffer,this.array.byteOffset)}readNumber(t,e){const r=this.view[t](this.offset,this.littleEndian);return this.offset+=e,r}readByte=this.readNumber.bind(this,"getInt8",1);readShort=this.readNumber.bind(this,"getInt16",2);readInt=this.readNumber.bind(this,"getInt32",4);readFloat=this.readNumber.bind(this,"getFloat32",4);readDouble=this.readNumber.bind(this,"getFloat64",8);readBytes(t){const e=this.array.slice(this.offset,this.offset+t);return this.offset+=t,e}readString(){const t=this.readShort();return function(t){var e,r=[];for(e=0;e<t.length;e++)0==(128&t[e])?r.push(127&t[e]):e+1<t.length&&192==(224&t[e])&&128==(192&t[e+1])?r.push((31&t[e])<<6|63&t[e+1]):e+2<t.length&&224==(240&t[e])&&128==(192&t[e+1])&&128==(192&t[e+2])?r.push((15&t[e])<<12|(63&t[e+1])<<6|63&t[e+2]):e+3<t.length&&240==(248&t[e])&&128==(192&t[e+1])&&128==(192&t[e+2])&&128==(192&t[e+3])&&r.push((7&t[e])<<18|(63&t[e+1])<<12|(63&t[e+2])<<6|63&t[e+3]);return String.fromCharCode.apply(null,r)}(this.readBytes(t))}}!function(t){t[t.End=0]="End",t[t.Byte=1]="Byte",t[t.Short=2]="Short",t[t.Int=3]="Int",t[t.Long=4]="Long",t[t.Float=5]="Float",t[t.Double=6]="Double",t[t.ByteArray=7]="ByteArray",t[t.String=8]="String",t[t.List=9]="List",t[t.Compound=10]="Compound",t[t.IntArray=11]="IntArray",t[t.LongArray=12]="LongArray"}(Br||(Br={}));class Or{static FACTORIES=new Map;static register(t,e){Or.FACTORIES.set(t,e)}isEnd(){return this.getId()===Br.End}isByte(){return this.getId()===Br.Byte}isShort(){return this.getId()===Br.Short}isInt(){return this.getId()===Br.Int}isLong(){return this.getId()===Br.Long}isFloat(){return this.getId()===Br.Float}isDouble(){return this.getId()===Br.Double}isByteArray(){return this.getId()===Br.ByteArray}isString(){return this.getId()===Br.String}isList(){return this.getId()===Br.List}isCompound(){return this.getId()===Br.Compound}isIntArray(){return this.getId()===Br.IntArray}isLongArray(){return this.getId()===Br.LongArray}isNumber(){return this.isByte()||this.isShort()||this.isInt()||this.isLong()||this.isFloat()||this.isDouble()}isArray(){return this.isByteArray()||this.isIntArray()||this.isLongArray()}isListOrArray(){return this.isList()||this.isArray()}getAsNumber(){return 0}getAsString(){return""}toJsonWithId(){return{type:this.getId(),value:this.toJson()}}static getFactory(t){const e=this.FACTORIES.get(t);if(!e)throw new Error(`Invalid tag id ${t}`);return e}static create(t){return this.getFactory(t).create()}static fromString(t){const e="string"==typeof t?new i(t):t;return this.getFactory(Br.Compound).fromString(e)}static fromJson(t,e=Br.Compound){return this.getFactory(e).fromJson(t)}static fromJsonWithId(t){const e=s.readObject(t)??{},r=s.readInt(e.type)??0;return Or.fromJson(e.value??{},r)}static fromBytes(t,e=Br.Compound){return this.getFactory(e).fromBytes(t)}}class zr extends Or{static ZERO=new zr(0);static ONE=new zr(1);value;constructor(t){super(),this.value="number"==typeof t?t:t?1:0}getId(){return Br.Byte}getAsNumber(){return this.value}toString(){return this.value.toFixed()+"b"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(t){t.writeByte(this.value)}static create(){return zr.ZERO}static fromJson(t){return new zr(s.readInt(t)??0)}static fromBytes(t){const e=t.readByte();return new zr(e)}}Or.register(Br.Byte,zr);class Fr extends Or{items;constructor(t){super(),this.items=t}getItems(){return this.items.slice(0)}getAsTuple(t,e){return[...Array(t)].map(((t,r)=>e(this.items[r])))}get(t){if(!((t=Math.floor(t))<0||t>=this.items.length))return this.items[t]}get length(){return this.items.length}map(t){return this.items.map(t)}filter(t){return this.items.filter(t)}forEach(t){this.items.forEach(t)}set(t,e){this.items[t]=e}add(t){this.items.push(t)}insert(t,e){this.items.splice(t,0,e)}delete(t){this.items.splice(t,1)}clear(){this.items=[]}}class Lr extends Fr{type;constructor(t,e){super(t??[]),this.type=0===this.items.length?Br.End:e??this.items[0].getId()}static make(t,e){return new Lr(e.map((e=>new t(e))))}getId(){return Br.List}getType(){return this.type}getNumber(t){const e=this.get(t);return e?.isNumber()?e.getAsNumber():0}getString(t){const e=this.get(t);return e?.isString()?e.getAsString():""}getList(t,e){const r=this.get(t);return r?.isList()&&r.getType()===e?r:Lr.create()}getCompound(t){const e=this.get(t);return e?.isCompound()?e:jr.create()}set(t,e){this.updateType(e),super.set(t,e)}add(t){this.updateType(t),super.add(t)}insert(t,e){this.updateType(e),super.insert(t,e)}updateType(t){if(t.getId()!==Br.End)if(this.type===Br.End)this.type=t.getId();else if(this.type!==t.getId())throw new Error(`Trying to add tag of type ${Br[t.getId()]} to list of ${Br[this.type]}`)}clear(){super.clear(),this.type=Br.End}toString(){return"["+this.items.map((t=>t.toString())).join(",")+"]"}toPrettyString(t="  ",e=0){if(0===this.length)return"[]";const r=t.repeat(e),s=t.repeat(e+1);return"[\n"+this.map((r=>s+r.toPrettyString(t,e+1))).join(",\n")+"\n"+r+"]"}toSimplifiedJson(){return this.map((t=>t.toSimplifiedJson()))}toJson(){return{type:this.type,items:this.items.map((t=>t.toJson()))}}toBytes(t){0===this.items.length?this.type=Br.End:this.type=this.items[0].getId(),t.writeByte(this.type),t.writeInt(this.items.length);for(const e of this.items)e.toBytes(t)}static create(){return new Lr}static fromJson(t){const e=s.readObject(t)??{},r=s.readNumber(e.type)??Br.Compound,i=(s.readArray(e.items)??[]).flatMap((t=>void 0!==t?[Or.fromJson(t,r)]:[]));return new Lr(i,r)}static fromBytes(t){const e=t.readByte(),r=t.readInt();if(e===Br.End&&r>0)throw new Error(`Missing type on ListTag but length is ${r}`);const s=[];for(let i=0;i<r;i+=1)s.push(Or.fromBytes(t,e));return new Lr(s,e)}}Or.register(Br.List,Lr);class Dr extends Fr{constructor(t){super(Array.from(t??[],(t=>"number"==typeof t?new zr(t):t)))}getId(){return Br.ByteArray}getType(){return Br.Byte}toString(){return"[B;"+this.items.map((t=>t.getAsNumber().toFixed()+"B")).join(",")+"]"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.items.map((t=>t.getAsNumber()))}toJson(){return this.items.map((t=>t.getAsNumber()))}toBytes(t){t.writeInt(this.items.length),t.writeBytes(this.items.map((t=>t.getAsNumber())))}static create(){return new Dr([])}static fromJson(t){const e=s.readArray(t,(t=>s.readNumber(t)??0))??[];return new Dr(e)}static fromBytes(t){const e=t.readInt(),r=t.readBytes(e);return new Dr(r)}}Or.register(Br.ByteArray,Dr);class Pr extends Or{value;constructor(t){super(),this.value=t}getId(){return Br.Float}getAsNumber(){return this.value}toString(){return this.value.toFixed()}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(t){t.writeFloat(this.value)}static create(){return new Pr(0)}static fromJson(t){return new Pr(s.readNumber(t)??0)}static fromBytes(t){const e=t.readFloat();return new Pr(e)}}Or.register(Br.Float,Pr);class Ur extends Or{value;constructor(t){super(),this.value=t}getId(){return Br.Int}getAsNumber(){return this.value}toString(){return this.value.toFixed()}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(t){t.writeInt(this.value)}static create(){return new Ur(0)}static fromJson(t){return new Ur(s.readInt(t)??0)}static fromBytes(t){const e=t.readInt();return new Ur(e)}}Or.register(Br.Int,Ur);class Vr extends Fr{constructor(t){super(Array.from(t??[],(t=>"number"==typeof t?new Ur(t):t)))}getId(){return Br.IntArray}getType(){return Br.Int}get length(){return this.items.length}toString(){return"[I;"+this.items.map((t=>t.getAsNumber().toFixed())).join(",")+"]"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.items.map((t=>t.getAsNumber()))}toJson(){return this.items.map((t=>t.getAsNumber()))}toBytes(t){t.writeInt(this.items.length);for(const e of this.items)t.writeInt(e.getAsNumber())}static create(){return new Vr}static fromJson(t){const e=s.readArray(t,(t=>s.readNumber(t)??0))??[];return new Vr(e)}static fromBytes(t){const e=t.readInt(),r=[];for(let s=0;s<e;s+=1)r.push(t.readInt());return new Vr(r)}}Or.register(Br.IntArray,Vr);class Zr extends Or{static dataview=new DataView(new Uint8Array(8).buffer);value;constructor(t){super(),this.value=Zr.toPair(t)}static toPair(t){return Array.isArray(t)?t:Zr.bigintToPair(t)}static bigintToPair(t){return Zr.dataview.setBigInt64(0,t),[Zr.dataview.getInt32(0),Zr.dataview.getInt32(4)]}static pairToBigint(t){return Zr.dataview.setInt32(0,Number(t[0])),Zr.dataview.setInt32(4,Number(t[1])),Zr.dataview.getBigInt64(0)}static pairToString(t){return Zr.pairToBigint(t).toString()}static pairToNumber(t){return Number(Zr.pairToBigint(t))}getId(){return Br.Long}getAsNumber(){return Zr.pairToNumber(this.value)}getAsPair(){return this.value}toBigInt(){return Zr.pairToBigint(this.value)}toString(){return Zr.pairToString(this.value)+"L"}toPrettyString(){return this.toString()}toSimplifiedJson(){return Zr.pairToNumber(this.value)}toJson(){return this.value}toBytes(t){t.writeInt(this.value[0]),t.writeInt(this.value[1])}static create(){return new Zr([0,0])}static fromJson(t){return new Zr(Array.isArray(t)&&2===t.length?t.map((t=>"number"==typeof t?t:0)):[0,0])}static fromBytes(t){const e=t.readInt(),r=t.readInt();return new Zr([e,r])}}Or.register(Br.Long,Zr);class Jr extends Fr{constructor(t){super(Array.from(t??[],(t=>"bigint"==typeof t||Array.isArray(t)?new Zr(t):t)))}getId(){return Br.LongArray}getType(){return Br.Long}get length(){return this.items.length}toString(){return"[I;"+this.items.map((t=>t.toString())).join(",")+"]"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.items.map((t=>t.getAsPair()))}toJson(){return this.items.map((t=>t.getAsPair()))}toBytes(t){t.writeInt(this.items.length);for(const e of this.items){const[r,s]=e.getAsPair();t.writeInt(r),t.writeInt(s)}}static create(){return new Jr}static fromJson(t){const e=s.readArray(t,(t=>s.readPair(t,(t=>s.readNumber(t)??0))??[0,0]))??[];return new Jr(e)}static fromBytes(t){const e=t.readInt(),r=[];for(let s=0;s<e;s+=1)r.push([t.readInt(),t.readInt()]);return new Jr(r)}}Or.register(Br.LongArray,Jr);class Yr extends Or{value;constructor(t){super(),this.value=t}getId(){return Br.Short}getAsNumber(){return this.value}toString(){return this.value.toFixed()+"s"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(t){t.writeShort(this.value)}static create(){return new Yr(0)}static fromJson(t){return new Yr("number"==typeof t?Math.floor(t):0)}static fromBytes(t){const e=t.readShort();return new Yr(e)}}Or.register(Br.Short,Yr);class Hr extends Or{static EMPTY=new Hr("");value;constructor(t){super(),this.value=t}getId(){return Br.String}getAsString(){return this.value}toString(){return'"'+this.value.replace(/(\\|")/g,"\\$1")+'"'}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(t){t.writeString(this.value)}static create(){return Hr.EMPTY}static fromJson(t){return new Hr("string"==typeof t?t:"")}static fromBytes(t){const e=t.readString();return new Hr(e)}}Or.register(Br.String,Hr),function(t){const e=new RegExp("^[-+]?(?:[0-9]+[.]|[0-9]*[.][0-9]+)(?:e[-+]?[0-9]+)?$","i"),r=new RegExp("^[-+]?(?:[0-9]+[.]?|[0-9]*[.][0-9]+)(?:e[-+]?[0-9]+)?d$","i"),s=new RegExp("^[-+]?(?:[0-9]+[.]?|[0-9]*[.][0-9]+)(?:e[-+]?[0-9]+)?f$","i"),n=new RegExp("^[-+]?(?:0|[1-9][0-9]*)b$","i"),a=new RegExp("^[-+]?(?:0|[1-9][0-9]*)l$","i"),o=new RegExp("^[-+]?(?:0|[1-9][0-9]*)s$","i"),h=new RegExp("^[-+]?(?:0|[1-9][0-9]*)$","i");function l(t){if(t.skipWhitespace(),!t.canRead())throw t.createError("Expected value");const d=t.peek();if("{"===d)return function(t){t.expect("{",!0);const e=new Map;t.skipWhitespace();for(;t.canRead()&&"}"!==t.peek();){const r=t.cursor;if(t.skipWhitespace(),!t.canRead())throw t.createError("Expected key");const s=t.readString();if(0===s.length)throw t.cursor=r,t.createError("Expected key");t.expect(":",!0);const i=l(t);if(e.set(s,i),!c(t))break;if(!t.canRead())throw t.createError("Expected key")}return t.expect("}",!0),new jr(e)}(t);if("["===d){if(t.canRead(3)&&!i.isQuotedStringStart(t.peek(1))&&";"===t.peek(2)){t.expect("[",!0);const e=t.cursor,r=t.read();if(t.skip(),t.skipWhitespace(),t.canRead()){if("B"===r)return u(t,Dr,Br.ByteArray,Br.Byte);if("L"===r)return u(t,Jr,Br.LongArray,Br.Long);if("I"===r)return u(t,Vr,Br.IntArray,Br.Int);throw t.cursor=e,t.createError(`Invalid array type '${r}'`)}throw t.createError("Expected value")}return function(t){if(t.expect("[",!0),t.skipWhitespace(),!t.canRead())throw t.createError("Expected value");const e=[];let r=Br.End;for(;"]"!==t.peek();){const s=t.cursor,i=l(t),n=i.getId();if(r===Br.End)r=n;else if(n!==r)throw t.cursor=s,t.createError(`Can't insert ${Br[n]} into list of ${Br[r]}`);if(e.push(i),!c(t))break;if(!t.canRead())throw t.createError("Expected value")}return t.expect("]",!0),new Lr(e,r)}(t)}{t.skipWhitespace();const l=t.cursor;if(i.isQuotedStringStart(t.peek()))return new Hr(t.readQuotedString());{const i=t.readUnquotedString();if(0===i.length)throw t.cursor=l,t.createError("Expected value");try{if(s.test(i)){const t=Number(i.substring(0,i.length-1));return new Pr(t)}if(n.test(i)){const t=Number(i.substring(0,i.length-1));return new zr(Math.floor(t))}if(a.test(i)){const t=BigInt(i.substring(0,i.length-1));return new Zr(t)}if(o.test(i)){const t=Number(i.substring(0,i.length-1));return new Yr(Math.floor(t))}if(h.test(i)){const t=Number(i);return new Ur(Math.floor(t))}if(r.test(i)){const t=Number(i.substring(0,i.length-1));return new $r(t)}if(e.test(i)){const t=Number(i);return new $r(t)}if("true"===i.toLowerCase())return zr.ONE;if("false"===i.toLowerCase())return zr.ZERO}catch(f){}return 0===i.length?Hr.EMPTY:new Hr(i)}}}function u(t,e,r,s){const i=[];for(;"]"!==t.peek();){const e=l(t);if(e.getId()!==s)throw t.createError(`Can't insert ${Br[e.getId()]} into ${Br[r]}`);if(i.push(e.isLong()?e.getAsPair():e.getAsNumber()),!c(t))break;if(!t.canRead())throw t.createError("Expected value")}return t.expect("]"),new e(i)}function c(t){return t.skipWhitespace(),!(!t.canRead()||","!==t.peek())&&(t.skip(),t.skipWhitespace(),!0)}t.readTag=l}(Nr||(Nr={}));class jr extends Or{properties;constructor(t){super(),this.properties=t??new Map}getId(){return Br.Compound}has(t){return this.properties.has(t)}hasNumber(t){return this.get(t)?.isNumber()??!1}hasString(t){return this.get(t)?.isString()??!1}hasList(t,e,r){const s=this.get(t);return(s?.isList()&&(void 0===e||s.getType()===e)&&(void 0===r||s.length===r))??!1}hasCompound(t){return this.get(t)?.isCompound()??!1}get(t){return this.properties.get(t)}getString(t){return this.get(t)?.getAsString()??""}getNumber(t){return this.get(t)?.getAsNumber()??0}getList(t,e){const r=this.get(t);return!r?.isList()||void 0!==e&&r.getType()!==e?Lr.create():r}getCompound(t){const e=this.get(t);return e?.isCompound()?e:jr.create()}getByteArray(t){const e=this.get(t);return e?.isByteArray()?e:Dr.create()}getIntArray(t){const e=this.get(t);return e?.isIntArray()?e:Vr.create()}getLongArray(t){const e=this.get(t);return e?.isLongArray()?e:Jr.create()}keys(){return this.properties.keys()}get size(){return this.properties.size}map(t){return Object.fromEntries([...this.properties.entries()].map((([e,r])=>t(e,r,this))))}forEach(t){[...this.properties.entries()].forEach((([e,r])=>t(e,r,this)))}set(t,e){return this.properties.set(t,e),this}delete(t){return this.properties.delete(t)}clear(){return this.properties.clear(),this}toString(){const t=[];for(const[e,r]of this.properties.entries()){const s=e.split("").some((t=>!i.isAllowedInUnquotedString(t)));t.push((s?JSON.stringify(e):e)+":"+r.toString())}return"{"+t.join(",")+"}"}toPrettyString(t="  ",e=0){if(0===this.size)return"{}";const r=t.repeat(e),s=t.repeat(e+1);return"{\n"+Object.values(this.map(((r,i)=>[r,s+r+": "+i.toPrettyString(t,e+1)]))).join(",\n")+"\n"+r+"}"}toSimplifiedJson(){return this.map(((t,e)=>[t,e.toSimplifiedJson()]))}toJson(){return this.map(((t,e)=>[t,{type:e.getId(),value:e.toJson()}]))}toBytes(t){for(const[e,r]of this.properties.entries()){const s=r.getId();t.writeByte(s),t.writeString(e),r.toBytes(t)}t.writeByte(Br.End)}static create(){return new jr}static fromString(t){return Nr.readTag(t)}static fromJson(t){const e=s.readMap(t,(t=>{const{type:e,value:r}=s.readObject(t)??{},i=s.readNumber(e);return Or.fromJson(r??{},i)}));return new jr(new Map(Object.entries(e)))}static fromBytes(t){const e=new Map;for(;;){const r=t.readByte();if(r===Br.End)break;const s=t.readString(),i=Or.fromBytes(t,r);e.set(s,i)}return new jr(e)}}Or.register(Br.Compound,jr);class Gr{name;root;compression;littleEndian;bedrockHeader;static DEFAULT_NAME="";static DEFAULT_BEDROCK_HEADER=4;constructor(t,e,r,s,i){this.name=t,this.root=e,this.compression=r,this.littleEndian=s,this.bedrockHeader=i}writeNamedTag(t){t.writeByte(Br.Compound),t.writeString(this.name),this.root.toBytes(t)}write(){const t=!0===this.littleEndian||void 0!==this.bedrockHeader,e=new Mr({littleEndian:t,offset:this.bedrockHeader&&8});if(this.writeNamedTag(e),void 0!==this.bedrockHeader){const t=e.offset;e.offset=0,e.writeInt(this.bedrockHeader),e.writeInt(t-8),e.offset=t}const r=e.getData();return"gzip"===this.compression?Tr.gzip(r):"zlib"===this.compression?Tr.deflate(r):r}static readNamedTag(t){if(t.readByte()!==Br.Compound)throw new Error("Top tag should be a compound");return{name:t.readString(),root:jr.fromBytes(t)}}static create(t={}){const e=t.name??Gr.DEFAULT_NAME,r=jr.create(),s=t.compression??"none",i="boolean"==typeof t.bedrockHeader?Gr.DEFAULT_BEDROCK_HEADER:t.bedrockHeader,n=t.littleEndian??void 0!==t.bedrockHeader;return new Gr(e,r,s,n,i)}static read(t,e={}){const r="number"!=typeof e.bedrockHeader?void 0:function(t){const e=t.slice(0,8),r=new DataView(e.buffer,e.byteOffset),s=r.getUint32(0,!0),i=r.getUint32(4,!0);if(8===e.length&&s>0&&s<100&&i===t.byteLength-8)return s}(t),s="gzip"===e.compression||!r&&void 0===e.compression&&function(t){var e=t.slice(0,2);return 2===e.length&&31===e[0]&&139===e[1]}(t),i="zlib"===e.compression||!r&&void 0===e.compression&&function(t){const e=t.slice(0,2);return 2===e.length&&120===e[0]&&(1===e[1]||94===e[1]||156===e[1]||218===e[2])}(t),n=i||s?Tr.inflate(t):t,a=e.littleEndian||void 0!==r,o=s?"gzip":i?"zlib":"none",h=new Cr(n,{littleEndian:a,offset:r&&8}),{name:l,root:u}=Gr.readNamedTag(h);return new Gr(e.name??l,u,o,a,r)}toJson(){return{name:this.name,root:this.root.toJson(),compression:this.compression,littleEndian:this.littleEndian,bedrockHeader:this.bedrockHeader??null}}static fromJson(t){const e=s.readObject(t)??{},r=s.readString(e.name)??"",i=jr.fromJson(e.root??{}),n=s.readString(e.compression)??"none",a=s.readBoolean(e.littleEndian)??!1,o=s.readNumber(e.bedrockHeader);return new Gr(r,i,n,a,o)}}class Wr{x;z;compression;timestamp;raw;file;dirty;constructor(t,e,r,s,i){this.x=t,this.z=e,this.compression=r,this.timestamp=s,this.raw=i,this.dirty=!1}getCompression(){switch(this.compression){case 1:return"gzip";case 2:return"zlib";case 3:return"none";default:throw new Error(`Invalid compression mode ${this.compression}`)}}setCompression(t){switch(t){case"gzip":this.compression=1;break;case"zlib":this.compression=2;break;case"none":this.compression=3;break;default:throw new Error(`Invalid compression mode ${t}`)}}getFile(){return void 0===this.file&&(this.file=Gr.read(this.raw,{compression:this.getCompression()})),this.file}getRoot(){return this.getFile().root}setRoot(t){void 0===this.file&&(this.file=Gr.create({compression:this.getCompression()})),this.file.root=t,this.markDirty()}markDirty(){this.dirty=!0}getRaw(){if(void 0===this.file||!1===this.dirty)return this.raw;this.file.compression=this.getCompression();const t=this.file.write();return this.raw=t,this.dirty=!1,t}toJson(){return{x:this.x,z:this.z,compression:this.compression,timestamp:this.timestamp,size:this.raw.byteLength}}toRef(t){return new Wr.Ref(this.x,this.z,this.compression,this.timestamp,this.raw.byteLength,t)}static create(t,e,r,s){const i=new Wr(t,e,0,s??0,r.write());return i.setCompression(r.compression),i}static fromJson(t,e){const r=s.readObject(t)??{},i=s.readInt(r.x)??0,n=s.readInt(r.z)??0,a=s.readNumber(r.compression)??2,o=s.readInt(r.timestamp)??0,h=s.readInt(r.size)??0;return new Wr.Ref(i,n,a,o,h,e)}}!function(t){t.Ref=class{x;z;compression;timestamp;size;resolver;file;resolved=!1;constructor(t,e,r,s,i,n){this.x=t,this.z=e,this.compression=r,this.timestamp=s,this.size=i,this.resolver=n}getFile(){if(this.file instanceof Gr)return this.file}async getFileAsync(){return this.file||(this.file=(async()=>{const t=await this.resolver(this.x,this.z);return this.file=t,this.resolved=!0,t})()),this.file}async getRoot(){return(await this.getFileAsync()).root}isResolved(){return this.resolved}}}(Wr||(Wr={}));class qr{chunks;constructor(t){this.chunks=Array(1024).fill(null);for(const e of t){const t=Xr.getIndex(e.x,e.z);this.chunks[t]=e}}getChunkPositions(){return this.chunks.flatMap((t=>t?[[t.x,t.z]]:[]))}getChunk(t){if(!(t<0||t>=1024))return this.chunks[t]}findChunk(t,e){return this.getChunk(Xr.getIndex(t,e))}getFirstChunk(){return this.getChunk(0)}filter(t){return this.chunks.filter((e=>e&&t(e)))}map(t){return this.chunks.map((e=>e?t(e):null))}}class Xr extends qr{constructor(t){super(t)}write(){let t=0;for(const i of this.chunks)null!==i&&(t+=Math.ceil(i.getRaw().length/4096));const e=new Uint8Array(8192+4096*t),r=new DataView(e.buffer);let s=2;for(const i of this.chunks){if(null===i)continue;const t=i.getRaw(),n=4*((31&i.x)+32*(31&i.z)),a=Math.ceil(t.length/4096);r.setInt8(n,s>>16),r.setInt16(n+1,65535&s),r.setInt8(n+3,a),r.setInt32(n+4096,i.timestamp);const o=4096*s;r.setInt32(o,t.length+1),r.setInt8(o+4,i.compression),e.set(t,o+5),s+=a}return e}static read(t){const e=[];for(let r=0;r<32;r+=1)for(let s=0;s<32;s+=1){const i=4*((31&r)+32*(31&s));if(0===t[i+3])continue;const n=(t[i]<<16)+(t[i+1]<<8)+t[i+2],a=(t[i+4096]<<24)+(t[i+4097]<<16)+(t[i+4098]<<8)+t[i+4099],o=4096*n,h=(t[o]<<24)+(t[o+1]<<16)+(t[o+2]<<8)+t[o+3],l=t[o+4],u=t.slice(o+5,o+4+h);e.push(new Wr(r,s,l,a,u))}return new Xr(e)}static getIndex(t,e){return(31&t)+32*(31&e)}toJson(){return{chunks:this.chunks.flatMap((t=>t?[t.toJson()]:[]))}}static fromJson(t,e){const r=s.readObject(t)??{},i=(s.readArray(r.chunks)??[]).flatMap((t=>t?[Wr.fromJson(t,e)]:[]));return new Xr.Ref(i)}}!function(t){t.Ref=class extends qr{}}(Xr||(Xr={}));class $r extends Or{value;constructor(t){super(),this.value=t}getId(){return Br.Double}getAsNumber(){return this.value}toString(){return this.value.toFixed()}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(t){t.writeDouble(this.value)}static create(){return new $r(0)}static fromJson(t){return new $r(s.readNumber(t)??0)}static fromBytes(t){const e=t.readDouble();return new $r(e)}}Or.register(Br.Double,$r);class Kr extends Or{static INSTANCE=new Kr;constructor(){super()}getId(){return Br.End}toString(){return"END"}toPrettyString(){return this.toString()}toSimplifiedJson(){return null}toJson(){return null}toBytes(){}static create(){return Kr.INSTANCE}static fromJson(){return Kr.INSTANCE}static fromBytes(){return Kr.INSTANCE}}Or.register(Br.Double,Kr),function(t){t.UP="up",t.DOWN="down",t.NORTH="north",t.EAST="east",t.SOUTH="south",t.WEST="west"}(Rr||(Rr={}));const Qr={[Rr.UP]:[0,1,0],[Rr.DOWN]:[0,-1,0],[Rr.NORTH]:[0,0,-1],[Rr.EAST]:[1,0,0],[Rr.SOUTH]:[0,0,1],[Rr.WEST]:[-1,0,0]};var ts,es,rs,ss,is;!function(t){t.ALL=[t.UP,t.DOWN,t.NORTH,t.EAST,t.SOUTH,t.WEST],t.normal=function(t){return Qr[t]}}(Rr||(Rr={})),function(t){t.create=function(t,e,r){return[t,e,r]},t.ZERO=t.create(0,0,0),t.offset=function(t,e,r,s){return[t[0]+e,t[1]+r,t[2]+s]},t.towards=function(e,r){return t.offset(e,...Rr.normal(r))},t.equals=function(t,e){return t===e||t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},t.magnitude=function(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]},t.toNbt=function(t){return new Lr(t.map((t=>new Ur(t))))},t.fromNbt=function(t){return t.getAsTuple(3,(t=>t?.isInt()?t.getAsNumber():0))}}(ts||(ts={}));class ns{namespace;path;static DEFAULT_NAMESPACE="minecraft";static SEPARATOR=":";constructor(t,e){if(this.namespace=t,this.path=e,!t.match(/^[a-z0-9._-]*$/))throw new Error(`Non [a-z0-9._-] character in namespace of ${t}${ns.SEPARATOR}${e}`);if(!e.match(/^[a-z0-9/._-]*$/))throw new Error(`Non [a-z0-9/._-] character in path of ${t}${ns.SEPARATOR}${e}`)}equals(t){return this===t||this.namespace===t.namespace&&this.path===t.path}toString(){return this.namespace+ns.SEPARATOR+this.path}withPrefix(t){return new ns(this.namespace,t+this.path)}static create(t){return new ns(this.DEFAULT_NAMESPACE,t)}static parse(t){const e=t.indexOf(this.SEPARATOR);if(e>=0){const r=e>=1?t.substring(0,e):this.DEFAULT_NAMESPACE,s=t.substring(e+1);return new ns(r,s)}return new ns(this.DEFAULT_NAMESPACE,t)}}class as{properties;static AIR=new as(ns.create("air"));static STONE=new as(ns.create("stone"));static WATER=new as(ns.create("water"),{level:"0"});static LAVA=new as(ns.create("lava"),{level:"0"});name;constructor(t,e={}){this.properties=e,this.name="string"==typeof t?ns.parse(t):t}getName(){return this.name}getProperties(){return this.properties}getProperty(t){return this.properties[t]}isFluid(){return this.is(as.WATER)||this.is(as.LAVA)}equals(t){return!!this.name.equals(t.name)&&Object.keys(this.properties).every((e=>t.properties[e]===this.properties[e]))}is(t){return this.name.equals(t.name)}toString(){return 0===Object.keys(this.properties).length?this.name.toString():`${this.name.toString()}[${Object.entries(this.properties).map((([t,e])=>t+"="+e)).join(",")}]`}static fromNbt(t){const e=ns.parse(t.getString("Name")),r=t.getCompound("Properties").map(((t,e)=>[t,e.getAsString()]));return new as(e,r)}static fromJson(t){const e=s.readObject(t)??{},r=ns.parse(s.readString(e.Name)??as.STONE.name.toString()),i=s.readMap(e.Properties,(t=>s.readString(t)??""));return new as(r,i)}}class os{size;defaultValue;storage;palette;constructor(t,e){this.size=t,this.defaultValue=e,this.storage=Array(t).fill(0),this.palette=[e]}index(t,e,r){return(t<<8)+(e<<4)+r}get(t,e,r){const s=this.storage[this.index(t,e,r)];return this.palette[s]}set(t,e,r,s){let i=this.palette.findIndex((t=>t.equals(s)));-1===i&&(i=this.palette.length,this.palette.push(s)),this.storage[this.index(t,e,r)]=i}}class hs{minY;static WIDTH=16;static SIZE=hs.WIDTH*hs.WIDTH*hs.WIDTH;states;constructor(t){this.minY=t,this.states=new os(hs.SIZE,as.AIR)}get minBlockY(){return this.minY<<4}getBlockState(t,e,r){return this.states.get(t,e,r)}setBlockState(t,e,r,s){this.states.set(t,e,r,s)}}class ls{minY;height;pos;sections;constructor(t,e,r){this.minY=t,this.height=e,this.pos=r,this.sections=Array(this.sectionsCount).fill(null)}get maxY(){return this.minY+this.height}get minSection(){return this.minY>>4}get maxSection(){return 1+(this.maxY-1>>4)}get sectionsCount(){return this.maxSection-this.minSection}getSectionIndex(t){return(t>>4)-this.minSection}getBlockState(t){const[e,r,s]=t;return this.sections[this.getSectionIndex(r)]?.getBlockState(15&e,15&r,15&s)??as.AIR}setBlockState(t,e){const[r,s,i]=t,n=this.getSectionIndex(s);let a=this.sections[n];if(null===a){if(e.equals(as.AIR))return;a=this.getOrCreateSection(n)}a.setBlockState(15&r,15&s,15&i,e)}getOrCreateSection(t){return null==this.sections[t]&&(this.sections[t]=new hs(this.minSection+t)),this.sections[t]}}!function(t){function e(t,e){return BigInt(4294967295&t)|BigInt(4294967295&e)<<BigInt(32)}t.create=function(t,e){return[t,e]},t.fromBlockPos=function(t){return[t[0]>>4,t[2]>>4]},t.fromLong=function(t){return[4294967295&Number(t),Number(t>>BigInt(32))]},t.toLong=function(t){return e(t[0],t[1])},t.asLong=e,t.minBlockX=function(t){return t[0]<<4},t.minBlockZ=function(t){return t[1]<<4},t.maxBlockX=function(t){return 15+(t[0]<<4)},t.maxBlockZ=function(t){return 15+(t[1]<<4)}}(es||(es={})),function(t){function e(t,e){return{value:()=>t,key:()=>e}}function r(t,e){return{value:()=>t.getOrThrow(e),key:()=>e}}t.parser=function(t,s){return i=>"string"==typeof i?r(t,ns.parse(i)):e(s(i))},t.direct=e,t.reference=r}(rs||(rs={}));class us{key;parser;static REGISTRY=new us(ns.create("root"));storage=new Map;builtin=new Map;constructor(t,e){this.key=t,this.parser=e}register(t,e,r){return this.storage.set(t.toString(),e),r&&this.builtin.set(t.toString(),e),rs.reference(this,t)}delete(t){const e=this.storage.delete(t.toString());return this.builtin.delete(t.toString()),e}keys(){return[...this.storage.keys()].map((t=>ns.parse(t)))}has(t){return this.storage.has(t.toString())}get(t){return this.storage.get(t.toString())}getOrThrow(t){const e=this.storage.get(t.toString());if(void 0===e)throw new Error(`Missing key in ${this.key.toString()}: ${t.toString()}`);return e}parse(t){if(!this.parser)throw new Error(`No parser exists for ${this.key.toString()}`);return this.parser(t)}clear(){this.storage.clear();for(const[t,e]of this.builtin.entries())this.storage.set(t,e);return this}assign(t){if(!this.key.equals(t.key))throw new Error(`Cannot assign registry of type ${t.key.toString()} to registry of type ${this.key.toString()}`);for(const e of t.keys())this.storage.set(e.toString(),t.getOrThrow(e));return this}cloneEmpty(){return new us(this.key,this.parser)}forEach(t){for(const[e,r]of this.storage.entries())t(ns.parse(e),r,this)}map(t){return[...this.storage.entries()].map((([e,r])=>t(ns.parse(e),r,this)))}}class cs{size;palette;blocks;blocksMap=[];constructor(t,e=[],r=[]){this.size=t,this.palette=e,this.blocks=r,r.forEach((e=>{if(!this.isInside(e.pos))throw new Error(`Found block at ${e.pos} which is outside the structure bounds ${this.size}`);this.blocksMap[e.pos[0]*t[1]*t[2]+e.pos[1]*t[2]+e.pos[2]]=e}))}getSize(){return this.size}addBlock(t,e,r,s){if(!this.isInside(t))throw new Error(`Cannot add block at ${t} outside the structure bounds ${this.size}`);const i=new as(e,r);let n=this.palette.findIndex((t=>t.equals(i)));return-1===n&&(n=this.palette.length,this.palette.push(i)),this.blocks.push({pos:t,state:n,nbt:s}),this.blocksMap[t[0]*this.size[1]*this.size[2]+t[1]*this.size[2]+t[2]]={pos:t,state:n,nbt:s},this}getBlocks(){return this.blocks.map((t=>({pos:t.pos,state:this.palette[t.state],nbt:t.nbt})))}getBlock(t){if(!this.isInside(t))return null;const e=this.blocksMap[t[0]*this.size[1]*this.size[2]+t[1]*this.size[2]+t[2]];if(!e)return null;return{pos:e.pos,state:this.palette[e.state],nbt:e.nbt}}isInside(t){return t[0]>=0&&t[0]<this.size[0]&&t[1]>=0&&t[1]<this.size[1]&&t[2]>=0&&t[2]<this.size[2]}static fromNbt(t){const e=ts.fromNbt(t.getList("size")),r=t.getList("palette",Br.Compound).map((t=>as.fromNbt(t))),s=t.getList("blocks",Br.Compound).map((t=>{const e=ts.fromNbt(t.getList("pos")),r=t.getNumber("state"),s=t.getCompound("nbt");return{pos:e,state:r,nbt:s.size>0?s:void 0}}));return new cs(e,r,s)}}function ds(t){return t*t}function fs(t,e,r){return Math.max(e,Math.min(r,t))}function ms(t,e,r){return e+t*(r-e)}function ps(t,e,r,s,i,n){return ms(e,ms(t,r,s),ms(t,i,n))}function gs(t,e,r){return 0===t?e():1===t?r():e()+t*(r()-e())}function _s(t,e,r,s,i,n){return gs(e,(()=>gs(t,r,s)),(()=>gs(t,i,n)))}function ws(t,e,r){return r<0?t:r>1?e:ms(r,t,e)}function bs(t,e,r){return(t-e)/(r-e)}function ys(t){return t*t*t*(t*(6*t-15)+10)}function vs(t,e,r,s,i){return ms(bs(t,e,r),s,i)}function xs(t,e,r){let s=BigInt(3129871*t)^BigInt(r)*BigInt(116129781)^BigInt(e);return s=s*s*BigInt(42317861)+s*BigInt(11),s>>BigInt(16)}function ks(t,e,r,s,i,n,a,o){return BigInt(t)<<BigInt(56)|BigInt(e)<<BigInt(48)|BigInt(r)<<BigInt(40)|BigInt(s)<<BigInt(32)|BigInt(i)<<BigInt(24)|BigInt(n)<<BigInt(16)|BigInt(a)<<BigInt(8)|BigInt(o)}function Ss(t){return 0==(t&t-1)}!function(t){t.is=function(t){return"object"==typeof t&&null!==t&&"minValue"in t&&"maxValue"in t}}(ss||(ss={})),function(t){t.fromJson=function t(i,n){if("number"==typeof i)return new e(i);const a=s.readObject(i)??{},o=new r(n(a.coordinate)),h=s.readArray(a.points,(t=>s.readObject(t)??{}))??[];if(0===h.length)return new e(0);for(const e of h){const r=s.readNumber(e.location)??0,i=t(e.value,n),a=s.readNumber(e.derivative)??0;o.addPoint(r,i,a)}return o};class e{value;constructor(t){this.value=t}compute(){return this.value}min(){return this.value}max(){return this.value}mapAll(){return this}calculateMinMax(){}}t.Constant=e;class r{coordinate;locations;values;derivatives;calculatedMin=Number.NEGATIVE_INFINITY;calculatedMax=Number.POSITIVE_INFINITY;constructor(t,e=[],r=[],s=[]){this.coordinate=t,this.locations=e,this.values=r,this.derivatives=s}compute(t){const e=this.coordinate.compute(t),r=function(t,e,r){let s=e-t;for(;s>0;){const e=Math.floor(s/2),i=t+e;r(i)?s=e:(t=i+1,s-=e+1)}return t}(0,this.locations.length,(t=>e<this.locations[t]))-1,s=this.locations.length-1;if(r<0)return this.values[0].compute(t)+this.derivatives[0]*(e-this.locations[0]);if(r===s)return this.values[s].compute(t)+this.derivatives[s]*(e-this.locations[s]);const i=this.locations[r],n=this.locations[r+1],a=this.derivatives[r],o=this.derivatives[r+1],h=(e-i)/(n-i),l=this.values[r].compute(t),u=this.values[r+1].compute(t),c=a*(n-i)-(u-l),d=-o*(n-i)+(u-l);return ms(h,l,u)+h*(1-h)*ms(h,c,d)}min(){return this.calculatedMin}max(){return this.calculatedMax}mapAll(t){return new r(t(this.coordinate),this.locations,this.values.map((e=>e.mapAll(t))),this.derivatives)}addPoint(e,r,s=0){return this.locations.push(e),this.values.push("number"==typeof r?new t.Constant(r):r),this.derivatives.push(s),this}calculateMinMax(){if(!ss.is(this.coordinate))return;const t=this.locations.length-1;var e=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const i=this.coordinate.minValue(),n=this.coordinate.maxValue();for(const r of this.values)r.calculateMinMax();if(i<this.locations[0]){const t=r.linearExtend(i,this.locations,this.values[0].min(),this.derivatives,0),n=r.linearExtend(i,this.locations,this.values[0].max(),this.derivatives,0);e=Math.min(e,Math.min(t,n)),s=Math.max(s,Math.max(t,n))}if(n>this.locations[t]){const i=r.linearExtend(n,this.locations,this.values[t].min(),this.derivatives,t),a=r.linearExtend(n,this.locations,this.values[t].max(),this.derivatives,t);e=Math.min(e,Math.min(i,a)),s=Math.max(s,Math.max(i,a))}for(const r of this.values)e=Math.min(e,r.min()),s=Math.max(s,r.max());for(var a=0;a<t;++a){const t=this.locations[a],r=this.locations[a+1]-t,i=this.values[a],n=this.values[a+1],o=i.min(),h=i.max(),l=n.min(),u=n.max(),c=this.derivatives[a],d=this.derivatives[a+1];if(0!==c||0!==d){const t=c*r,i=d*r,n=Math.min(o,l),a=Math.max(h,u),f=t-u+o,m=t-l+h,p=-i+l-h,g=-i+u-o,_=Math.min(f,p),w=Math.max(m,g);e=Math.min(e,n+.25*_),s=Math.max(s,a+.25*w)}}this.calculatedMin=e,this.calculatedMax=s}static linearExtend(t,e,r,s,i){const n=s[i];return 0==n?r:r+n*(t-e[i])}}t.MultiPoint=r}(is||(is={}));var As,Is=r(2568);class Es{static MODULUS_BITS=48;static MODULUS_MASK=BigInt("281474976710655");static MULTIPLIER=BigInt("25214903917");static INCREMENT=BigInt("11");static FLOAT_MULTIPLIER=1/Math.pow(2,24);static DOUBLE_MULTIPLIER=1/Math.pow(2,30);seed=BigInt(0);constructor(t){this.setSeed(t)}fork(){return new Es(this.nextLong())}forkPositional(){return new Bs(this.nextLong())}setSeed(t){this.seed=t^Es.MULTIPLIER&Es.MODULUS_MASK}advance(){this.seed=this.seed*Es.MULTIPLIER+Es.INCREMENT&Es.MODULUS_MASK}consume(t){for(let e=0;e<t;e+=1)this.advance()}next(t){this.advance();const e=Number(this.seed>>BigInt(Es.MODULUS_BITS-t));return e>2147483647?e-4294967296:e}nextInt(t){if(void 0===t)return this.next(32);if(0==(t&t-1))return Number(BigInt(t)*BigInt(this.next(31))>>BigInt(31));let e,r;for(;(e=this.next(31))-(r=e%t)+(t-1)<0;);return r}nextLong(){return(BigInt(this.next(32))<<BigInt(32))+BigInt(this.next(32))}nextFloat(){return this.next(24)*Es.FLOAT_MULTIPLIER}nextDouble(){const t=this.next(30);return this.advance(),t*Es.DOUBLE_MULTIPLIER}}class Bs{seed;constructor(t){this.seed=t}at(t,e,r){const s=xs(t,e,r);return new Es(s^this.seed)}fromHashOf(t){const e=Is(t,{asBytes:!0}),r=ks(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]);return new Es(r^this.seed)}seedKey(){return[this.seed,BigInt(0)]}}class Ns{static SILVER_RATIO_64=BigInt("7640891576956012809");static GOLDEN_RATIO_64=BigInt("-7046029254386353131");static FLOAT_MULTIPLIER=1/Math.pow(2,24);static DOUBLE_MULTIPLIER=11102230246251565e-32;static BIGINT_1=BigInt(1);static BIGINT_17=BigInt(17);static BIGINT_21=BigInt(21);static BIGINT_27=BigInt(27);static BIGINT_28=BigInt(28);static BIGINT_30=BigInt(30);static BIGINT_31=BigInt(31);static BIGINT_32=BigInt(32);static BIGINT_49=BigInt(49);static BIGINT_64=BigInt(64);static STAFFORD_1=BigInt("-4658895280553007687");static STAFFORD_2=BigInt("-7723592293110705685");static MAX_ULONG=BigInt("0xFFFFFFFFFFFFFFFF");static POW2_60=BigInt("0x10000000000000000");static POW2_63=BigInt("0x8000000000000000");static MAX_UINT=BigInt(4294967295);seed=[BigInt(0),BigInt(0)];constructor(t){this.seed=t}static create(t){return new Ns(Ns.upgradeSeedTo128bit(t))}static mixStafford13(t){return((t=((t=(t^t>>Ns.BIGINT_30)*Ns.STAFFORD_1&Ns.MAX_ULONG)^t>>Ns.BIGINT_27)*Ns.STAFFORD_2&Ns.MAX_ULONG)^t>>Ns.BIGINT_31)&Ns.MAX_ULONG}static upgradeSeedTo128bit(t){t<0&&(t+=Ns.POW2_60);const e=t^Ns.SILVER_RATIO_64,r=e+Ns.GOLDEN_RATIO_64&Ns.MAX_ULONG;return[Ns.mixStafford13(e),Ns.mixStafford13(r)]}static rotateLeft(t,e){return t<<e&Ns.MAX_ULONG|t>>Ns.BIGINT_64-e}setSeed(t){this.seed=Ns.upgradeSeedTo128bit(t)}fork(){return new Ns([this.next(),this.next()])}forkPositional(){return new Rs(this.next(),this.next())}next(){const t=this.seed[0];let e=this.seed[1];const r=Ns.rotateLeft(t+e&Ns.MAX_ULONG,Ns.BIGINT_17)+t&Ns.MAX_ULONG;return e^=t,this.seed=[Ns.rotateLeft(t,Ns.BIGINT_49)^e^e<<Ns.BIGINT_21&Ns.MAX_ULONG,Ns.rotateLeft(e,Ns.BIGINT_28)],r}nextLong(){let t=this.next();return t>Ns.POW2_63&&(t-=Ns.POW2_60),t}consume(t){let e=this.seed[0],r=this.seed[1];for(let s=0;s<t;s+=1)r^=e,e=Ns.rotateLeft(e,Ns.BIGINT_49)^r^r<<Ns.BIGINT_21,r=Ns.rotateLeft(r,Ns.BIGINT_28);this.seed=[e,r]}nextBits(t){return this.next()>>BigInt(64-t)}nextInt(t){let e=this.next()&Ns.MAX_UINT;if(t){const r=BigInt(t);let s=e*r,i=s&Ns.MAX_UINT;if(i<r){const t=((~r&Ns.MAX_UINT)+Ns.BIGINT_1)%r;for(;i<t;)e=this.next()&Ns.MAX_UINT,s=e*r,i=s&Ns.MAX_UINT}const n=s>>Ns.BIGINT_32;return Number(n)}{let t=Number(e);return t>=2147483648&&(t-=4294967296),t}}nextFloat(){return Number(this.nextBits(24))*Ns.FLOAT_MULTIPLIER}nextDouble(){return Number(this.nextBits(53))*Ns.DOUBLE_MULTIPLIER}parityConfigString(){return"seedLo: "+this.seed[0]+", seedHi: "+this.seed[1]}}class Rs{seedLo;seedHi;constructor(t,e){this.seedLo=t,this.seedHi=e}at(t,e,r){const s=xs(t,e,r)^this.seedLo;return new Ns([s,this.seedHi])}fromHashOf(t){const e=Is(t,{asBytes:!0}),r=ks(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]),s=ks(e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]);return new Ns([r^this.seedLo,s^this.seedHi])}seedKey(){return[this.seedLo,this.seedHi]}}class Ts{static GRADIENT=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1],[1,1,0],[0,-1,1],[-1,1,0],[0,-1,-1]];static F2=.5*(Math.sqrt(3)-1);static G2=(3-Math.sqrt(3))/6;p;xo;yo;zo;constructor(t){this.xo=256*t.nextDouble(),this.yo=256*t.nextDouble(),this.zo=256*t.nextDouble(),this.p=Array(256);for(let e=0;e<256;e+=1)this.p[e]=e;for(let e=0;e<256;e+=1){const r=t.nextInt(256-e),s=this.p[e];this.p[e]=this.p[e+r],this.p[e+r]=s}}sample2D(t,e){let r,s,i;const n=(t+e)*Ts.F2,a=Math.floor(t+n),o=t-(a-(r=(a+(s=Math.floor(e+n)))*Ts.G2));let h,l;o>(i=e-(s-r))?(h=1,l=0):(h=0,l=1);const u=o-h+Ts.G2,c=i-l+Ts.G2,d=o-1+2*Ts.G2,f=i-1+2*Ts.G2,m=255&a,p=255&s,g=this.P(m+this.P(p))%12,_=this.P(m+h+this.P(p+l))%12,w=this.P(m+1+this.P(p+1))%12;return 70*(this.getCornerNoise3D(g,o,i,0,.5)+this.getCornerNoise3D(_,u,c,0,.5)+this.getCornerNoise3D(w,d,f,0,.5))}sample(t,e,r){const s=.3333333333333333*(t+e+r),i=Math.floor(t+s),n=Math.floor(e+s),a=Math.floor(r+s),o=.16666666666666666*(i+n+a),h=t-(i-o),l=e-(n-o),u=r-(a-o);let c,d,f,m,p,g;h>=l?l>=u?(c=1,d=0,f=0,m=1,p=1,g=0):h>=u?(c=1,d=0,f=0,m=1,p=0,g=1):(c=0,d=0,f=1,m=1,p=0,g=1):l<u?(c=0,d=0,f=1,m=0,p=1,g=1):h<u?(c=0,d=1,f=0,m=0,p=1,g=1):(c=0,d=1,f=0,m=1,p=1,g=0);const _=h-c+.16666666666666666,w=l-d+.16666666666666666,b=u-f+.16666666666666666,y=h-m+.3333333333333333,v=l-p+.3333333333333333,x=u-g+.3333333333333333,k=h-.5,S=l-.5,A=u-.5,I=255&i,E=255&n,B=255&a,N=this.P(I+this.P(E+this.P(B)))%12,R=this.P(I+c+this.P(E+d+this.P(B+f)))%12,T=this.P(I+m+this.P(E+p+this.P(B+g)))%12,M=this.P(I+1+this.P(E+1+this.P(B+1)))%12;return 32*(this.getCornerNoise3D(N,h,l,u,.6)+this.getCornerNoise3D(R,_,w,b,.6)+this.getCornerNoise3D(T,y,v,x,.6)+this.getCornerNoise3D(M,k,S,A,.6))}P(t){return this.p[255&t]}getCornerNoise3D(t,e,r,s,i){let n,a=i-e*e-r*r-s*s;return a<0?n=0:(a*=a,n=a*a*Ts.gradDot(t,e,r,s)),n}static gradDot(t,e,r,s){const i=Ts.GRADIENT[15&t];return i[0]*e+i[1]*r+i[2]*s}}class Ms{p;xo;yo;zo;constructor(t){this.xo=256*t.nextDouble(),this.yo=256*t.nextDouble(),this.zo=256*t.nextDouble(),this.p=Array(256);for(let e=0;e<256;e+=1)this.p[e]=e>127?e-256:e;for(let e=0;e<256;e+=1){const r=t.nextInt(256-e),s=this.p[e];this.p[e]=this.p[e+r],this.p[e+r]=s}}sample(t,e,r,s=0,i=0){const n=t+this.xo,a=e+this.yo,o=r+this.zo,h=Math.floor(n),l=Math.floor(a),u=Math.floor(o),c=n-h,d=a-l,f=o-u;let m=0;if(0!==s){const t=i>=0&&i<d?i:d;m=Math.floor(t/s+1e-7)*s}return this.sampleAndLerp(h,l,u,c,d-m,f,d)}sampleAndLerp(t,e,r,s,i,n,a){const o=this.P(t),h=this.P(t+1),l=this.P(o+e),u=this.P(o+e+1),c=this.P(h+e),d=this.P(h+e+1),f=Ts.gradDot(this.P(l+r),s,i,n),m=Ts.gradDot(this.P(c+r),s-1,i,n),p=Ts.gradDot(this.P(u+r),s,i-1,n),g=Ts.gradDot(this.P(d+r),s-1,i-1,n),_=Ts.gradDot(this.P(l+r+1),s,i,n-1),w=Ts.gradDot(this.P(c+r+1),s-1,i,n-1),b=Ts.gradDot(this.P(u+r+1),s,i-1,n-1),y=Ts.gradDot(this.P(d+r+1),s-1,i-1,n-1);return function(t,e,r,s,i,n,a,o,h,l,u){return ms(r,ps(t,e,s,i,n,a),ps(t,e,o,h,l,u))}(ys(s),ys(a),ys(n),f,m,p,g,_,w,b,y)}P(t){return 255&this.p[255&t]}}class Cs{noiseLevels;amplitudes;lowestFreqInputFactor;lowestFreqValueFactor;maxValue;constructor(t,e,r){if(t instanceof Ns){const s=t.forkPositional();this.noiseLevels=Array(r.length);for(let t=0;t<r.length;t++)if(0!==r[t]){const r=e+t;this.noiseLevels[t]=new Ms(s.fromHashOf("octave_"+r))}}else{if(1-e<r.length)throw new Error("Positive octaves are not allowed when using LegacyRandom");this.noiseLevels=Array(r.length);for(let s=-e;s>=0;s-=1)s<r.length&&0!==r[s]?this.noiseLevels[s]=new Ms(t):t.consume(262)}this.amplitudes=r,this.lowestFreqInputFactor=Math.pow(2,e),this.lowestFreqValueFactor=Math.pow(2,r.length-1)/(Math.pow(2,r.length)-1),this.maxValue=this.edgeValue(2)}sample(t,e,r,s=0,i=0,n=!1){let a=0,o=this.lowestFreqInputFactor,h=this.lowestFreqValueFactor;for(let l=0;l<this.noiseLevels.length;l+=1){const u=this.noiseLevels[l];u&&(a+=this.amplitudes[l]*h*u.sample(Cs.wrap(t*o),n?-u.yo:Cs.wrap(e*o),Cs.wrap(r*o),s*o,i*o)),o*=2,h/=2}return a}getOctaveNoise(t){return this.noiseLevels[this.noiseLevels.length-1-t]}edgeValue(t){let e=0,r=this.lowestFreqValueFactor;for(let s=0;s<this.noiseLevels.length;s+=1)this.noiseLevels[s]&&(e+=this.amplitudes[s]*t*r),r/=2;return e}static wrap(t){return t-33554432*Math.floor(t/33554432+.5)}}class Os{xzScale;yScale;xzFactor;yFactor;smearScaleMultiplier;minLimitNoise;maxLimitNoise;mainNoise;xzMultiplier;yMultiplier;maxValue;constructor(t,e,r,s,i,n){this.xzScale=e,this.yScale=r,this.xzFactor=s,this.yFactor=i,this.smearScaleMultiplier=n,this.minLimitNoise=new Cs(t,-15,[1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0]),this.maxLimitNoise=new Cs(t,-15,[1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0]),this.mainNoise=new Cs(t,-7,[1,1,1,1,1,0,0,0]),this.xzMultiplier=684.412*e,this.yMultiplier=684.412*r,this.maxValue=this.minLimitNoise.edgeValue(this.yScale+2)}sample(t,e,r){const s=t*this.xzMultiplier,i=e*this.yMultiplier,n=r*this.xzMultiplier,a=s/this.xzFactor,o=i/this.yFactor,h=n/this.xzFactor,l=this.yMultiplier*this.smearScaleMultiplier,u=l/this.yFactor;let c,d=0,f=1;for(let g=0;g<8;g+=1){if(c=this.mainNoise.getOctaveNoise(g),c){const t=Cs.wrap(a*f),e=Cs.wrap(o*f),r=Cs.wrap(h*f);d+=c.sample(t,e,r,u*f,o*f)/f}f/=2}d=(d/10+1)/2,f=1;let m=0,p=0;for(let g=0;g<16;g+=1){const t=Cs.wrap(s*f),e=Cs.wrap(i*f),r=Cs.wrap(n*f),a=l*f;d<1&&(c=this.minLimitNoise.getOctaveNoise(g))&&(m+=c.sample(t,e,r,a,i*f)/f),d>0&&(c=this.maxLimitNoise.getOctaveNoise(g))&&(p+=c.sample(t,e,r,a,i*f)/f),f/=2}return ws(m/512,p/512,d)/128}}class zs{static INPUT_FACTOR=1.0181268882175227;valueFactor;first;second;maxValue;constructor(t,{firstOctave:e,amplitudes:r}){this.first=new Cs(t,e,r),this.second=new Cs(t,e,r);let s=1/0,i=-1/0;for(let a=0;a<r.length;a+=1)0!==r[a]&&(s=Math.min(s,a),i=Math.max(i,a));const n=.1*(1+1/(i-s+1));this.valueFactor=1/6/n,this.maxValue=(this.first.maxValue+this.second.maxValue)*this.valueFactor}sample(t,e,r){const s=t*zs.INPUT_FACTOR,i=e*zs.INPUT_FACTOR,n=r*zs.INPUT_FACTOR;return(this.first.sample(t,e,r)+this.second.sample(s,i,n))*this.valueFactor}}!function(t){t.create=function(t,e){return{firstOctave:t,amplitudes:e}},t.fromJson=function(t){const e=s.readObject(t)??{};return{firstOctave:s.readInt(e.firstOctave)??0,amplitudes:s.readArray(e.amplitudes,(t=>s.readNumber(t)??0))??[]}}}(As||(As={}));class Fs{noiseLevels;highestFreqInputFactor;highestFreqValueFactor;constructor(t,e){const r=e[e.length-1],s=-e[0]+r+1,i=new Set(e),n=new Ts(t);this.noiseLevels=Array(s),r>=0&&r<s&&i.has(0)&&(this.noiseLevels[r]=n);for(let a=r+1;a<s;a+=1)a>=0&&i.has(r-a)?this.noiseLevels[a]=new Ts(t):t.consume(262);if(r>0)throw new Error("Positive octaves are not allowed");this.highestFreqInputFactor=Math.pow(2,r),this.highestFreqValueFactor=1/(Math.pow(2,s)-1)}sample(t,e,r){let s=0,i=this.highestFreqInputFactor,n=this.highestFreqValueFactor;for(let a=0;a<this.noiseLevels.length;a+=1){const o=this.noiseLevels[a];o&&(s+=n*o.sample2D(t*i+(r?o.xo:0),e*i+(r?o.yo:0))),i/=2,n*=2}return s}}const Ls=t=>[(t>>16&255)/256,(t>>8&255)/256,(255&t)/256],Ds=[124/256,189/256,107/256],Ps=Ls(6396257),Us=Ls(8431445),Vs=Ls(4764952),Zs=Ls(4159204),Js=Ls(8431445),Ys=Ls(2129968),Hs=t=>[t/8,1-t/32,64*t],js={large_fern:()=>Ds,tall_grass:()=>Ds,grass_block:()=>Ds,fern:()=>Ds,grass:()=>Ds,potted_fern:()=>Ds,spruce_leaves:()=>Ps,birch_leaves:()=>Us,oak_leaves:()=>Vs,jungle_leaves:()=>Vs,acacia_leaves:()=>Vs,dark_oak_leaves:()=>Vs,vine:()=>Vs,water:()=>Zs,bubble_column:()=>Zs,cauldron:()=>Zs,redstone_wire:t=>(t=>{const e=t/15;return[.6*e+(e>0?.4:.3),fs(e*e*.7-.5,0,1),fs(e*e*.6-.7,0,1)]})(parseInt(t.power??"0")),sugar_cane:()=>Ds,attached_melon_stem:()=>Js,attached_pumpkin_stem:()=>Js,melon_stem:t=>Hs(parseInt(t.age??"0")),pumpkin_stem:t=>Hs(parseInt(t.age??"0")),lily_pad:()=>Ys};var Gs,Ws=r(5975),qs=r(9685);function Xs(){var t=new qs.WT(3);return qs.WT!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function $s(t,e,r){var s=new qs.WT(3);return s[0]=t,s[1]=e,s[2]=r,s}function Ks(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function Qs(t,e){var r=e[0],s=e[1],i=e[2],n=r*r+s*s+i*i;return n>0&&(n=1/Math.sqrt(n)),t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function ti(t,e,r){var s=e[0],i=e[1],n=e[2],a=r[0],o=r[1],h=r[2];return t[0]=i*h-n*o,t[1]=n*a-s*h,t[2]=s*o-i*a,t}function ei(t,e,r){var s=e[0],i=e[1],n=e[2],a=r[3]*s+r[7]*i+r[11]*n+r[15];return a=a||1,t[0]=(r[0]*s+r[4]*i+r[8]*n+r[12])/a,t[1]=(r[1]*s+r[5]*i+r[9]*n+r[13])/a,t[2]=(r[2]*s+r[6]*i+r[10]*n+r[14])/a,t}function ri(t,e){var r=t[0],s=t[1],i=t[2],n=e[0],a=e[1],o=e[2];return Math.abs(r-n)<=qs.Ib*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(s-a)<=qs.Ib*Math.max(1,Math.abs(s),Math.abs(a))&&Math.abs(i-o)<=qs.Ib*Math.max(1,Math.abs(i),Math.abs(o))}!function(t){t.rotate=function(t,e,r){let{up:s,down:i,north:n,east:a,south:o,west:h}=t;switch(r){case 90:[n,a,o,h]=[a,o,h,n];break;case 180:[n,a,o,h]=[o,h,n,a];break;case 270:[n,a,o,h]=[h,n,a,o]}switch(e){case 90:[s,n,i,o]=[n,i,o,s];break;case 180:[s,n,i,o]=[i,o,s,n];break;case 270:[s,n,i,o]=[o,s,n,i]}return{up:s,down:i,north:n,east:a,south:o,west:h}},t.none=function(){return Object.create(null)}}(Gs||(Gs={}));var si;si=Xs();function ii(...t){let e=0;for(const i of t)e+=i.length;const r=new Float32Array(e);let s=0;for(const i of t)r.set(i,s),s+=i.length;return r}function ni(t,e){const r=Xs();for(let s=0;s<t.length;s+=3)r[0]=t[s],r[1]=t[s+1],r[2]=t[s+2],ei(r,r,e),t[s]=r[0],t[s+1]=r[1],t[s+2]=r[2]}class ai{id;variants;multipart;constructor(t,e,r){this.id=t,this.variants=e,this.multipart=r,this.variants=e}getModelVariants(t){if(this.variants){const e=Object.keys(this.variants).filter((e=>this.matchesVariant(e,t)));if(0===e.length)return[];const r=this.variants[e[0]];return[Array.isArray(r)?r[0]:r]}if(this.multipart){return this.multipart.filter((e=>!e.when||this.matchesCase(e.when,t))).map((t=>Array.isArray(t.apply)?t.apply[0]:t.apply))}return[]}getBuffers(t,e,r,s,i,n){const a=this.getModelVariants(e),o=[],h=[],l=[],u=[];for(const f of a){const a=Gs.rotate(n,f.x??0,f.y??0),c=s.getBlockModel(ns.parse(f.model));if(!c)throw new Error(`Cannot find block model ${f.model}`);const d=js[t.path]?.(e),m=c.getBuffers(r,i,a,d);if(f.x||f.y){const t=Ws.Ue();Ws.yR(t),Ws.Iu(t,t,[8,8,8]),Ws.uD(t,t,-qs.c$(f.y??0)),Ws.lM(t,t,-qs.c$(f.x??0)),Ws.Iu(t,t,[-8,-8,-8]),ni(m.position,t)}o.push(m.position),h.push(...m.texCoord),l.push(...m.tintColor),u.push(...m.index),i+=m.texCoord.length/2}const c=Ws.Ue();Ws.yR(c),Ws.bA(c,c,[.0625,.0625,.0625]);const d=ii(...o);return ni(d,c),{position:d,texCoord:h,tintColor:l,index:u}}matchesVariant(t,e){return t.split(",").every((t=>{const[r,s]=t.split("=");return e[r]===s}))}matchesCase(t,e){if(Array.isArray(t.OR))return t.OR.some((t=>this.matchesCase(t,e)));const r=t;return Object.keys(r).every((t=>r[t].split("|").includes(e[t])))}static fromJson(t,e){return new ai(ns.parse(t),e.variants,e.multipart)}}const oi={0:[0,3,2,3,2,1,0,1],90:[2,3,2,1,0,1,0,3],180:[2,1,0,1,0,3,2,3],270:[0,1,0,3,2,3,2,1]},hi={x:[1,0,0],y:[0,1,0],z:[0,0,1]},li=1.41421356237,ui={x:[1,li,li],y:[li,1,li],z:[li,li,1]};class ci{id;parent;textures;elements;display;guiLight;static BUILTIN_GENERATED=ns.create("builtin/generated");constructor(t,e,r,s,i,n){this.id=t,this.parent=e,this.textures=r,this.elements=s,this.display=i,this.guiLight=n}getDisplayBuffers(t,e,r,s){const i=this.getBuffers(e,r,Gs.none(),s),n=this.display?.[t],a=Ws.Ue();Ws.yR(a),Ws.Iu(a,a,[8,8,8]),n?.translation&&Ws.Iu(a,a,n.translation),n?.rotation&&(Ws.lM(a,a,n.rotation[0]*Math.PI/180),Ws.uD(a,a,n.rotation[1]*Math.PI/180),Ws.jI(a,a,-n.rotation[2]*Math.PI/180)),n?.scale&&Ws.bA(a,a,n.scale),Ws.Iu(a,a,[-8,-8,-8]),ni(i.position,a);const o=[];for(let h=0;h<i.position.length;h+=12){const t=$s(i.position[h],i.position[h+1],i.position[h+2]),e=$s(i.position[h+3],i.position[h+4],i.position[h+5]),r=$s(i.position[h+6],i.position[h+7],i.position[h+8]);Ks(e,e,t),Ks(r,r,t),ti(e,e,r),Qs(e,e),o.push(...e,...e,...e,...e)}return{...i,normal:o}}getBuffers(t,e,r,s){const i=[],n=[],a=[],o=[];for(const h of this.elements??[]){const l=this.getElementBuffers(h,e,t,r,s);i.push(l.position),n.push(...l.texCoord),a.push(...l.tintColor),o.push(...l.index),e+=l.texCoord.length/2}return{position:ii(...i),texCoord:n,tintColor:a,index:o}}getElementBuffers(t,e,r,s,i){const n=t.from[0],a=t.from[1],o=t.from[2],h=t.to[0],l=t.to[1],u=t.to[2],c=[],d=[],f=[],m=[],p=(t,s,n)=>{const[a,o,h,l]=r.getTextureUV(this.getTexture(t.texture)),u=(h-a)/16,p=(l-o)/16,g=u/16,_=p/16;s[0]=(t.uv?.[0]??s[0])*u+g,s[1]=(t.uv?.[1]??s[1])*p+_,s[2]=(t.uv?.[2]??s[2])*u-g,s[3]=(t.uv?.[3]??s[3])*p-_;const w=oi[t.rotation??0];d.push(a+s[w[0]],o+s[w[1]],a+s[w[2]],o+s[w[3]],a+s[w[4]],o+s[w[5]],a+s[w[6]],o+s[w[7]]);const b=(t.tintindex??-1)>=0?i??[1,1,1]:[1,1,1];f.push(...b,...b,...b,...b),c.push(...n),m.push(e,e+1,e+2,e,e+2,e+3),e+=4};!t.faces?.up?.texture||t.faces.up.cullface&&s[t.faces.up.cullface]||p(t.faces.up,[n,16-u,h,16-o],[n,l,u,h,l,u,h,l,o,n,l,o]),!t.faces?.down?.texture||t.faces.down.cullface&&s[t.faces.down.cullface]||p(t.faces.down,[16-u,16-h,16-o,16-n],[n,a,o,h,a,o,h,a,u,n,a,u]),!t.faces?.south?.texture||t.faces.south.cullface&&s[t.faces.south.cullface]||p(t.faces.south,[n,16-l,h,16-a],[n,a,u,h,a,u,h,l,u,n,l,u]),!t.faces?.north?.texture||t.faces.north.cullface&&s[t.faces.north.cullface]||p(t.faces.north,[16-h,16-l,16-n,16-a],[h,a,o,n,a,o,n,l,o,h,l,o]),!t.faces?.east?.texture||t.faces.east.cullface&&s[t.faces.east.cullface]||p(t.faces.east,[16-u,16-l,16-o,16-a],[h,a,u,h,a,o,h,l,o,h,l,u]),!t.faces?.west?.texture||t.faces.west.cullface&&s[t.faces.west.cullface]||p(t.faces.west,[o,16-l,u,16-a],[n,a,o,n,a,u,n,l,u,n,l,o]);const g=Ws.Ue();if(Ws.yR(g),t.rotation){const e=$s(...t.rotation.origin);Ws.Iu(g,g,e),Ws.U1(g,g,qs.c$(t.rotation.angle),hi[t.rotation.axis]),t.rotation.rescale&&Ws.bA(g,g,ui[t.rotation.axis]),w=e,(_=e)[0]=-w[0],_[1]=-w[1],_[2]=-w[2],Ws.Iu(g,g,e)}var _,w;const b=new Float32Array(c);return ni(b,g),{position:b,texCoord:d,tintColor:f,index:m}}getTexture(t){for(;t.startsWith("#");)t=this.textures?.[t.slice(1)]??"";return ns.parse(t)}flatten(t){if(!this.parent)return;const e=this.getParent(t);if(!e)return console.warn(`parent ${this.parent} does not exist!`),void(this.parent=void 0);e.flatten(t),this.elements||(this.elements=e.elements),this.textures||(this.textures={}),Object.keys(e.textures??{}).forEach((t=>{this.textures[t]||(this.textures[t]=e.textures[t])})),this.display||(this.display={}),Object.keys(e.display??{}).forEach((t=>{const r=t;this.display[r]?Object.keys(e.display[r]??{}).forEach((t=>{const s=t;this.display[r][s]||(this.display[r][s]=e.display[r][s])})):this.display[r]=e.display[r]})),this.guiLight||(this.guiLight=e.guiLight),this.parent=void 0}getParent(t){return this.parent?this.parent.equals(ci.BUILTIN_GENERATED)?new ci(ci.BUILTIN_GENERATED,void 0,void 0,[{from:[0,0,0],to:[16,16,0],faces:{south:{texture:"#layer0",tintindex:0}}}]):t.getBlockModel(this.parent):null}static fromJson(t,e){const r=void 0===e.parent?void 0:ns.parse(e.parent);return new ci(ns.parse(t),r,e.textures,e.elements,e.display)}}class di{gl;program;constructor(t,e,r){this.gl=t,this.program=this.initShaderProgram(e,r)}getProgram(){return this.program}initShaderProgram(t,e){const r=this.loadShader(this.gl.VERTEX_SHADER,t),s=this.loadShader(this.gl.FRAGMENT_SHADER,e),i=this.gl.createProgram();if(this.gl.attachShader(i,r),this.gl.attachShader(i,s),this.gl.linkProgram(i),!this.gl.getProgramParameter(i,this.gl.LINK_STATUS))throw new Error(`Unable to link shader program: ${this.gl.getProgramInfoLog(i)}`);return i}loadShader(t,e){const r=this.gl.createShader(t);if(this.gl.shaderSource(r,e),this.gl.compileShader(r),!this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS)){const e=new Error(`Compiling ${t===this.gl.VERTEX_SHADER?"vertex":"fragment"} shader: ${this.gl.getShaderInfoLog(r)}`);throw this.gl.deleteShader(r),e}return r}}class fi{gl;shaderProgram;projMatrix;activeShader;constructor(t){this.gl=t,this.shaderProgram=new di(t,"\n  attribute vec4 vertPos;\n  attribute vec2 texCoord;\n  attribute vec3 tintColor;\n  attribute vec3 normal;\n\n  uniform mat4 mView;\n  uniform mat4 mProj;\n\n  varying highp vec2 vTexCoord;\n  varying highp vec3 vTintColor;\n  varying highp float vLighting;\n\n  void main(void) {\n    gl_Position = mProj * mView * vertPos;\n    vTexCoord = texCoord;\n    vTintColor = tintColor;\n    vLighting = normal.y * 0.2 + abs(normal.z) * 0.1 + 0.8;\n  }\n","\n  precision highp float;\n  varying highp vec2 vTexCoord;\n  varying highp vec3 vTintColor;\n  varying highp float vLighting;\n\n  uniform sampler2D sampler;\n\n  void main(void) {\n\t\tvec4 texColor = texture2D(sampler, vTexCoord);\n\t\tif(texColor.a < 0.01) discard;\n\t\tgl_FragColor = vec4(texColor.xyz * vTintColor * vLighting, texColor.a);\n  }\n").getProgram(),this.activeShader=this.shaderProgram,this.projMatrix=this.getPerspective(),this.initialize()}setViewport(t,e,r,s){this.gl.viewport(t,e,r,s),this.projMatrix=this.getPerspective()}getPerspective(){const t=70*Math.PI/180,e=this.gl.canvas.clientWidth/this.gl.canvas.clientHeight,r=Ws.Ue();return Ws.G3(r,t,e,.1,500),r}initialize(){this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.BACK)}setShader(t){this.gl.useProgram(t),this.activeShader=t}setVertexAttr(t,e,r){const s=this.gl.getAttribLocation(this.activeShader,t);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,r),this.gl.vertexAttribPointer(s,e,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(s)}setUniform(t,e){const r=this.gl.getUniformLocation(this.activeShader,t);this.gl.uniformMatrix4fv(r,!1,e)}setTexture(t){this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t)}createBuffer(t,e){const r=this.gl.createBuffer();if(null===r)throw new Error("Renderer Error: Cannot create new buffer");return this.gl.bindBuffer(t,r),this.gl.bufferData(t,e,this.gl.DYNAMIC_DRAW),r}updateBuffer(t,e,r){this.gl.bindBuffer(e,t),this.gl.bufferData(e,r,this.gl.STATIC_DRAW)}createAtlasTexture(t){const e=this.gl.createTexture();return this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),e}prepareDraw(t){this.setUniform("mView",t),this.setUniform("mProj",this.projMatrix)}drawBuffers(t){this.setVertexAttr("vertPos",3,t.position),this.setVertexAttr("texCoord",2,t.texCoord),this.setVertexAttr("tintColor",3,t.tintColor),this.setVertexAttr("normal",3,t.normal),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t.index),this.gl.drawElements(this.gl.TRIANGLES,t.length,this.gl.UNSIGNED_SHORT,0)}}function mi(t,e,r,s,i){const n=new ai(t,{"":{model:"dummy"}},void 0),a={getBlockModel:()=>i};return i.flatten(a),n.getBuffers(t,{},e,a,r,s)}function pi(t,e,r,s,i,n){const a=i.up?16:[14.2,12.5,10.5,9,7,5.3,3.7,1.9,16,16,16,16,16,16,16,16][r],o=ns.create(t);return mi(o,s,e,i,new ci(o,void 0,{still:`block/${t}_still`,flow:`block/${t}_flow`},[{from:[0,0,0],to:[16,a,16],faces:{up:{texture:"#still",tintindex:n,cullface:Rr.UP},down:{texture:"#still",tintindex:n,cullface:Rr.DOWN},north:{texture:"#flow",tintindex:n,cullface:Rr.NORTH},east:{texture:"#flow",tintindex:n,cullface:Rr.EAST},south:{texture:"#flow",tintindex:n,cullface:Rr.SOUTH},west:{texture:"#flow",tintindex:n,cullface:Rr.WEST}}}]))}const gi={"minecraft:water":(t,e,r,s)=>pi("water",t,parseInt(e.level),r,s,0),"minecraft:lava":(t,e,r,s)=>pi("lava",t,parseInt(e.level),r,s),"minecraft:chest":(t,e,r)=>function(t,e,r,s){const i=ns.create("chest");return mi(i,s,t,{},new ci(i,void 0,{0:"block/chest"},[{from:[1,0,1],to:[15,14,15],faces:{up:{texture:"#0"},down:{texture:"#0"},north:{texture:"#0"},east:{texture:"#0"},south:{texture:"#0"},west:{texture:"#0"}}}]))}(t,e.facing,e.type,r)},_i=new Set(Object.keys(gi));class wi extends fi{structure;resources;chunkSize;gridShaderProgram;colorShaderProgram;chunks=[];gridBuffers;outlineBuffers;invisibleBlockBuffers;atlasTexture;useInvisibleBlockBuffer;constructor(t,e,r,s){super(t),this.structure=e,this.resources=r,this.chunkSize=s?.chunkSize??16,s?.facesPerBuffer&&console.warn("[deepslate renderer warning]: facesPerBuffer option has been removed in favor of chunkSize"),this.useInvisibleBlockBuffer=s?.useInvisibleBlockBuffer??!0,this.gridShaderProgram=new di(t,"\n  attribute vec4 vertPos;\n  attribute vec3 vertColor;\n\n  uniform mat4 mView;\n  uniform mat4 mProj;\n\n  varying highp vec3 vColor;\n\n  void main(void) {\n    gl_Position = mProj * mView * vertPos;\n    vColor = vertColor;\n  }\n","\n  precision highp float;\n  varying highp vec3 vColor;\n\n  void main(void) {\n    gl_FragColor = vec4(vColor, 1.0);\n  }\n").getProgram(),this.colorShaderProgram=new di(t,"\n  attribute vec4 vertPos;\n  attribute vec3 blockPos;\n\n  uniform mat4 mView;\n  uniform mat4 mProj;\n\n  varying highp vec3 vColor;\n\n  void main(void) {\n    gl_Position = mProj * mView * vertPos;\n    vColor = blockPos / 256.0;\n  }\n","\n  precision highp float;\n  varying highp vec3 vColor;\n\n  void main(void) {\n    gl_FragColor = vec4(vColor, 1.0);\n  }\n").getProgram(),this.updateStructureBuffers(),this.gridBuffers=this.getGridBuffers(),this.outlineBuffers=this.getOutlineBuffers(),this.invisibleBlockBuffers=this.getInvisibleBlockBuffers(),this.atlasTexture=this.createAtlasTexture(this.resources.getTextureAtlas())}setStructure(t){this.structure=t,this.updateStructureBuffers(),this.gridBuffers=this.getGridBuffers(),this.invisibleBlockBuffers=this.getInvisibleBlockBuffers()}getChunk(t){const e=2*Math.abs(t[0])+(t[0]<0?1:0),r=2*Math.abs(t[1])+(t[1]<0?1:0),s=2*Math.abs(t[2])+(t[2]<0?1:0);return this.chunks[e]||(this.chunks[e]=[]),this.chunks[e][r]||(this.chunks[e][r]=[]),this.chunks[e][r][s]||(this.chunks[e][r][s]={positions:[],textureCoordinates:[],tintColors:[],blockPositions:[],normals:[],indices:[],indexOffset:0}),this.chunks[e][r][s]}updateStructureBuffers(t){const e=(t,e,r)=>{const s=Ws.Ue();Ws.Iu(s,s,e),ni(t.position,s),r.positions.push(t.position),r.textureCoordinates.push(...t.texCoord),r.tintColors.push(...t.tintColor);for(let i=0;i<t.position.length;i+=12){const e=$s(t.position[i],t.position[i+1],t.position[i+2]),s=$s(t.position[i+3],t.position[i+4],t.position[i+5]),n=$s(t.position[i+6],t.position[i+7],t.position[i+8]);Ks(s,s,e),Ks(n,n,e),ti(s,s,n),Qs(s,s),r.normals.push(...s,...s,...s,...s)}for(let i=0;i<t.texCoord.length/2;i+=1)r.blockPositions.push(...e);r.indices.push(...t.index),r.indexOffset+=t.texCoord.length/2},r=t=>{t.positions=[],t.textureCoordinates=[],t.tintColors=[],t.blockPositions=[],t.normals=[],t.indices=[],t.indexOffset=0},s=t=>{t.buffer?(this.updateBuffer(t.buffer.position,this.gl.ARRAY_BUFFER,ii(...t.positions)),this.updateBuffer(t.buffer.texCoord,this.gl.ARRAY_BUFFER,new Float32Array(t.textureCoordinates)),this.updateBuffer(t.buffer.tintColor,this.gl.ARRAY_BUFFER,new Float32Array(t.tintColors)),this.updateBuffer(t.buffer.normal,this.gl.ARRAY_BUFFER,new Float32Array(t.normals)),this.updateBuffer(t.buffer.blockPos,this.gl.ARRAY_BUFFER,new Float32Array(t.blockPositions)),this.updateBuffer(t.buffer.index,this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(t.indices)),t.buffer.length=t.indices.length):t.buffer={position:this.createBuffer(this.gl.ARRAY_BUFFER,ii(...t.positions)),texCoord:this.createBuffer(this.gl.ARRAY_BUFFER,new Float32Array(t.textureCoordinates)),tintColor:this.createBuffer(this.gl.ARRAY_BUFFER,new Float32Array(t.tintColors)),blockPos:this.createBuffer(this.gl.ARRAY_BUFFER,new Float32Array(t.blockPositions)),normal:this.createBuffer(this.gl.ARRAY_BUFFER,new Float32Array(t.normals)),index:this.createBuffer(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(t.indices)),length:t.indices.length}};let i;t?t.forEach((t=>{const e=this.getChunk(t);r(e)})):this.chunks.forEach((t=>t.forEach((t=>t.forEach((t=>{r(t)}))))));for(const a of this.structure.getBlocks()){const r=a.state.getName(),s=a.state.getProperties(),o=this.resources.getDefaultBlockProperties(r)??{};Object.entries(o).forEach((([t,e])=>{s[t]||(s[t]=e)}));const h=[Math.floor(a.pos[0]/this.chunkSize),Math.floor(a.pos[1]/this.chunkSize),Math.floor(a.pos[2]/this.chunkSize)];if(t&&!t.some((t=>ri(t,h))))continue;const l=this.getChunk(h);try{const t=this.resources.getBlockDefinition(r),n={up:this.needsCull(a,Rr.UP),down:this.needsCull(a,Rr.DOWN),west:this.needsCull(a,Rr.WEST),east:this.needsCull(a,Rr.EAST),north:this.needsCull(a,Rr.NORTH),south:this.needsCull(a,Rr.SOUTH)};t&&(i=t.getBuffers(r,s,this.resources,this.resources,l.indexOffset,n),e(i,a.pos,l)),_i.has(r.toString())&&(i=gi[r.toString()](l.indexOffset,s,this.resources,n),e(i,a.pos,l))}catch(n){console.error(`Error rendering block ${r}`,n)}}t?t.forEach((t=>{const e=this.getChunk(t);s(e)})):this.chunks.forEach((t=>t.forEach((t=>t.forEach((t=>{s(t)}))))))}needsCull(t,e){const r=this.structure.getBlock(ts.towards(t.pos,e))?.state;return!!r&&(this.resources.getBlockFlags(r.getName())?.opaque?!(e===Rr.UP&&t.state.isFluid()):t.state.isFluid()&&r.isFluid())}getGridBuffers(){const[t,e,r]=this.structure.getSize(),s=[],i=[];s.push(0,0,0,t,0,0),i.push(1,0,0,1,0,0),s.push(0,0,0,0,0,r),i.push(0,0,1,0,0,1),s.push(0,0,0,0,e,0),s.push(t,0,0,t,e,0),s.push(0,0,r,0,e,r),s.push(t,0,r,t,e,r),s.push(0,e,0,0,e,r),s.push(t,e,0,t,e,r),s.push(0,e,0,t,e,0),s.push(0,e,r,t,e,r);for(let n=1;n<=t;n+=1)s.push(n,0,0,n,0,r);for(let n=1;n<=r;n+=1)s.push(0,0,n,t,0,n);for(let n=0;n<8+t+r;n+=1)i.push(.8,.8,.8,.8,.8,.8);return{position:this.createBuffer(this.gl.ARRAY_BUFFER,new Float32Array(s)),color:this.createBuffer(this.gl.ARRAY_BUFFER,new Float32Array(i)),length:s.length/3}}getOutlineBuffers(){const t=[],e=[];return this.addCube(t,e,[1,1,1],[0,0,0],[1,1,1]),{position:this.createBuffer(this.gl.ARRAY_BUFFER,new Float32Array(t)),color:this.createBuffer(this.gl.ARRAY_BUFFER,new Float32Array(e)),length:t.length/3}}getInvisibleBlockBuffers(){if(!this.useInvisibleBlockBuffer)return;const t=this.structure.getSize(),e=[],r=[];for(let s=0;s<t[0];s+=1)for(let i=0;i<t[1];i+=1)for(let n=0;n<t[2];n+=1){const t=this.structure.getBlock([s,i,n]);void 0!==t&&(null===t?this.addCube(e,r,[1,.25,.25],[s+.4375,i+.4375,n+.4375],[s+.5625,i+.5625,n+.5625]):t.state.is(as.AIR)?this.addCube(e,r,[.5,.5,1],[s+.375,i+.375,n+.375],[s+.625,i+.625,n+.625]):t.state.is(new as("cave_air"))&&this.addCube(e,r,[.5,1,.5],[s+.375,i+.375,n+.375],[s+.625,i+.625,n+.625]))}return{position:this.createBuffer(this.gl.ARRAY_BUFFER,new Float32Array(e)),color:this.createBuffer(this.gl.ARRAY_BUFFER,new Float32Array(r)),length:e.length/3}}addCube(t,e,r,s,i){t.push(s[0],s[1],s[2],s[0],s[1],i[2]),t.push(i[0],s[1],s[2],i[0],s[1],i[2]),t.push(s[0],s[1],s[2],i[0],s[1],s[2]),t.push(s[0],s[1],i[2],i[0],s[1],i[2]),t.push(s[0],s[1],s[2],s[0],i[1],s[2]),t.push(i[0],s[1],s[2],i[0],i[1],s[2]),t.push(s[0],s[1],i[2],s[0],i[1],i[2]),t.push(i[0],s[1],i[2],i[0],i[1],i[2]),t.push(s[0],i[1],s[2],s[0],i[1],i[2]),t.push(i[0],i[1],s[2],i[0],i[1],i[2]),t.push(s[0],i[1],s[2],i[0],i[1],s[2]),t.push(s[0],i[1],i[2],i[0],i[1],i[2]);for(let n=0;n<24;n+=1)e.push(...r)}drawGrid(t){this.setShader(this.gridShaderProgram),this.prepareDraw(t),this.setVertexAttr("vertPos",3,this.gridBuffers.position),this.setVertexAttr("vertColor",3,this.gridBuffers.color),this.gl.drawArrays(this.gl.LINES,0,this.gridBuffers.length)}drawInvisibleBlocks(t){this.useInvisibleBlockBuffer&&(this.setShader(this.gridShaderProgram),this.prepareDraw(t),this.setVertexAttr("vertPos",3,this.invisibleBlockBuffers.position),this.setVertexAttr("vertColor",3,this.invisibleBlockBuffers.color),this.gl.drawArrays(this.gl.LINES,0,this.invisibleBlockBuffers.length))}drawStructure(t){this.setShader(this.shaderProgram),this.setTexture(this.atlasTexture),this.prepareDraw(t),this.chunks.forEach((t=>{t.forEach((t=>{t.forEach((t=>{t.buffer&&this.drawBuffers(t.buffer)}))}))}))}drawColoredStructure(t){this.setShader(this.colorShaderProgram),this.prepareDraw(t),this.chunks.forEach((t=>{t.forEach((t=>{t.forEach((t=>{t.buffer&&(this.setVertexAttr("vertPos",3,t.buffer.position),this.setVertexAttr("blockPos",3,t.buffer.blockPos),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t.buffer.index),this.gl.drawElements(this.gl.TRIANGLES,t.buffer.length,this.gl.UNSIGNED_SHORT,0))}))}))}))}drawOutline(t,e){this.setShader(this.gridShaderProgram);const r=Ws.Ue();Ws.JG(r,t),Ws.Iu(r,r,e),this.prepareDraw(r),this.setVertexAttr("vertPos",3,this.outlineBuffers.position),this.setVertexAttr("vertColor",3,this.outlineBuffers.color),this.gl.drawArrays(this.gl.LINES,0,this.outlineBuffers.length)}}class bi{img;idMap;part;constructor(t,e){if(this.img=t,this.idMap=e,!Ss(t.width)||!Ss(t.height))throw new Error(`Expected texture atlas dimensions to be powers of two, got ${t.width}x${t.height}.`);this.part=16/t.width}getTextureAtlas(){return this.img}getTextureUV(t){return this.idMap[t.toString()]??[0,0,this.part,this.part]}static async fromBlobs(t){const e=Math.sqrt(Object.keys(t).length+1),r=(s=e,s-=1,s|=s>>1,s|=s>>2,s|=s>>4,s|=s>>8,s|=s>>18,1+(s|=s>>32));var s;const i=16*r,n=1/r,a=document.createElement("canvas");a.width=i,a.height=i;const o=a.getContext("2d");this.drawInvalidTexture(o);const h={};let l=1;return await Promise.all(Object.keys(t).map((async e=>{const s=l%r,i=Math.floor(l/r);l+=1,h[e]=[n*s,n*i,n*s+n,n*i+n];const a=await createImageBitmap(t[e]);o.drawImage(a,0,0,16,16,16*s,16*i,16,16)}))),new bi(o.getImageData(0,0,i,i),h)}static empty(){const t=document.createElement("canvas");t.width=16,t.height=16;const e=t.getContext("2d");return bi.drawInvalidTexture(e),new bi(e.getImageData(0,0,16,16),{})}static drawInvalidTexture(t){t.fillStyle="black",t.fillRect(0,0,16,16),t.fillStyle="magenta",t.fillRect(0,0,8,8),t.fillRect(8,8,8,8)}}var yi,vi,xi,ki,Si,Ai,Ii,Ei,Bi,Ni,Ri,Ti,Mi;!function(t){const e=t=>new zi.HolderHolder(rs.parser(Bi.DENSITY_FUNCTION,zi.fromJson)(t));t.fromJson=function(t){const r=s.readObject(t)??{};return{barrier:e(r.barrier),fluidLevelFloodedness:e(r.fluid_level_floodedness),fluidLevelSpread:e(r.fluid_level_spread),lava:e(r.lava),temperature:e(r.temperature),vegetation:e(r.vegetation),continents:e(r.continents),erosion:e(r.erosion),depth:e(r.depth),ridges:e(r.ridges),initialDensityWithoutJaggedness:e(r.initial_density_without_jaggedness),finalDensity:e(r.final_density),veinToggle:e(r.vein_toggle),veinRidged:e(r.vein_ridged),veinGap:e(r.vein_gap)}},t.create=function(t){return{barrier:zi.Constant.ZERO,fluidLevelFloodedness:zi.Constant.ZERO,fluidLevelSpread:zi.Constant.ZERO,lava:zi.Constant.ZERO,temperature:zi.Constant.ZERO,vegetation:zi.Constant.ZERO,continents:zi.Constant.ZERO,erosion:zi.Constant.ZERO,depth:zi.Constant.ZERO,ridges:zi.Constant.ZERO,initialDensityWithoutJaggedness:zi.Constant.ZERO,finalDensity:zi.Constant.ZERO,veinToggle:zi.Constant.ZERO,veinRidged:zi.Constant.ZERO,veinGap:zi.Constant.ZERO,...t}},t.mapAll=function(t,e){return{barrier:t.barrier.mapAll(e),fluidLevelFloodedness:t.fluidLevelFloodedness.mapAll(e),fluidLevelSpread:t.fluidLevelSpread.mapAll(e),lava:t.lava.mapAll(e),temperature:t.temperature.mapAll(e),vegetation:t.vegetation.mapAll(e),continents:t.continents.mapAll(e),erosion:t.erosion.mapAll(e),depth:t.depth.mapAll(e),ridges:t.ridges.mapAll(e),initialDensityWithoutJaggedness:t.initialDensityWithoutJaggedness.mapAll(e),finalDensity:t.finalDensity.mapAll(e),veinToggle:t.veinToggle.mapAll(e),veinRidged:t.veinRidged.mapAll(e),veinGap:t.veinGap.mapAll(e)}};const r=new Map;t.instantiate=function(t,e){const s=e.key()?.toString();if(!s)throw new Error("Cannot instantiate noise from direct holder");const i=t.seedKey(),n=r.get(s);if(n&&n[0]===i[0]&&n[1]===i[1])return n[2];const a=new zs(t.fromHashOf(s),e.value());return r.set(s,[i[0],i[1],a]),a}}(yi||(yi={})),function(t){function e(t){return t.ySize<<2}t.fromJson=function(t){const e=s.readObject(t)??{};return{minY:s.readInt(e.min_y)??0,height:s.readInt(e.height)??256,xzSize:s.readInt(e.size_horizontal)??1,ySize:s.readInt(e.size_vertical)??1}},t.create=function(t){return{minY:0,height:256,xzSize:1,ySize:1,...t}},t.cellHeight=e,t.cellWidth=function(t){return t.xzSize<<2},t.cellCountY=function(t){return t.height/e(t)},t.minCellY=function(t){return Math.floor(t.minY/e(t))}}(vi||(vi={})),function(t){t.fromJson=function(t){const e=s.readObject(t)??{};return{target:s.readNumber(e.target)??0,size:s.readInt(e.size)??0,offset:s.readInt(e.offset)??0}},t.apply=function(t,e,r){if(t.size<=0)return e;const s=(r-t.offset)/t.size;return ws(t.target,e,s)}}(xi||(xi={})),function(t){t.fromJson=function(t){const e=s.readObject(t)??{};return void 0!==e.absolute?(r=s.readNumber(e.absolute)??0,()=>r):void 0!==e.above_bottom?function(t){return e=>e.minY+t}(s.readNumber(e.above_bottom)??0):void 0!==e.below_top?function(t){return e=>e.maxY-t}(s.readNumber(e.below_top)??0):()=>0;var r}}(ki||(ki={})),function(t){t.create=function(t,e){return{minY:t,height:e,maxY:t+e-1}}}(Si||(Si={}));class Ci{rule;defaultBlock;surfaceNoise;surfaceSecondaryNoise;random;positionalRandoms;constructor(t,e,r){this.rule=t,this.defaultBlock=e,this.random=Ns.create(r).forkPositional(),this.surfaceNoise=yi.instantiate(this.random,Bi.SURFACE_NOISE),this.surfaceSecondaryNoise=yi.instantiate(this.random,Bi.SURFACE_SECONDARY_NOISE),this.positionalRandoms=new Map}buildSurface(t,e,r,s){const i=es.minBlockX(t.pos),n=es.minBlockZ(t.pos),a=new Oi(this,t,e,r,s),o=this.rule(a);for(let h=0;h<16;h+=1){const e=i+h;for(let r=0;r<1;r+=1){const s=n+r;a.updateXZ(e,s);let i=0,h=Number.MIN_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER;for(let r=t.maxY;r>=t.minY;r-=1){const n=ts.create(e,r,s),u=t.getBlockState(n);if(u.equals(as.AIR)){i=0,h=Number.MIN_SAFE_INTEGER;continue}if(u.isFluid()){h===Number.MIN_SAFE_INTEGER&&(h=r+1);continue}if(l>=r){l=Number.MIN_SAFE_INTEGER;for(let i=r-1;i>=t.minY;i-=1){const r=t.getBlockState(ts.create(e,i,s));if(r.equals(as.AIR)||r.isFluid()){l=i+1;break}}}i+=1;const c=r-l+1;if(!u.equals(this.defaultBlock))continue;a.updateY(i,c,h,r);const d=o(e,r,s);d&&t.setBlockState(n,d)}}}}getSurfaceDepth(t,e){return 2.75*this.surfaceNoise.sample(t,0,e)+3+.25*this.random.at(t,0,e).nextDouble()}getSurfaceSecondary(t,e){return this.surfaceSecondaryNoise.sample(t,0,e)}getRandom(t){return a(this.positionalRandoms,t,(()=>this.random.fromHashOf(t)))}}class Oi{system;chunk;noiseChunk;context;getBiome;blockX=0;blockY=0;blockZ=0;stoneDepthAbove=0;stoneDepthBelow=0;surfaceDepth=0;waterHeight=0;biome=()=>"";surfaceSecondary=()=>0;minSurfaceLevel=()=>0;constructor(t,e,r,s,i){this.system=t,this.chunk=e,this.noiseChunk=r,this.context=s,this.getBiome=i}updateXZ(t,e){this.blockX=t,this.blockZ=e,this.surfaceDepth=this.system.getSurfaceDepth(t,e),this.surfaceSecondary=n((()=>this.system.getSurfaceSecondary(t,e))),this.minSurfaceLevel=n((()=>this.calculateMinSurfaceLevel(t,e)))}updateY(t,e,r,s){this.blockY=s,this.stoneDepthAbove=t,this.stoneDepthBelow=e,this.waterHeight=r,this.biome=n((()=>this.getBiome(ts.create(this.blockX,this.blockY,this.blockZ))))}calculateMinSurfaceLevel(t,e){const r=t>>4,s=e>>4,i=this.noiseChunk.getPreliminarySurfaceLevel(r<<4,s<<4),n=this.noiseChunk.getPreliminarySurfaceLevel(r+1<<4,s<<4),a=this.noiseChunk.getPreliminarySurfaceLevel(r<<4,s+1<<4),o=this.noiseChunk.getPreliminarySurfaceLevel(r+1<<4,s+1<<4);return Math.floor(ps((15&t)/16,(15&e)/16,i,n,a,o))+this.surfaceDepth-8}}!function(t){function e(t){return()=>()=>t}function r(t){return e=>{const r=t.map((t=>t(e)));return(t,e,s)=>{for(const i of r){const r=i(t,e,s);if(r)return r}}}}function i(t,e){return r=>(s,i,n)=>{if(t(r))return e(r)(s,i,n)}}t.NOOP=()=>()=>{},t.fromJson=function(n){const a=s.readObject(n)??{},o=s.readString(a.type)?.replace(/^minecraft:/,"");switch(o){case"block":return e(as.fromJson(a.result_state));case"sequence":return r(s.readArray(a.sequence,t.fromJson)??[]);case"condition":return i(Ii.fromJson(a.if_true),t.fromJson(a.then_run))}return t.NOOP},t.block=e,t.sequence=r,t.condition=i}(Ai||(Ai={})),function(t){function e(){return t=>t.blockY>=t.minSurfaceLevel()}function r(t){const e=new Set(t);return t=>e.has(t.biome())}function i(t){return e=>!t(e)}function n(t,e,r,s){return i=>{const n=s?i.stoneDepthBelow:i.stoneDepthAbove,a=e?i.surfaceDepth:0,o=0===r?0:vs(i.surfaceSecondary(),-1,1,0,r);return n<=1+t+a+o}}function a(t,e,r){return s=>{const i=e(s.context),n=r(s.context);if(s.blockY<=i)return!0;if(s.blockY>=n)return!1;const a=s.system.getRandom(t),o=vs(s.blockY,i,n,1,0);return a.nextFloat()<o}}function o(t,e,r){return s=>{if(s.waterHeight===Number.MIN_SAFE_INTEGER)return!0;const i=r?s.stoneDepthAbove:0;return s.blockY+i>=s.waterHeight+t+s.surfaceDepth*e}}function h(t,e,r){return s=>{const i=r?s.stoneDepthAbove:0;return s.blockY+i>=t(s.context)+s.surfaceDepth*e}}t.FALSE=()=>!1,t.TRUE=()=>!0,t.fromJson=function(e){const l=s.readObject(e)??{},u=s.readString(l.type)?.replace(/^minecraft:/,"");switch(u){case"above_preliminary_surface":return t=>t.blockY>=t.minSurfaceLevel();case"biome":return r(s.readArray(l.biome_is,(t=>s.readString(t)??""))??[]);case"not":return i(t.fromJson(l.invert));case"stone_depth":return n(s.readInt(l.offset)??0,s.readBoolean(l.add_surface_depth)??!1,s.readInt(l.secondary_depth_range)??0,"ceiling"===s.readString(l.surface_type));case"vertical_gradient":return a(s.readString(l.random_name)??"",ki.fromJson(l.true_at_and_below),ki.fromJson(l.false_at_and_above));case"water":return o(s.readInt(l.offset)??0,s.readInt(l.surface_depth_multiplier)??0,s.readBoolean(l.add_surface_depth)??!1);case"y_above":return h(ki.fromJson(l.anchor),s.readInt(l.surface_depth_multiplier)??0,s.readBoolean(l.add_surface_depth)??!1)}return t.FALSE},t.abovePreliminarySurface=e,t.biome=r,t.not=i,t.stoneDepth=n,t.verticalGradient=a,t.water=o,t.yAbove=h}(Ii||(Ii={})),function(t){t.fromJson=function(t){const e=s.readObject(t)??{};return{surfaceRule:Ai.fromJson(e.surface_rule),noise:vi.fromJson(e.noise),defaultBlock:as.fromJson(e.default_block),defaultFluid:as.fromJson(e.default_fluid),noiseRouter:yi.fromJson(e.noise_router),seaLevel:s.readInt(e.sea_level)??0,disableMobGeneration:s.readBoolean(e.disable_mob_generation)??!1,aquifersEnabled:s.readBoolean(e.aquifers_enabled)??!1,oreVeinsEnabled:s.readBoolean(e.ore_veins_enabled)??!1,legacyRandomSource:s.readBoolean(e.legacy_random_source)??!1}},t.create=function(t){return{surfaceRule:Ai.NOOP,noise:vi.create({}),defaultBlock:as.STONE,defaultFluid:as.WATER,noiseRouter:yi.create({}),seaLevel:0,disableMobGeneration:!1,aquifersEnabled:!1,oreVeinsEnabled:!1,legacyRandomSource:!1,...t}}}(Ei||(Ei={})),function(t){function e(t,e){const r=new us(ns.create(t),e);return us.REGISTRY.register(r.key,r),r}function r(e,r,s){return t.NOISE.register(ns.create(e),As.create(r,s),!0)}t.NOISE=e("worldgen/noise",As.fromJson),t.DENSITY_FUNCTION=e("worldgen/density_function",(t=>zi.fromJson(t))),t.NOISE_SETTINGS=e("worldgen/noise_settings",Ei.fromJson),t.SURFACE_NOISE=r("surface",-6,[1,1,1]),t.SURFACE_SECONDARY_NOISE=r("surface_secondary",-6,[1,1,0,1])}(Bi||(Bi={}));class zi{minValue(){return-this.maxValue()}mapAll(t){return t.map(this)}}!function(t){t.context=function(t,e,r){return{x:t,y:e,z:r}};class e extends t{input;constructor(t){super(),this.input=t}compute(t){return this.transform(t,this.input.compute(t))}}const r=rs.parser(Bi.NOISE,As.fromJson);t.fromJson=function t(e,a=t){if("string"==typeof e)return new n(rs.reference(Bi.DENSITY_FUNCTION,ns.parse(e)));if("number"==typeof e)return new i(e);const l=s.readObject(e)??{},v=s.readString(l.type)?.replace(/^minecraft:/,"");switch(v){case"blend_alpha":return new o(1,0,1);case"blend_offset":case"beardifier":return new o(0,-1/0,1/0);case"old_blended_noise":return new h(s.readNumber(l.xz_scale)??1,s.readNumber(l.y_scale)??1,s.readNumber(l.xz_factor)??80,s.readNumber(l.y_factor)??160,s.readNumber(l.smear_scale_multiplier)??8);case"flat_cache":return new u(a(l.argument));case"interpolated":return new m(a(l.argument));case"cache_2d":return new d(a(l.argument));case"cache_once":return new f(a(l.argument));case"cache_all_in_cell":return new c(a(l.argument));case"noise":return new p(s.readNumber(l.xz_scale)??1,s.readNumber(l.y_scale)??1,r(l.noise));case"end_islands":return new g;case"weird_scaled_sampler":return new w(a(l.input),s.readEnum(l.rarity_value_mapper,_),r(l.noise));case"shifted_noise":return new b(a(l.shift_x),a(l.shift_y),a(l.shift_z),s.readNumber(l.xz_scale)??1,s.readNumber(l.y_scale)??1,r(l.noise));case"range_choice":return new y(a(l.input),s.readNumber(l.min_inclusive)??0,s.readNumber(l.max_exclusive)??1,a(l.when_in_range),a(l.when_out_of_range));case"shift_a":return new x(r(l.argument));case"shift_b":return new k(r(l.argument));case"shift":return new S(r(l.argument));case"blend_density":return new A(a(l.argument));case"clamp":return new I(a(l.input),s.readNumber(l.min)??0,s.readNumber(l.max)??1);case"abs":case"square":case"cube":case"half_negative":case"quarter_negative":case"squeeze":return new E(v,a(l.argument));case"add":case"mul":case"min":case"max":return new N(s.readEnum(v,B),a(l.argument1),a(l.argument2));case"spline":return new R(is.fromJson(l.spline,a));case"constant":return new i(s.readNumber(l.argument)??0);case"y_clamped_gradient":return new T(s.readInt(l.from_y)??-4064,s.readInt(l.to_y)??4062,s.readNumber(l.from_value)??-4064,s.readNumber(l.to_value)??4062)}return i.ZERO};class i extends t{value;static ZERO=new i(0);static ONE=new i(1);constructor(t){super(),this.value=t}compute(){return this.value}minValue(){return this.value}maxValue(){return this.value}}t.Constant=i;class n extends t{holder;constructor(t){super(),this.holder=t}compute(t){return this.holder.value().compute(t)}minValue(){return this.holder.value().minValue()}maxValue(){return this.holder.value().maxValue()}}t.HolderHolder=n;class o extends t.Constant{min;max;constructor(t,e,r){super(t),this.min=e,this.max=r}minValue(){return this.min}maxValue(){return this.max}}t.ConstantMinMax=o;class h extends t{xzScale;yScale;xzFactor;yFactor;smearScaleMultiplier;blendedNoise;constructor(t,e,r,s,i,n){super(),this.xzScale=t,this.yScale=e,this.xzFactor=r,this.yFactor=s,this.smearScaleMultiplier=i,this.blendedNoise=n}compute(t){return this.blendedNoise?.sample(t.x,t.y,t.z)??0}maxValue(){return this.blendedNoise?.maxValue??0}}t.OldBlendedNoise=h;class l extends t{wrapped;constructor(t){super(),this.wrapped=t}minValue(){return this.wrapped.minValue()}maxValue(){return this.wrapped.maxValue()}}class u extends l{lastQuartX;lastQuartZ;lastValue=0;constructor(t){super(t)}compute(e){const r=e.x>>2,s=e.z>>2;return this.lastQuartX===r&&this.lastQuartZ===s||(this.lastValue=this.wrapped.compute(t.context(r<<2,0,s<<2)),this.lastQuartX=r,this.lastQuartZ=s),this.lastValue}mapAll(t){return t.map(new u(this.wrapped.mapAll(t)))}}t.FlatCache=u;class c extends l{constructor(t){super(t)}compute(t){return this.wrapped.compute(t)}mapAll(t){return t.map(new c(this.wrapped.mapAll(t)))}}t.CacheAllInCell=c;class d extends l{lastBlockX;lastBlockZ;lastValue=0;constructor(t){super(t)}compute(t){const e=t.x,r=t.z;return this.lastBlockX===e&&this.lastBlockZ===r||(this.lastValue=this.wrapped.compute(t),this.lastBlockX=e,this.lastBlockZ=r),this.lastValue}mapAll(t){return t.map(new d(this.wrapped.mapAll(t)))}}t.Cache2D=d;class f extends l{lastBlockX;lastBlockY;lastBlockZ;lastValue=0;constructor(t){super(t)}compute(t){const e=t.x,r=t.y,s=t.z;return this.lastBlockX===e&&this.lastBlockY===r&&this.lastBlockZ===s||(this.lastValue=this.wrapped.compute(t),this.lastBlockX=e,this.lastBlockY=r,this.lastBlockZ=s),this.lastValue}mapAll(t){return t.map(new f(this.wrapped.mapAll(t)))}}t.CacheOnce=f;class m extends l{cellWidth;cellHeight;values;constructor(t,e=4,r=4){super(t),this.cellWidth=e,this.cellHeight=r,this.values=new Map}compute({x:t,y:e,z:r}){const s=this.cellWidth,i=this.cellHeight,n=(t%s+s)%s/s,a=(e%i+i)%i/i,o=(r%s+s)%s/s,h=Math.floor(t/s)*s,l=Math.floor(e/i)*i,u=Math.floor(r/s)*s;return function(t,e,r,s,i,n,a,o,h,l,u){return gs(r,(()=>_s(t,e,s,i,n,a)),(()=>_s(t,e,o,h,l,u)))}(n,a,o,(()=>this.computeCorner(h,l,u)),(()=>this.computeCorner(h+s,l,u)),(()=>this.computeCorner(h,l+i,u)),(()=>this.computeCorner(h+s,l+i,u)),(()=>this.computeCorner(h,l,u+s)),(()=>this.computeCorner(h+s,l,u+s)),(()=>this.computeCorner(h,l+i,u+s)),(()=>this.computeCorner(h+s,l+i,u+s)))}computeCorner(e,r,s){return a(this.values,`${e} ${r} ${s}`,(()=>this.wrapped.compute(t.context(e,r,s))))}mapAll(t){return t.map(new m(this.wrapped.mapAll(t)))}withCellSize(t,e){return new m(this.wrapped,t,e)}}t.Interpolated=m;class p extends t{xzScale;yScale;noiseData;noise;constructor(t,e,r,s){super(),this.xzScale=t,this.yScale=e,this.noiseData=r,this.noise=s}compute(t){return this.noise?.sample(t.x*this.xzScale,t.y*this.yScale,t.z*this.xzScale)??0}maxValue(){return this.noise?.maxValue??2}}t.Noise=p;class g extends t{islandNoise;constructor(t){super();const e=new Es(t??BigInt(0));e.consume(17292),this.islandNoise=new Ts(e)}getHeightValue(t,e){const r=Math.floor(t/2),s=Math.floor(e/2),i=t%2,n=e%2;let a=fs(100-Math.sqrt(t*t+e*e),-100,80);for(let o=-12;o<=12;o+=1)for(let t=-12;t<=12;t+=1){const e=r+o,h=s+t;if(e*e+h*h<=4096||this.islandNoise.sample2D(e,h)>=-.9)continue;const l=(3439*Math.abs(e)+147*Math.abs(h))%13+9,u=i+2*o,c=n+2*t,d=fs(100-Math.sqrt(u*u+c*c)*l,-100,80);a=Math.max(a,d)}return a}compute({x:t,y:e,z:r}){return(this.getHeightValue(Math.floor(t/8),Math.floor(r/8))-8)/128}minValue(){return-.84375}maxValue(){return.5625}}t.EndIslands=g;const _=["type_1","type_2"];class w extends e{rarityValueMapper;noiseData;noise;static ValueMapper={type_1:w.rarityValueMapper1,type_2:w.rarityValueMapper2};mapper;constructor(t,e,r,s){super(t),this.rarityValueMapper=e,this.noiseData=r,this.noise=s,this.mapper=w.ValueMapper[this.rarityValueMapper]}transform(t,e){if(!this.noise)return 0;const r=this.mapper(e);return r*Math.abs(this.noise.sample(t.x/r,t.y/r,t.z/r))}mapAll(t){return t.map(new w(this.input.mapAll(t),this.rarityValueMapper,this.noiseData,this.noise))}minValue(){return 0}maxValue(){return"type_1"===this.rarityValueMapper?2:3}static rarityValueMapper1(t){return t<-.5?.75:t<0?1:t<.5?1.5:2}static rarityValueMapper2(t){return t<-.75?.5:t<-.5?.75:t<.5?1:t<.75?2:3}}t.WeirdScaledSampler=w;class b extends p{shiftX;shiftY;shiftZ;constructor(t,e,r,s,i,n,a){super(s,i,n,a),this.shiftX=t,this.shiftY=e,this.shiftZ=r}compute(t){const e=t.x*this.xzScale+this.shiftX.compute(t),r=t.y*this.yScale+this.shiftY.compute(t),s=t.z*this.xzScale+this.shiftZ.compute(t);return this.noise?.sample(e,r,s)??0}mapAll(t){return t.map(new b(this.shiftX.mapAll(t),this.shiftY.mapAll(t),this.shiftZ.mapAll(t),this.xzScale,this.yScale,this.noiseData,this.noise))}}t.ShiftedNoise=b;class y extends t{input;minInclusive;maxExclusive;whenInRange;whenOutOfRange;constructor(t,e,r,s,i){super(),this.input=t,this.minInclusive=e,this.maxExclusive=r,this.whenInRange=s,this.whenOutOfRange=i}compute(t){const e=this.input.compute(t);return this.minInclusive<=e&&e<this.maxExclusive?this.whenInRange.compute(t):this.whenOutOfRange.compute(t)}mapAll(t){return t.map(new y(this.input.mapAll(t),this.minInclusive,this.maxExclusive,this.whenInRange.mapAll(t),this.whenOutOfRange.mapAll(t)))}minValue(){return Math.min(this.whenInRange.minValue(),this.whenOutOfRange.minValue())}maxValue(){return Math.max(this.whenInRange.maxValue(),this.whenOutOfRange.maxValue())}}t.RangeChoice=y;class v extends t{noiseData;offsetNoise;constructor(t,e){super(),this.noiseData=t,this.offsetNoise=e}compute(t){return this.offsetNoise?.sample(.25*t.x,.25*t.y,.25*t.z)??0}maxValue(){return 4*(this.offsetNoise?.maxValue??2)}}t.ShiftNoise=v;class x extends v{constructor(t,e){super(t,e)}compute(e){return super.compute(t.context(e.x,0,e.z))}withNewNoise(t){return new x(this.noiseData,t)}}t.ShiftA=x;class k extends v{constructor(t,e){super(t,e)}compute(e){return super.compute(t.context(e.z,e.x,0))}withNewNoise(t){return new k(this.noiseData,t)}}t.ShiftB=k;class S extends v{constructor(t,e){super(t,e)}withNewNoise(t){return new S(this.noiseData,t)}}t.Shift=S;class A extends e{constructor(t){super(t)}transform(t,e){return e}mapAll(t){return t.map(new A(this.input.mapAll(t)))}minValue(){return-1/0}maxValue(){return 1/0}}t.BlendDensity=A;class I extends e{min;max;constructor(t,e,r){super(t),this.min=e,this.max=r}transform(t,e){return fs(e,this.min,this.max)}mapAll(t){return t.map(new I(this.input.mapAll(t),this.min,this.max))}minValue(){return this.min}maxValue(){return this.max}}t.Clamp=I;class E extends e{type;min;max;static MappedTypes={abs:t=>Math.abs(t),square:t=>t*t,cube:t=>t*t*t,half_negative:t=>t>0?t:.5*t,quarter_negative:t=>t>0?t:.25*t,squeeze:t=>{const e=fs(t,-1,1);return e/2-e*e*e/24}};transformer;constructor(t,e,r,s){super(e),this.type=t,this.min=r,this.max=s,this.transformer=E.MappedTypes[this.type]}transform(t,e){return this.transformer(e)}mapAll(t){return t.map(new E(this.type,this.input.mapAll(t)))}minValue(){return this.min??-1/0}maxValue(){return this.max??1/0}withMinMax(){const t=this.input.minValue();let e=this.transformer(t),r=this.transformer(this.input.maxValue());return"abs"!==this.type&&"square"!==this.type||(r=Math.max(e,r),e=Math.max(0,t)),new E(this.type,this.input,e,r)}}t.Mapped=E;const B=["add","mul","min","max"];class N extends t{type;argument1;argument2;min;max;constructor(t,e,r,s,i){super(),this.type=t,this.argument1=e,this.argument2=r,this.min=s,this.max=i}compute(t){const e=this.argument1.compute(t);switch(this.type){case"add":return e+this.argument2.compute(t);case"mul":return 0===e?0:e*this.argument2.compute(t);case"min":return e<this.argument2.minValue()?e:Math.min(e,this.argument2.compute(t));case"max":return e>this.argument2.maxValue()?e:Math.max(e,this.argument2.compute(t))}}mapAll(t){return t.map(new N(this.type,this.argument1.mapAll(t),this.argument2.mapAll(t)))}minValue(){return this.min??-1/0}maxValue(){return this.max??1/0}withMinMax(){const t=this.argument1.minValue(),e=this.argument2.minValue(),r=this.argument1.maxValue(),s=this.argument2.maxValue();let i,n;switch("min"!==this.type&&"max"!==this.type||!(t>=s||e>=r)||console.warn(`Creating a ${this.type} function between two non-overlapping inputs`),this.type){case"add":i=t+e,n=r+s;break;case"mul":i=t>0&&e>0?t*e||0:r<0&&s<0?r*s||0:Math.min(t*s||0,e*r||0),n=t>0&&e>0?r*s||0:r<0&&s<0?t*e||0:Math.max(t*e||0,r*s||0);break;case"min":i=Math.min(t,e),n=Math.min(r,s);break;case"max":i=Math.max(t,e),n=Math.max(r,s)}return new N(this.type,this.argument1,this.argument2,i,n)}}t.Ap2=N;class R extends t{spline;constructor(t){super(),this.spline=t}compute(t){return this.spline.compute(t)}mapAll(e){const r=this.spline.mapAll((r=>r instanceof t?r.mapAll(e):r));return r.calculateMinMax(),e.map(new R(r))}minValue(){return this.spline.min()}maxValue(){return this.spline.max()}}t.Spline=R;class T extends t{fromY;toY;fromValue;toValue;constructor(t,e,r,s){super(),this.fromY=t,this.toY=e,this.fromValue=r,this.toValue=s}compute(t){return e=t.y,r=this.fromY,s=this.toY,i=this.fromValue,n=this.toValue,ws(i,n,bs(e,r,s));var e,r,s,i,n}minValue(){return Math.min(this.fromValue,this.toValue)}maxValue(){return Math.max(this.fromValue,this.toValue)}}t.YClampedGradient=T}(zi||(zi={}));class Fi{level;type;constructor(t,e){this.level=t,this.type=e}at(t){return t<this.level?this.type:as.AIR}}!function(t){t.createDisabled=function(t){return{compute({x:e,y:r,z:s},i){if(!(i>0))return t(e,r,s).at(r)}}}}(Ni||(Ni={}));class Li{shift;biomes;n;constructor(t,e){if(this.shift=t,this.biomes=e,0===e.length)throw new Error("Cannot create checkerboard biome source without biomes");this.n=e.length}getBiome(t,e,r){const s=(((t>>this.shift)+(r>>this.shift))%this.n+this.n)%this.n;return ns.parse(this.biomes[s].toString())}static fromJson(t){const e=s.readObject(t)??{},r=s.readInt(e.scale)??2;let i;return i="string"==typeof e.biomes?[ns.parse(e.biomes)]:s.readArray(e.biomes,(t=>ns.parse(s.readString(t)??"")))??[],new Li(r+2,i)}}class Di{biome;constructor(t){this.biome=t}getBiome(){return this.biome}static fromJson(t){const e=s.readObject(t)??{},r=ns.parse(s.readString(e.biome)??"plains");return new Di(r)}}!function(t){function e(t,e){return"number"==typeof t?new r(t,e??t):t}t.target=function(t,e,r,s,i,a){return new n(t,e,r,s,i,a)},t.parameters=function(t,r,s,n,a,o,h){return new i(e(t),e(r),e(s),e(n),e(a),e(o),h)},t.param=e;class r{min;max;constructor(t,e){this.min=t,this.max=e}distance(t){const e=("number"==typeof t?t:t.min)-this.max,r=this.min-("number"==typeof t?t:t.max);return e>0?e:Math.max(r,0)}union(t){return new r(Math.min(this.min,t.min),Math.max(this.max,t.max))}static fromJson(t){if("number"==typeof t)return new r(t,t);const[e,i]=s.readArray(t,(t=>s.readNumber(t)))??[];return new r(e??0,i??0)}}t.Param=r;class i{temperature;humidity;continentalness;erosion;depth;weirdness;offset;constructor(t,e,r,s,i,n,a){this.temperature=t,this.humidity=e,this.continentalness=r,this.erosion=s,this.depth=i,this.weirdness=n,this.offset=a}fittness(t){return ds(this.temperature.distance(t.temperature))+ds(this.humidity.distance(t.humidity))+ds(this.continentalness.distance(t.continentalness))+ds(this.erosion.distance(t.erosion))+ds(this.depth.distance(t.depth))+ds(this.weirdness.distance(t.weirdness))+ds(this.offset-t.offset)}space(){return[this.temperature,this.humidity,this.continentalness,this.erosion,this.depth,this.weirdness,new r(this.offset,this.offset)]}static fromJson(t){const e=s.readObject(t)??{};return new i(r.fromJson(e.temperature),r.fromJson(e.humidity),r.fromJson(e.continentalness),r.fromJson(e.erosion),r.fromJson(e.depth),r.fromJson(e.weirdness),s.readInt(e.offset)??0)}}t.ParamPoint=i;class n{temperature;humidity;continentalness;erosion;depth;weirdness;constructor(t,e,r,s,i,n){this.temperature=t,this.humidity=e,this.continentalness=r,this.erosion=s,this.depth=i,this.weirdness=n}get offset(){return 0}toArray(){return[this.temperature,this.humidity,this.continentalness,this.erosion,this.depth,this.weirdness,this.offset]}}t.TargetPoint=n;t.Parameters=class{things;index;constructor(t){this.things=t,this.index=new a(t)}find(t){return this.index.search(t,((t,e)=>t.distance(e)))}};t.Sampler=class{temperature;humidity;continentalness;erosion;depth;weirdness;constructor(t,e,r,s,i,n){this.temperature=t,this.humidity=e,this.continentalness=r,this.erosion=s,this.depth=i,this.weirdness=n}static fromRouter(e){return new t.Sampler(e.temperature,e.vegetation,e.continents,e.erosion,e.depth,e.ridges)}sample(e,r,s){const i=zi.context(e<<2,r<<2,s<<2);return t.target(this.temperature.compute(i),this.humidity.compute(i),this.continentalness.compute(i),this.erosion.compute(i),this.depth.compute(i),this.weirdness.compute(i))}};class a{static CHILDREN_PER_NODE=10;root;constructor(t){if(0===t.length)throw new Error("At least one point is required to build search tree");this.root=a.build(t.map((([t,e])=>new l(t,e))))}static build(t){if(1===t.length)return t[0];if(t.length<=a.CHILDREN_PER_NODE){const e=t.map((t=>{let e=0;for(let r=0;r<7;r+=1){const s=t.space[r];e+=Math.abs((s.min+s.max)/2)}return{key:e,node:t}})).sort(((t,e)=>t.key-e.key)).map((({node:t})=>t));return new h(e)}let e=1/0,r=-1,s=[];for(let i=0;i<7;++i){t=a.sort(t,i,!1),s=a.bucketize(t);let n=0;for(const t of s)n+=a.area(t.space);e>n&&(e=n,r=i)}return t=a.sort(t,r,!1),s=a.bucketize(t),s=a.sort(s,r,!0),new h(s.map((t=>a.build(t.children))))}static sort(t,e,r){return t.map((t=>{const s=t.space[e],i=(s.min+s.max)/2;return{key:r?Math.abs(i):i,node:t}})).sort(((t,e)=>t.key-e.key)).map((({node:t})=>t))}static bucketize(t){const e=[];let r=[];const s=Math.pow(10,Math.floor(Math.log(t.length-.01)/Math.log(10)));for(const i of t)r.push(i),r.length<s||(e.push(new h(r)),r=[]);return 0!==r.length&&e.push(new h(r)),e}static area(t){let e=0;for(const r of t)e+=Math.abs(r.max-r.min);return e}search(t,e){return this.root.search(t.toArray(),e).thing()}}t.RTree=a;class o{space;constructor(t){this.space=t}distance(t){let e=0;for(let r=0;r<7;r+=1)e+=ds(this.space[r].distance(t[r]));return e}}t.RNode=o;class h extends o{children;constructor(t){super(h.buildSpace(t)),this.children=t}static buildSpace(t){let e=[...Array(7)].map((()=>new r(1/0,-1/0)));for(const r of t)e=[...Array(7)].map(((t,s)=>e[s].union(r.space[s])));return e}search(t,e){let r=1/0,s=null;for(const i of this.children){const n=e(i,t);if(r<=n)continue;const a=i.search(t,e),o=i==a?n:e(a,t);r<=o||(r=o,s=a)}return s}}t.RSubTree=h;class l extends o{thing;constructor(t,e){super(t.space()),this.thing=e}search(){return this}}t.RLeaf=l}(Ri||(Ri={}));class Pi{parameters;constructor(t){this.parameters=new Ri.Parameters(t)}getBiome(t,e,r,s){const i=s.sample(t,e,r);return this.parameters.find(i)}static fromJson(t){const e=s.readObject(t)??{},r=(s.readArray(e.biomes,(t=>(t=>({biome:ns.parse(s.readString(t.biome)??"plains"),parameters:Ri.ParamPoint.fromJson(t.parameters)}))(s.readObject(t)??{})))??[]).map((t=>[t.parameters,()=>t.biome]));return new Pi(r)}}class Ui{static END=ns.create("the_end");static HIGHLANDS=ns.create("end_highlands");static MIDLANDS=ns.create("end_midlands");static ISLANDS=ns.create("small_end_islands");static BARRENS=ns.create("end_barrens");getBiome(t,e,r,s){const i=e<<2,n=t<<2>>4,a=r<<2>>4;if(n*n+a*a<=4096)return Ui.END;const o=zi.context(8*(2*n+1),i,8*(2*a+1)),h=s.erosion.compute(o);return h>.25?Ui.HIGHLANDS:h>=-.0625?Ui.MIDLANDS:h>=-.21875?Ui.BARRENS:Ui.ISLANDS}static fromJson(t){return new Ui}}!function(t){t.fromJson=function(t){const e=s.readObject(t)??{},r=s.readString(e.type)?.replace(/^minecraft:/,"");switch(r){case"fixed":return Di.fromJson(t);case"checkerboard":return Li.fromJson(t);case"multi_noise":return Pi.fromJson(t);case"the_end":return Ui.fromJson(t);default:return{getBiome:()=>ns.create("plains")}}}}(Ti||(Ti={}));class Vi{cellCountXZ;cellCountY;cellNoiseMinY;minX;minZ;settings;cellWidth;cellHeight;firstCellX;firstCellZ;firstNoiseX;firstNoiseZ;noiseSizeXZ;preliminarySurfaceLevel=new Map;aquifer;materialRule;initialDensity;constructor(t,e,r,s,i,n,a,o,h){this.cellCountXZ=t,this.cellCountY=e,this.cellNoiseMinY=r,this.minX=i,this.minZ=n,this.settings=a,this.cellWidth=vi.cellWidth(a),this.cellHeight=vi.cellHeight(a),this.firstCellX=Math.floor(i/this.cellWidth),this.firstCellZ=Math.floor(n/this.cellWidth),this.firstNoiseX=i>>2,this.firstNoiseZ=n>>2,this.noiseSizeXZ=t*this.cellWidth>>2,this.aquifer=Ni.createDisabled(h);const l=s.router.finalDensity;this.materialRule=Mi.fromList([t=>this.aquifer.compute(t,l.compute(t))]),this.initialDensity=s.router.initialDensityWithoutJaggedness}getFinalState(t,e,r){return this.materialRule({x:t,y:e,z:r})}getPreliminarySurfaceLevel(t,e){return a(this.preliminarySurfaceLevel,es.asLong(t,e),(()=>{const r=t<<2,s=e<<2;for(let t=this.settings.minY+this.settings.height;t>=this.settings.minY;t-=this.cellHeight){if(this.initialDensity.compute(zi.context(r,t,s))>.390625)return t}return Number.MAX_SAFE_INTEGER}))}}!function(t){t.fromList=function(t){return e=>{for(const r of t){const t=r(e);if(t)return t}}}}(Mi||(Mi={}));class Zi{biomeSource;settings;noiseChunkCache;globalFluidPicker;constructor(t,e){this.biomeSource=t,this.settings=e,this.noiseChunkCache=new Map;const r=new Fi(-54,as.LAVA),s=new Fi(e.seaLevel,e.defaultFluid);this.globalFluidPicker=(t,i,n)=>i<Math.min(-54,e.seaLevel)?r:s}fill(t,e,r=!1){const s=Math.max(e.minY,this.settings.noise.minY),i=Math.min(e.maxY,this.settings.noise.minY+this.settings.noise.height),n=vi.cellWidth(this.settings.noise),a=vi.cellHeight(this.settings.noise),o=Math.floor(16/n),h=Math.floor(s/a),l=Math.floor((i-s)/a),u=es.minBlockX(e.pos),c=es.minBlockZ(e.pos),d=this.getOrCreateNoiseChunk(t,e);for(let f=0;f<o;f+=1)for(let t=0;t<(r?1:o);t+=1){let s=e.getOrCreateSection(e.sectionsCount-1);for(let i=l-1;i>=0;i-=1)for(let o=a-1;o>=0;o-=1){const l=(h+i)*a+o,m=15&l,p=e.getSectionIndex(l);e.getSectionIndex(s.minBlockY)!==p&&(s=e.getOrCreateSection(p));for(let e=0;e<n;e+=1){const i=u+f*n+e,a=15&i;for(let e=0;e<(r?1:n);e+=1){const r=c+t*n+e,o=15&r,h=d.getFinalState(i,l,r)??this.settings.defaultBlock;s.setBlockState(a,m,o,h)}}}}}buildSurface(t,e,r="minecraft:plains"){const s=this.getOrCreateNoiseChunk(t,e),i=Si.create(this.settings.noise.minY,this.settings.noise.height);t.surfaceSystem.buildSurface(e,s,i,(()=>r))}computeBiome(t,e,r,s){return this.biomeSource.getBiome(e,r,s,t.sampler)}getOrCreateNoiseChunk(t,e){return a(this.noiseChunkCache,es.toLong(e.pos),(()=>{const r=Math.max(e.minY,this.settings.noise.minY),s=Math.min(e.maxY,this.settings.noise.minY+this.settings.noise.height),i=vi.cellWidth(this.settings.noise),n=vi.cellHeight(this.settings.noise),a=Math.floor(16/i),o=Math.floor(r/n),h=Math.floor((s-r)/n),l=es.minBlockX(e.pos),u=es.minBlockZ(e.pos);return new Vi(a,h,o,t,l,u,this.settings.noise,this.settings.aquifersEnabled,this.globalFluidPicker)}))}}class Ji{seed;noiseCache;randomCache;random;aquiferRandom;oreRandom;surfaceSystem;router;sampler;constructor(t,e){this.seed=e,this.noiseCache=new Map,this.randomCache=new Map,this.random=(t.legacyRandomSource?new Es(e):Ns.create(e)).forkPositional(),this.aquiferRandom=this.random.fromHashOf(ns.create("aquifer").toString()).forkPositional(),this.oreRandom=this.random.fromHashOf(ns.create("ore").toString()).forkPositional(),this.surfaceSystem=new Ci(t.surfaceRule,t.defaultBlock,e),this.router=yi.mapAll(t.noiseRouter,this.createVisitor(t.noise,t.legacyRandomSource)),this.sampler=Ri.Sampler.fromRouter(this.router)}createVisitor(t,e){const r=new Map,s=t=>{const r=t.key();if(void 0===r)throw new Error("Cannot create noise without key");if(e){if(r.equals(ns.create("temperature")))return new zs(new Es(this.seed+BigInt(0)),As.create(-7,[1,1]));if(r.equals(ns.create("vegetation")))return new zs(new Es(this.seed+BigInt(1)),As.create(-7,[1,1]));if(r.equals(ns.create("offset")))return new zs(this.random.fromHashOf("offset"),As.create(0,[0]))}return this.getOrCreateNoise(r)},i={map:e=>{if(e instanceof zi.HolderHolder){const t=e.holder.key();if(void 0!==t&&r.has(t.toString()))return r.get(t.toString());{const s=e.holder.value().mapAll(i);return void 0!==t&&r.set(t.toString(),s),s}}return e instanceof zi.Interpolated?e.withCellSize(vi.cellWidth(t),vi.cellHeight(t)):e instanceof zi.ShiftedNoise?new zi.ShiftedNoise(e.shiftX,e.shiftY,e.shiftZ,e.xzScale,e.yScale,e.noiseData,s(e.noiseData)):e instanceof zi.Noise?new zi.Noise(e.xzScale,e.yScale,e.noiseData,s(e.noiseData)):e instanceof zi.ShiftNoise?e.withNewNoise(s(e.noiseData)):e instanceof zi.WeirdScaledSampler?new zi.WeirdScaledSampler(e.input,e.rarityValueMapper,e.noiseData,s(e.noiseData)):e instanceof zi.OldBlendedNoise?new zi.OldBlendedNoise(e.xzScale,e.yScale,e.xzFactor,e.yFactor,e.smearScaleMultiplier,new Os(this.random.fromHashOf(ns.create("terrain").toString()),e.xzScale,e.yScale,e.xzFactor,e.yFactor,e.smearScaleMultiplier)):e instanceof zi.EndIslands?new zi.EndIslands(this.seed):e instanceof zi.Mapped||e instanceof zi.Ap2?e.withMinMax():e}};return i}getOrCreateNoise(t){const e=us.REGISTRY.getOrThrow(ns.create("worldgen/noise"));return a(this.noiseCache,t.toString(),(r=>new zs(this.random.fromHashOf(r),e.getOrThrow(t))))}getOrCreateRandom(t){return a(this.randomCache,t.toString(),(t=>this.random.fromHashOf(t).forkPositional()))}}}}]);